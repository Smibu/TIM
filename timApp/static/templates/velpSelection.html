<link rel="stylesheet" href="/static/stylesheets/velpSelection.css"/>
<div class="velpMenu" tim-draggable-fixed="" caption="Velp menu">



    <uib-tabset active="active">
        <uib-tab index="0" heading="Select velp">
            <br />
            <label><input type="checkbox" ng-model="advancedOn"> Advanced view</label>
            <div class="velpArea">

                <!-- LABELS -->
                <div id="labels" ng-show="advancedOn">
                <table class="velpTable">
                    <tr>
                        <td>
                            <label for="searchLabels">Filter labels </label>
                        </td>
                        <td>
                            <input id="searchLabels" ng-model="filterLabel" placeholder="filter labels">
                        </td>
                    </tr>
                </table>
                <!--   <tr>
                       <td colspan="4">-->
                <div>
                    <div class="fulldiv">
                        <p ng-repeat="label in filteredLabels = ( labels | filter:{content:filterLabel} )"
                           class="label tag-false"
                           ng-style="{ backgroundColor: getColor(label.id) };"
                           ng-click="toggleLabel(label)" ng-model="test" value="{{ label.id }}">
                            {{ label.content }} <span class="glyphicon glyphicon-ok" ng-show="label.selected"></span>
                        </p><!-- p ng-click="selectLabelToEdit()" ng-class="['label', 'tag-false']" style="background: blue;">
                                <span class="glyphicon glyphicon-plus"></span> Add label
                            </p -->
                    </div>
                    <div class="fulldiv" >
                        <br >
                        <input type="button" value="Create label" ng-click="toggleLabelToEdit(newLabel)">
                        <form name="addLabelForm" ng-show="newLabel['edit']"
                              ng-submit="addLabel(addLabelForm)" novalidate>
                            <table class="velpTable">
                                <tr>
                                    <td>
                                        <label for="newLabel">Label text</label>
                                    </td>
                                    <td>
                                        <input id="newLabel" name="labelContent"
                                               ng-model="newLabel['content']"
                                               placeholder="Label text" required>
                                    </td>
                                </tr>
                                <tr ng-show="(labelAdded && addLabelForm.labelContent.$invalid) || (addLabelForm.labelContent.$invalid && !addLabelForm.labelContent.$pristine)">
                                    <td colspan="2">
                                        <p class="error">Label content is too short</p>
                                    </td>
                                </tr>
                            </table>
                            <input id="addLabelButton" type="submit" value="Add label">
                        </form>
                        <hr />
                    </div>
                </div>
                    </div>
                <!--    </td>
                </tr>-->
                <table class="velpTable">
                    <tr>
                        <td>
                            <label for="searchVelps">Search velps:</label>
                        </td>
                        <td>
                            <input id="searchVelps" ng-model="filterVelp" placeholder="Filter velps">
                        </td>
                    </tr>
                    <tr ng-show="advancedOn">
                        <td>
                            <label for="orderVelps">Order velps:</label>
                        </td>
                        <td><select id="orderVelps" ng-model="orderVelp">
                            <option value="content">Alphabetical</option>
                            <option value="-used">Most used</option>
                            <option value="label">Labels</option>
                            <option value="-points">Highest point</option>
                            <option value="points">Lowest point</option>
                        </select>
                        </td>
                    </tr>
                </table>

                <input type="button" ng-click="selectVelpToEdit(newVelp)" value="Create velp">
                <div class="stack">
                    <div ng-model="newVelp" class="velp" ng-style="{top: 0}" ng-hide="!newVelp.edit">
                        <div ng-class="['emphasise', 'new', { neutral: newVelp.points == 0, positive: newVelp.points > 0, negative: newVelp.points < 0,
                            edit: newVelp.edit}]">

                            <div ng-class="['content']">
                                <p ng-class="[{hide:  newVelp.edit}]">
                                <span>Add velp!&ensp;</span>
                                <span class="points">{{ newVelp.points }}</span>
                                </p>
                                <form ng-class="[{hide: !newVelp.edit}]" name="addVelpForm"
                                ng-submit="addVelp(addVelpForm)" novalidate>

                                            <p><input name="velpName" type="text"
                                                   ng-model="newVelp['content']"
                                                   required placeholder="Add velp!" autofocus>
                                            <span ng-class="['glyphicon', 'glyphicon-tag', {hide: !advancedOn}]"
                                                  ng-repeat="label in filterByLabels"
                                                  ng-style="{ color: getColor(label) }"></span></p>

                                            <p ng-show="(addVelpForm.velpName.$invalid && !addVelpForm.velpName.$pristine) || (submitted && addVelpForm.velpName.$invalid)">
                                                Velp content is required
                                            </p>

                                            <p><input id="addVelpPoints" type="number" ng-model="newVelp['points']"
                                                   placeholder="Points" value="0"></p>

                                            <p><input type="submit" value="Add velp"/></p>
                                        </form>
                                    </div>
                                    </div>
                                </div>

                            <span ng-repeat="velp in filteredVelps = (velps | filter:{content:filterVelp} | orderBy:orderVelp | filterByLabels: labels:advancedOn)">

                                <div class="velp"  ng-click="useVelp(velp)"
                                     ng-style="{top: 2+$index*2 + 'em'}">
                                    <div ng-class="['velp-data', 'emphasise', {neutral: velp.points == 0, positive: velp.points > 0, negative: velp.points < 0,
                                    edit: velp.edit}]">

                                        <div ng-class="['content']">
                                            <div ng-hide="velp.edit">
                                            <p ng-hide=>
                                                <span>{{ velp.content }}&ensp;</span>
                                                <span class="points">{{ velp.points }}</span>
                                                <span ng-show="advancedOn" ng-class="['glyphicon', 'glyphicon-tag']"
                                                      ng-repeat="label in velp.labels"
                                                      ng-style="{ color: getColor(label) }"></span>
                                                <span class="float-right" ng-click="selectVelpToEdit(velp)"
                                                      ng-class="['glyphicon', 'glyphicon-pencil', 'clickable-icon']"></span>

                                            </p>
                                            <div class="bottom-part"></div>
                                            </div>
                                            <form ng-class="[{hide: !velp.edit}]" name="editVelpForm"
                                                  ng-submit="editVelp(editVelpForm)" novalidate>

                                                <p><input name="velpName" type="text"
                                                          ng-model="velpToEdit['content']"
                                                          required placeholder="Edit velp!">
                                            <span ng-class="['glyphicon', 'glyphicon-tag', {hide: !advancedOn}]"
                                                  ng-repeat="l in velpToEdit.labels"
                                                  ng-style="{ color: getColor(l) }"></span>
                                                    <span class="float-right" ng-click="selectVelpToEdit(velp)"
                                                          ng-class="['glyphicon', 'glyphicon-pencil', 'clickable-icon']"></span>
                                                </p>

                                                <p ng-show="(editVelpForm.velpName.$invalid && !editVelpForm.velpName.$pristine) || (submitted && editVelpForm.velpName.$invalid)" class="error">
                                                    Velp content is required
                                                </p>
                                                <p><input id="addVelpPoints" type="number"
                                                          ng-model="velpToEdit['points']"
                                                          placeholder="Points" value="0"></p>
                                                <p>
                                                    <span ng-repeat="l in labels">
                                                        <input type="checkbox" ng-click="updateVelpToEditLabels(l)" ng-checked="isLabelInVelp(velpToEdit, l)"> {{ l.content }}<br>
                                                    </span>
                                                </p>
                                                <p><input type="submit" value="Save changes"/></p>
                                            </form>
                                        </div>
                                    </div>
                                </div>

                                <!-- div ng-class="['emphasise', {neutral: velp.points == 0, positive: velp.points > 0, negative: velp.points < 0}]" style="height: 2px;"></div -->
                            </span>
                    </div>
                    <!--p ng-hide="filteredVelps.length">No velps :'(</p -->
                </div>
                <!--  </td>
              </tr>-->

        </uib-tab>

        <!-- MANAGE VELPS -->
        <uib-tab index="1" heading="Manage velps">
            <div class="velpArea">
                <table class="velpTable">
                    <tr>
                        <td>
                            <label>Search velp groups</label>
                        </td>
                        <td>
                            <input placeholder="Enter text...">
                        </td>
                    </tr>
                </table>
                <input value="Import group" type="submit">
            </div>
        </uib-tab>

        <!-- SUMMARY -->
        <uib-tab index="2" heading="Summary">
            <div class="velpArea">
                <div class="velpSummary">
                    <table>
                        <tr>
                            <th class="summCheckbox"><input type="checkbox" ng-model="settings.selectedAll"
                                                            ng-change="checkAll()"></th>
                            <th class="summSecColumn">Velp</th>
                            <th class="summThiColumn">Points</th>
                        </tr>
                        <tr ng-repeat="a in annotations">
                            <td class="summCheckbox"><input type="checkbox" ng-model="a.selected"></td>
                            <td class="summSecColumn"><span>{{ getVelpById(a.velp).content }}</span></td>
                            <td class="summThiColumn"><span>{{ a.points }}</span></td>
                        </tr>
                        <tr>
                            <th class="summCheckbox"></th>
                            <th class="summSecColumn">Points total</th>
                            <th class="summThiColumn"><span>{{ getTotalPoints() }}</span></th>
                        </tr>
                    </table>
                </div>
            </div>
        </uib-tab>
    </uib-tabset>
</div>