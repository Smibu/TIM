<div  tim-draggable-fixed="" class="velpFixed" save="%%PAGEID%%velpMenu" click="true" resize="true" caption="Velp menu" id="velpSelection">
  <div class="velpMenu draggable-content" >

    <uib-tabset active="vsctrl.active" class="velpFill">
        <uib-tab index="0" heading="Select">
            <br/>
            <label><input type="checkbox" ng-model="vsctrl.advancedOn" ng-change="vsctrl.setAdvancedOnlocalStorage(advancedOn)"> Advanced view</label>
            <div class="velpArea">

                <!-- LABELS -->
                <div id="labels" ng-show="vsctrl.advancedOn">
                    <form class="form-inline adjustForm">
                        <div class="form-group">
                            <label class="formLabel" for="searchLabels">Search labels:</label>
                            <input class="formInput" id="searchLabels" ng-model="vsctrl.filterLabel"
                                   placeholder="Filter labels">
                        </div>
                    </form>
                    <div>
                        <div class="fulldiv">
                            <p ng-repeat="label in filteredLabels = ( labels | filter:{content:vsctrl.filterLabel} )"
                               class="label tag-false"
                               ng-style="{ backgroundColor: vsctrl.getColor(label.id) };"
                               ng-click="vsctrl.toggleLabel(label)" ng-model="vsctrl.test" value="{{ label.id }}">
                                {{ label.content }} <span class="glyphicon glyphicon-ok"
                                                          ng-show="label.selected"></span>
                            </p>
                            <hr/>
                        </div>
                    </div>
                </div>
                <div>
                    <form class="form-inline adjustForm">
                        <div class="form-group">
                            <label class="formLabel" for="searchVelps">Search velps:</label>
                            <input class="formInput" id="searchVelps" ng-model="vsctrl.filterVelp" placeholder="Filter velps">
                        </div>
                    </form>
                </div>
                <div ng-show="vsctrl.advancedOn">
                    <form class="form-inline adjustForm">
                        <div class="form-group">
                            <label class="formLabel" for="orderVelps">Order velps:</label>
                            <select id="orderVelps" ng-model="vsctrl.order" ng-change="vsctrl.changeOrdering(order)">
                                <option value="content">Alphabetical</option>
                                <option value="-used">Most used</option>
                                <option value="label">Labels</option>
                                <option value="-points">Highest point</option>
                                <option value="points">Lowest point</option>
                            </select>
                        </div>
                    </form>
                </div>

                <input id="createVelpButton" class="timButton" type="button" ng-click="vsctrl.openCreateNewVelpWindow(newVelp)"
                       value="Create new velp">

                <div class="stack" id="selectVelpsStack">

                    <velp-window id="newVelp"
                                 class="velp" ng-style="{top: 0}"
                                 ng-show="vsctrl.newVelp.edit"
                                 velp="vsctrl.newVelp"
                                 index="-1"
                                 velp-groups="vsctrl.velpGroups"
                                 labels="vsctrl.labels"
                                 new="true"
                                 advanced-on="vsctrl.advancedOn"></velp-window>

                    <button ng-click="vsctrl.releaseClicked()" class="timButton" id="releaseSelectVelpsButton" style="padding-top: 0px;padding-bottom: 0px;margin-bottom: 10px ">&#8592;</button>
    <div id="selectVelpsDiv" save="%%PAGEID%%selectVelpsDiv" tim-draggable-fixed>
        <span title="Close" class="glyphicon glyphicon-remove clickable-icon closedraggable" ng-click="vsctrl.releaseClicked()" style="visibility: hidden;position: absolute; margin-left: 16.7em;margin-top: 0.2em"></span>
                    <!-- EDIT VELPS -->

        <span ng-repeat="velp in filteredVelps = (velps | filter:{content:filterVelp} | orderByWhenNotEditing:order:filteredVelps | filterByVelpGroups:vsctrl.velpGroups | filterByLabels:labels:vsctrl.advancedOn
                                                 ) track by $index">
                <velp-window velp="velp"
                             index="{{ $index }}"
                             velp-groups="vsctrl.velpGroups"
                             labels="vsctrl.labels"
                             new="false"
                             advanced-on="vsctrl.advancedOn"
                             ></velp-window>
        </span>

                </div>
            </div>
   </div>
        </uib-tab>

        <!-- MANAGE VELPS -->
        <uib-tab index="1" heading="Manage">

            <div class="velpArea">
                <div class="velpSummary">
                    <form>
                        <table class="fulldiv">

                            <h5>Choose area for velp group:</h5>
                            <fieldset>
                                <input type="radio" ng-click="vsctrl.updateVelpList()" ng-model="vsctrl.groupAttachment.target_type"
                                       ng-value="0" name="selArea" id="selDoc">
                                <label for="selDoc">Whole document</label><br/>
                                <input title="A paragraph must be clicked to choose this option" type="radio"
                                       ng-click="vsctrl.updateVelpList()" ng-model="vsctrl.groupAttachment.target_type" ng-value="1"
                                       name="selArea" id="selPar" ng-class="{disabled: rctrl.selectedElement == null}"
                                       ng-disabled="rctrl.selectedElement == null">
                                <label for="selPar" ng-class="{'disabled':rctrl.selectedElement == null}">Selected paragraph</label>
                            </fieldset>

                            <tr>
                                <th><label class="comment-info small"><input type="checkbox"
                                                                            ng-model="vsctrl.settings.selectedAllShows"
                                                                            ng-click="vsctrl.changeAllVelpGroupSelections('show')">Show</label>
                                </th>
                                <th><label ng-class="['comment-info', 'small', {disabled: !vctrl.item.rights.manage}]"><input type="checkbox"
                                                                            ng-model="vsctrl.settings.selectedAllDefault"
                                                                            ng-disabled="!vctrl.item.rights.manage"
                                                                            ng-click="vsctrl.changeAllVelpGroupSelections('default')">Default</label>
                                </th>
                                <th><span class="small">Velp group</span></th>
                            </tr>

                            <tr ng-repeat="group in vsctrl.velpGroups" ng-hide="group.id<0">
                                <td>
                                    <input type="checkbox" ng-model="group.show"
                                           ng-click="vsctrl.changeVelpGroupSelection(group, 'show')">
                                </td>
                                <td>
                                    <input type="checkbox" ng-model="group.default" ng-disabled="!vctrl.item.rights.manage"
                                           ng-click="vsctrl.changeVelpGroupSelection(group, 'default')">
                                </td>
                                <td>
                                    <a ng-href="/manage/{{ group.location }}">{{ group.name }}</a>
                                </td>
                            </tr>
                        </table>
                        <input type="button" class="timButton" title="Shows only the default velp groups in current area (document or paragraph)"
                               value="Set area default groups visible" ng-click="vsctrl.resetCurrentShowsToDefaults()"/>
                        <input id="resetAllSelBtn" type="button" class="timButton"
                               title="Shows only the default velp groups in all areas"
                               value="Set all default groups visible" ng-click="vsctrl.resetAllShowsToDefaults()"/>
                    </form>
                    <hr>
                    <form ng-submit="vsctrl.addVelpGroup(addVelpGroupForm)" name="addVelpGroupForm">
                        <p><label>Create new velp group:</label><input type="text" ng-model="vsctrl.newVelpGroup.name"
                                                                       placeholder="Velp group name" required></p>
                        <fieldset>
                            <p><input type="radio" name="group1" ng-model="vsctrl.newVelpGroup.target_type" id="radioPar"
                                      ng-value="0" checked="checked"> <label for="radioPar">Personal
                                collection</label><br>
                                <input type="radio" name="group1" ng-model="vsctrl.newVelpGroup.target_type" id="radioDoc"
                                       ng-value="1" ng-disabled="!vctrl.item.rights.editable"> <label for="radioDoc" ng-class="{'disabled':!vctrl.item.rights.editable}">Document</label><br>
                                <input type="radio" name="group1" ng-model="vsctrl.newVelpGroup.target_type" id="radioFolder"
                                       ng-value="2" ng-disabled="!vctrl.item.rights.editable"> <label for="radioFolder" ng-class="{'disabled':!vctrl.item.rights.editable}">Folder</label></p>
                        </fieldset>

                        <p><input type="submit" class="timButton" value="Create velp group"></p>
                        <p ng-show="(addVelpGroupForm.newVelpGroup.name.$invalid && !addVelpGroupForm.newVelpGroup.name.$pristine) || (vsctrl.submitted.velpGroup && addVelpGroupForm.newVelpGroup.name.$invalid)"
                           class="error">
                            Velp group name is required!
                        </p>
                    </form>
                </div>
            </div>
        </uib-tab>

        <!-- SUMMARY -->
        <uib-tab index="2" heading="Summary">
            <div velp-summary="" annotations="annotations"></div>
        </uib-tab>
    </uib-tabset>
    </div>
</div>
