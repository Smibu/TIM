    <button ng-show="!$ctrl.isLoggedIn()"
            uib-popover-template="'loginTemplate.html'"
            popover-title="Log in"
            popover-placement="bottom"
            popover-animation="false"
            popover-trigger="outsideClick"
            type="button"
            class="btn btn-default margin-4">Log in
    </button>

    <script type="text/ng-template" id="loginTemplate.html">
        <div class="row" ng-click="$ctrl.stopClick($event)">
            <div class="col-sm-12">
                <form ng-submit="$ctrl.loginWithEmail()">
                    <p class="text-center">
                        JYU students and staff, please log in with Korppi:
                    </p>

                    <button class="timButton center-block" type="button" ng-click="$ctrl.korppiLogin($ctrl.addingToSession)">Log in
                        with Korppi
                    </button>
                    <img class="center-block" ng-show="$ctrl.korppiLoading" src="/static/images/loading.gif">
                    <hr>
                    <p class="text-center">
                        Others, please log in with your TIM account.
                    </p>

                    <div class="form-group">
                        <label for="email" class="control-label">Email</label>
                        <input class="form-control" id="email" ng-model="$ctrl.form.email" type="email">
                    </div>

                    <div class="form-group">
                        <label for="password" class="control-label">Password</label>
                        <input class="form-control" id="password" ng-model="$ctrl.form.password" type="password">
                    </div>

                    <button class="center-block timButton" type="submit">Log in</button>
                    <hr>
                    <p class="text-center">
                        Not a JYU student or staff member and don't have a TIM account?
                    </p>
                    <button ng-show="!$ctrl.showSignup" class="center-block timButton" type="button" ng-click="$ctrl.showSignup = true">Sign up</button>
                </form>
                <form ng-show="$ctrl.showSignup" action="/altsignup" autocomplete="off"
                      method="post">
                    <div class="form-group">
                        <label for="email-signup" class="control-label">Email</label>
                        <input class="form-control"
                               id="email-signup"
                               name="email"
                               placeholder="Enter your email address"
                               required="required"
                               type="email"/>
                    </div>
                    <button class="center-block timButton" type="submit">Sign up</button>
                </form>
            </div>
        </div>
    </script>

    <div ng-show="$ctrl.isLoggedIn()" class="btn-group margin-4" uib-dropdown on-toggle="$ctrl.toggled(open)">
        <button type="button" title="You're logged in" class="btn btn-primary" uib-dropdown-toggle>
            {{ $ctrl.getCurrentUser().real_name }} <span
                ng-show="$ctrl.getSessionUsers().length > 0">and {{ $ctrl.getSessionUsers().length }} <ng-pluralize
                count="$ctrl.getSessionUsers().length"
                when="{'1': 'other',
                     'other': 'others'}">
        </ng-pluralize></span> <span class="caret"></span>
        </button>
        <ul class="dropdown-menu"
            uib-dropdown-menu
            role="menu"
            aria-labelledby="single-button">
            <li role="menuitem"><a ng-href="/view/{{ $ctrl.getCurrentUser().folder.path }}">My documents</a></li>
            <li role="menuitem"><a
                    ng-click="$ctrl.addUser($event)"
                    uib-popover-template="'loginTemplate.html'"
                    popover-is-open="$ctrl.addingToSession"
                    popover-title="Add a user to this session"
                    popover-placement="auto bottom"
                    popover-append-to-body="true"
                    popover-animation="false"
                    href="#">Add a user to this session...</a></li>
            <li class="divider"></li>
            <li ng-show="!$ctrl.loggingout" role="menuitem">
                <a ng-click="$ctrl.beginLogout($event)" href="#">Log <span
                    ng-show="$ctrl.getSessionUsers().length > 0">everyone</span>
                out<span ng-show="$ctrl.isKorppi()">...</span></a>
            </li>
            <li ng-show="$ctrl.loggingout" role="menuitem">
                <a ng-click="logout(getCurrentUser(), true)" href="#">Log out (TIM + Korppi)</a>
            </li>
            <li ng-show="$ctrl.loggingout" role="menuitem">
                <a ng-click="$ctrl.logout($ctrl.getCurrentUser(), false)" href="#">Log out (TIM only)</a>
            </li>
            <li role="menuitem" ng-repeat="u in $ctrl.getSessionUsers()"><a ng-click="logout(u)"
                                                                      href="#">Log {{ u.real_name }} out</a></li>
        </ul>
    </div>
