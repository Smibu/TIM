  <div ng-show="$ctrl.proeditor">
    <ul class="tabsarea">
        <li id="navigate" class="tab active"><a ng-click="$ctrl.tabClicked($event, 'navigateButtons')">Navigation</a></li>
        <li id="style" class="tab"><a ng-click="$ctrl.tabClicked($event, 'styleButtons')">Style</a></li>
        <li id="insert" class="tab"><a ng-click="$ctrl.tabClicked($event, 'insertButtons')">Insert</a></li>
        <li id="special" class="tab"><a ng-click="$ctrl.tabClicked($event, 'specialButtons')">Characters</a></li>
        <li id="tex" class="tab"><a ng-click="$ctrl.tabClicked($event, 'texButtons')">TeX</a></li>
        <li id="plugin" class="tab" ng-show="$ctrl.getOptions().showPlugins"><a ng-click="$ctrl.tabClicked($event, 'pluginButtons')">Plugins</a>
        </li>
        <li id="settings" class="tab" ng-show="$ctrl.getOptions().showSettings"><a ng-click="$ctrl.tabClicked($event, 'settingsButtons')">Settings</a></li>
        <li id="upload" class="tab" ng-show="$ctrl.getOptions().showImageUpload"><a ng-click="$ctrl.tabClicked($event, 'uploadButtons')">Upload</a>
        </li>
        <li id="help" class="tab"><a ng-click="$ctrl.tabClicked($event, 'helpButtons')">Help</a></li>
    </ul>
    <div id="navigateButtons" class="extraButtonArea">
        <button class="editorButton" title="Undo" ng-click="$ctrl.editor.undoClicked()">&#8630;</button>
        <button class="editorButton" title="Redo" ng-click="$ctrl.editor.redoClicked()">&#8631;</button>
        <button class="editorButton" title="Move left" ng-click="$ctrl.editor.leftClicked()">&#8592;</button>
        <button class="editorButton" title="Move Right" ng-click="$ctrl.editor.rightClicked()">&#8594;</button>
        <button class="editorButton" title="Move up" ng-click="$ctrl.editor.upClicked()">&#8593;</button>
        <button class="editorButton" title="Move down" ng-click="$ctrl.editor.downClicked()">&#8595;</button>
        <button class="editorButton" title="Move to the beginning of the line" ng-click="$ctrl.editor.homeClicked()">Home
        </button>
        <button class="editorButton" title="Move to the end of the line" ng-click="$ctrl.editor.endClicked()">End</button>
        <button class="editorButton" title="Move to the beginning of the file" ng-click="$ctrl.editor.topClicked()">Top
        </button>
        <button class="editorButton" title="Move to the end of the file" ng-click="$ctrl.editor.bottomClicked()">Bottom
        </button>
        <button class="editorButton" title="Toggle insert mode on or off" ng-click="$ctrl.editor.insertClicked()">Ins
        </button>
    </div>
    <div id="styleButtons" class="extraButtonArea hidden">
        <button class="editorButton" title="Indent selection/line" ng-click="$ctrl.editor.indentClicked()">&#8649;
        </button>
        <button class="editorButton" title="Outdent selection/line" ng-click="$ctrl.editor.outdentClicked()">&#8647;
        </button>
        <button class="editorButton" title="Bold (Ctrl-B)" ng-click="$ctrl.editor.surroundClicked('**', '**')"><b>B</b></button>
        <button class="editorButton" title="Italic (Ctrl-I)" ng-click="$ctrl.editor.italicSurroundClicked()">
            <i>I</i></button>
        <button class="editorButton" title="Underline" ng-click="$ctrl.editor.surroundClicked('<u>', '</u>')"><u>U</u></button>
        <button class="editorButton" title="Strikethrough" ng-click="$ctrl.editor.surroundClicked('<s>', '</s>')"><s>Z</s></button>
        <button class="editorButton" title="Add any style"
                ng-click="$ctrl.editor.styleClicked('Teksti', 'red')">Style
        </button>
        <button class="editorButton" title="Code (Ctrl-O)" ng-click="$ctrl.editor.surroundClicked('`', '`')">Code</button>
        <button class="editorButton" title="Code block (Ctrl-Alt-O)" ng-click="$ctrl.editor.codeBlockClicked()">Code block</button>
        <button class="editorButton" title="Subscript" ng-click="$ctrl.editor.surroundClicked('~', '~')">X_</button>
        <button class="editorButton" title="Superscript" ng-click="$ctrl.editor.surroundClicked('^', '^')">X^</button>
        <button class="editorButton" title="Heading 1 (Ctrl-1)" ng-click="$ctrl.editor.headerClicked('#')">H1</button>
        <button class="editorButton" title="Heading 2 (Ctrl-2)" ng-click="$ctrl.editor.headerClicked('##')">H2</button>
        <button class="editorButton" title="Heading 3 (Ctrl-3)" ng-click="$ctrl.editor.headerClicked('###')">H3</button>
        <button class="editorButton" title="Heading 4 (Ctrl-4)" ng-click="$ctrl.editor.headerClicked('####')">H4</button>
    </div>
    <div id="insertButtons" class="extraButtonArea hidden">
        <button class="editorButton" title="Add link"
                ng-click="$ctrl.editor.linkClicked('Linkin teksti', 'Linkin osoite')">Link
        </button>
        <button class="editorButton" title="Add image"
                ng-click="$ctrl.editor.linkClicked('Kuvan teksti', 'Kuvan osoite', true)">Image
        </button>
        <button class="editorButton" title="List item" ng-click="$ctrl.editor.listClicked()">List</button>
        <button class="editorButton" title="Table" ng-click="$ctrl.tableClicked($event)">Table</button>
        <button class="editorButton" title="Slide" ng-click="$ctrl.slideClicked($event)">Slide</button>
        <button class="editorButton" title="Break text to start a new paragraph (Shift-Enter)" ng-click="$ctrl.editor.paragraphClicked()">Paragraph break</button>
        <button class="editorButton" title="Forces line to end at cursor position (Ctrl-Enter)" ng-click="$ctrl.editor.endLineClicked()">End line</button>
        <button class="editorButton" title="Creates a comment block or sets the line to a comment (Ctrl-Y)" ng-click="$ctrl.editor.commentClicked()">Comment</button>
        <button class="editorButton" title="Creates a page break for web printing" ng-click="$ctrl.editor.pageBreakClicked()">Page break</button>
    </div>
    <div id="specialButtons" class="extraButtonArea hidden">
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">@</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">#</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">`</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">$</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">€</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">%</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">&</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">{</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">}</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">[</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">]</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">/</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event)">\</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event, '&#173;')">Soft hyphen</button>
        <button class="editorButton" ng-click="$ctrl.editor.charClicked($event, '⁞')">Cursor</button>
    </div>
    <div id="texButtons" class="extraButtonArea hidden">
        <button class="editorButton" ng-click="$ctrl.editor.surroundClicked('$', '$')">TeX equation</button>
        <button class="editorButton" ng-click="$ctrl.editor.surroundClicked('$$', '$$')">TeX block</button>
        <button class="editorButton" ng-click="$ctrl.editor.indexClicked()">X&#x2093;</button>
        <button class="editorButton" ng-click="$ctrl.editor.powerClicked()">X&#x207f;</button>
        <button class="editorButton" ng-click="$ctrl.editor.squareClicked()">&radic;</button>
    </div>
    <div id="settingsButtons" class="extraButtonArea hidden" ng-if="$ctrl.getOptions().showSettings">
        <button class="editorButton" ng-click="$ctrl.editor.insertTemplate('auto_number_headings: 1\n')" title="Auto number headings level">Heading numbering</button>
        <button class="editorButton" ng-click="$ctrl.editor.insertTemplate('css: |!!\n.style {\n\n}\n!!\n')" title="Styles for this document">CSS</button>
        <button class="editorButton" ng-click="$ctrl.editor.insertTemplate('macros:\n  key: value\n')" title="Macro values fo document">Macros</button>
        <button class="editorButton" ng-click="$ctrl.editor.insertTemplate('show_task_summary: true\n')" title="Show task summary in the begining of the doc">Task summary</button>
        <button class="editorButton" ng-click="$ctrl.editor.insertTemplate('live_updates: 5\n')" title="Update documetn automatically in this interval (sec)">Live update</button>
        <button class="editorButton" ng-click="$ctrl.editor.insertTemplate('lazy: false\n')" title="Calculate plugins lazy or not">Lazy</button>
        <button class="editorButton" ng-click="$ctrl.editor.insertTemplate('global_plugin_attrs:\n csPlugin:\n   stem: value\n all:\n   stem: value\n')" title="Global values for the plugins">Global plugin</button>
        <a href="https://tim.jyu.fi/view/tim/ohjeita/documentin-asetukset#settings_list" target="_blank"
           title="Help for settings"><i class="helpButton glyphicon glyphicon-question-sign"></i></a>
    </div>
    <div id="pluginButtons" class="extraButtonArea hidden" ng-show="$ctrl.getOptions().showPlugins"></div>
    <div id="uploadButtons" class="extraButtonArea hidden" ng-show="$ctrl.getOptions().showImageUpload">
        <span>
            Upload image/file: <input type="file" ngf-select="$ctrl.onFileSelect($file)">
            <span ng-show="$ctrl.file.progress >= 0 && !$ctrl.file.error"
                  ng-bind="$ctrl.file.progress < 100 ? 'Uploading... ' + $ctrl.file.progress + '%' : 'Done!'"></span>
            <a ng-href="{{$ctrl.uploadedFile}}" >{{$ctrl.uploadedFile}}</a>
        </span>
        <div class="error" ng-show="$ctrl.file.error" ng-bind="$ctrl.file.error"></div>
    </div>
    <div id="helpButtons" class="extraButtonArea hidden form-inline">
        <a class="helpButton margin-4" href="https://tim.jyu.fi/view/tim/TIM-ohjeet" target="_blank" title="General TIM Help">TIM
            Help</a>
        <span class="margin-4">To cite this paragraph:</span>
        <input readonly
               class="form-control"
               type="text"
               ng-model="$ctrl.citeText"
               title="Copy this line to cite this paragraph"
               ng-focus="$ctrl.selectAllText($event)"/>
        <a href="https://tim.jyu.fi/view/tim/TIM-ohjeet#viitteen-katsominen" target="_blank"
           title="Help for references"><i class="helpButton glyphicon glyphicon-question-sign"></i></a>
    </div>
  </div>
    <div class="editorContainer">
    </div>
    <div class="editButtonArea">
        <span ng-show="$ctrl.proeditor">
        <button class="timButton" title="Change editor between Ace and normal textarea" ng-click="$ctrl.changeEditor()">Editor</button>
        <button class="timButton" ng-show="$ctrl.fullscreenSupported()" ng-click="$ctrl.goFullScreen()">Fullscreen</button>
        </span>
        <button class="timButton" ng-disabled="$ctrl.saving" title="Save (Ctrl-S)" ng-click="$ctrl.saveClicked()">Save</button>
        <button class="timButton" ng-disabled="$ctrl.saving" ng-click="$ctrl.cancelClicked()">Cancel</button>
        <button class="timButton" ng-disabled="$ctrl.saving" ng-show="$ctrl.showUnread()" ng-click="$ctrl.unreadClicked()">Mark as unread</button>
        <span ng-show="$ctrl.proeditor">
        <button class="btn btn-danger" ng-disabled="$ctrl.saving" ng-show="$ctrl.getOptions().showDelete" ng-click="$ctrl.deleteClicked()">Delete</button>
        </span>
    </div>
    <div class="choices">
        <div ng-repeat="choice in $ctrl.getOptions().choices">
            {{ choice.desc }}
            <label ng-repeat="opt in choice.opts">
                <input type="radio" ng-model="$ctrl.getExtraData()[choice.name]" ng-value="opt.value"/> {{ opt.desc }}&nbsp;
            </label>
        </div>
    </div>
    <div class="editoropts">
        <label class="font-weight-normal"><input type="checkbox" ng-model="$ctrl.proeditor"/> Advanced view</label>
        <label class="font-weight-normal" ng-show="$ctrl.aceEnabled()"><input type="checkbox" ng-model="$ctrl.autocomplete"/> Autocomplete</label>
    </div>
    <div class="editortags">
        <label class="font-weight-normal" ng-repeat="tag in $ctrl.getOptions().tags">
            <input type="checkbox" ng-model="$ctrl.getExtraData().tags[tag.name]"/> {{ tag.desc }}
        </label>
    </div>
    <label class="pull-right font-weight-normal" ng-if="$ctrl.wrap.n!=-1" title="Put 0 to no wrap" ng-click="$ctrl.editor.forceWrap(true)">Wrap:
        <input type="text" ng-pattern="/[-0-9]*/" ng-model="$ctrl.wrap.n" size="2"/>
    </label>
    <div id="previewDiv"
         tim-draggable-fixed
         detachable="true"
         caption="Preview"
         save="{{$ctrl.getOptions().localSaveTag}}Preview"
         resize="true"
         class="preview"
         ng-show="$ctrl.proeditor">
    <span>Preview
        (<ng-pluralize count="$ctrl.parCount"
                       when="{'0': 'empty',
                     '1': '1 paragraph',
                     'other': '{} paragraphs'}">
        </ng-pluralize>)
    </span>
        <span ng-show="$ctrl.outofdate">...</span>

        <div class="previewcontent paragraphs"></div>
    </div>
