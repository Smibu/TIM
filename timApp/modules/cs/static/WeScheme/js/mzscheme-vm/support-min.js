var sys={print:function(j){j=j.toString().replace(RegExp("\n","g"),"<br />");document.write(j)},error:function(j){"undefined"!==typeof console&&console.log?j.stack?console.log(j.stack):console.log("Error: "+str):(j=j.toString().replace(RegExp("\n","g"),"<br />"),document.write("<br />Error: "+j+"<br />"))},inspect:function(j){return j+""}},DEBUG_ON=!1,setDebug=function(j){DEBUG_ON=j},debug=function(j){DEBUG_ON&&sys.print(j)},debugF=function(j){DEBUG_ON&&sys.print(j())},hasOwnProperty={}.hasOwnProperty,
deepEqual=function(j,F){if(j===F)return!0;var y;if(j instanceof Array){if(F instanceof Array){for(y=0;y<j.length;y++)if(!deepEqual(j[y],F[y]))return!1;return!0}return!1}if("string"===typeof j||"number"===typeof j)return j===F;for(y in j)if(hasOwnProperty.call(j,y)&&"_eqHashCode"!==y&&"_isList"!==y&&(!hasOwnProperty.call(F,y)||!deepEqual(j[y],F[y])))return!1;for(y in F)if(hasOwnProperty.call(F,y)&&"_eqHashCode"!==y&&"_isList"!==y&&(!hasOwnProperty.call(j,y)||!deepEqual(j[y],F[y])))return!1;return!0},
assert={equal:function(j,F){if(j!==F)throw Error("AssertError: "+j+" equal "+F);},deepEqual:function(j,F){if(!deepEqual(j,F))throw Error("AssertError: "+j+" deepEqual "+F);},ok:function(j){if(!j)throw Error("AssertError: not ok: "+j);},throwsExn:function(j){try{j.apply(null,[])}catch(F){return}throw Error("AssertError: Throw expected, none received.");}};this.JSON||(this.JSON={});
(function(){function j(b){return 10>b?"0"+b:b}function F(c){b.lastIndex=0;return b.test(c)?'"'+c.replace(b,function(b){var c=B[b];return"string"===typeof c?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+c+'"'}function y(b,c){var t,q,L,V,j=z,S,B=c[b];B&&"object"===typeof B&&"function"===typeof B.toJSON&&(B=B.toJSON(b));"function"===typeof e&&(B=e.call(c,b,B));switch(typeof B){case "string":return F(B);case "number":return isFinite(B)?""+B:"null";case "boolean":case "null":return""+
B;case "object":if(!B)return"null";z+=I;S=[];if("[object Array]"===Object.prototype.toString.apply(B)){V=B.length;for(t=0;t<V;t+=1)S[t]=y(t,B)||"null";L=0===S.length?"[]":z?"[\n"+z+S.join(",\n"+z)+"\n"+j+"]":"["+S.join(",")+"]";z=j;return L}if(e&&"object"===typeof e){V=e.length;for(t=0;t<V;t+=1)q=e[t],"string"===typeof q&&(L=y(q,B))&&S.push(F(q)+(z?": ":":")+L)}else for(q in B)Object.hasOwnProperty.call(B,q)&&(L=y(q,B))&&S.push(F(q)+(z?": ":":")+L);L=0===S.length?"{}":z?"{\n"+z+S.join(",\n"+z)+"\n"+
j+"}":"{"+S.join(",")+"}";z=j;return L}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+j(this.getUTCMonth()+1)+"-"+j(this.getUTCDate())+"T"+j(this.getUTCHours())+":"+j(this.getUTCMinutes())+":"+j(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,z,I,B={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},e;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,t){var q;I=z="";if("number"===typeof t)for(q=0;q<t;q+=1)I+=" ";else"string"===typeof t&&(I=t);if((e=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return y("",
{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(b,e){function t(b,c){var u,q,j=b[c];if(j&&"object"===typeof j)for(u in j)Object.hasOwnProperty.call(j,u)&&(q=t(j,u),void 0!==q?j[u]=q:delete j[u]);return e.call(b,c,j)}var q,b=""+b;c.lastIndex=0;c.test(b)&&(b=b.replace(c,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return q=eval("("+b+")"),"function"===typeof e?t({"":q},""):q;throw new SyntaxError("JSON.parse");})})();var helpers={};
(function(){var j=function(b){throw types.schemeError(b);},F=function(b,c,m,t){var b=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),q=b[b.length-1],L=function(b){var c=[],e,u=[];for(e=0;e<t.length;e++)!state.isState(t[e])&&!(void 0!==t[e].name&&""===t[e].name)&&u.push(t[e]);window.wtf=t[2];for(e=0;e<u.length;e++)b.isEmpty()||(e!=m-1&&c.push(new types.ColoredPart(types.toWrittenString(u[e])+" ",b.first())),b=b.rest());0<c.length&&(b=c[c.length-1].text,b=b.substring(0,
b.length-1),c[c.length-1]=new types.ColoredPart(b,c[c.length-1].location));return c},b=function(b){var c=q,e;for(e=0;e<b;e++)c=c.rest();return c.first()},V=c.typeName+"",z=V.substring(0,1);t&&(L=L(q.rest()),0<L.length&&j(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(c.functionName,q.first()),": expects ","a"===z||"e"===z||"i"===z||"o"===z||"u"===z?"an ":"a ",V," as ",c.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(c.actualValue),
b(m)),"; other arguments were: ",new types.GradientPart(L)]),[])));j(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(c.functionName,q.first()),": expects ","a"===z||"e"===z||"i"===z||"o"===z||"u"===z?"an ":"a ",V," as ",c.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(c.actualValue),b(m))]),[]))},y=function(b,c,m,t){if(b instanceof state.State){var q=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");
void 0!==q[q.length-1]&&F(b,c,m,t)}if(t&&1<t.length){b=["~a: expects type ~a as ~a arguments, but given: ~s; other arguments were:"];for(q=0;q<t.length;q++)q!=m-1&&b.push(types.toWrittenString(t[q]));m=b.join(" ");j(types.incompleteExn(types.exnFailContract,helpers.format(m,[c.functionName,c.typeName,c.ordinalPosition,c.actualValue]),[]))}else j(types.incompleteExn(types.exnFailContract,helpers.format("~a: expects argument of type ~a, but given: ~s",[c.functionName,c.typeName,c.actualValue]),[]))},
c=function(b,c,m,t,q,L,V){m(c)||y(b,{functionName:t,typeName:q,ordinalPosition:helpers.ordinalize(L),actualValue:c},L,V)},b=function(b){var c,b=c=b;if(c===types.EMPTY)return!0;for(;;){if(!types.isPair(c))return!1;if(types.isPair(b)){if(!0===b._isList)return!0;b=b.rest()}c=c.rest();if(types.isPair(c)){if(c._isList)return b._isList=!0;c=c.rest();if(types.isPair(c)&&c._isList)return b._isList=!0}if(c===types.EMPTY)return b._isList=!0;if(b===c)return!1}},z=function(c,u){if(!b(c))return!1;for(;types.isPair(c);){if(!u(c.first()))return!1;
c=c.rest()}return c===types.EMPTY},I=function(b){var c=b;if(c===types.EMPTY)return[];if(types.isPair(c))for(b=[];!c.isEmpty();)b.push(I(c.first())),c=c.rest();return b},B=function(c){if(!b(c))return[c];for(var u=[];!c.isEmpty();)u=u.concat(B(c.first())),c=c.rest();return u};helpers.format=function(b,c,m){var t=function(){m=m||"#<function>";for(var t=b.match(RegExp("~[sSaA]","g")),t=[m+": format string requires "+(null==t?0:t.length)+" arguments, but given "+c.length+"; arguments were:",types.toWrittenString(b)],
q=0;q<c.length;q++)t.push(types.toWrittenString(c[q]));j(types.incompleteExn(types.exnFailContract,t.join(" "),[]))},q=RegExp("~[sSaAn%~]","g"),L=c.slice(0),q=b.replace(q,function(b){if("~~"==b)return"~";if("~n"==b||"~%"==b)return"\n";if("~s"==b||"~S"==b)return 0==L.length&&t(),types.toWrittenString(L.shift());if("~a"==b||"~A"==b)return 0==L.length&&t(),types.toDisplayedString(L.shift());throw types.internalError("format: string.replace matched invalid regexp",!1);});0<L.length&&t();return q};helpers.forEachK=
function(b,c,m,t){var q=function(L){if(L>=b.length)t&&t();else try{c(b[L],function(){q(L+1)})}catch(j){m(j)}};q(0)};helpers.reportError=function(b){var c;c="undefined"!=typeof console&&"undefined"!=typeof console.log?function(b){console.log(b)}:function(b){alert(b)};"string"==typeof b?c(b):types.isSchemeError(b)?types.isExn(b.val)?c(""+types.exnMessage(b.val)):c(b.val):b.message?c(b.message):c(b.toString())};helpers.raise=j;helpers.procArityContains=function(b){return function(c){var m=function(c){return c instanceof
types.ContinuationClosureValue?!0:c.numParams==b||c.isRest&&c.numParams<=b},t=[];if(c instanceof types.ContinuationClosureValue||c instanceof types.ClosureValue||c instanceof types.PrimProc)return m(c);c instanceof types.CasePrimitive?t=c.cases:c instanceof types.CaseLambdaValue&&(t=c.closures);for(c=0;c<t.length;c++)if(m(t[c]))return!0;return!1}};helpers.throwCheckError=y;helpers.isList=b;helpers.isListOf=z;helpers.check=c;helpers.checkVarArity=function(b,u,m,t,q,L,j){if(0<j.length&&j[j.length-1]instanceof
Array){var z=[],B;for(B=0;B<j.length-1;B++)z.push(j[B]);j=z.concat(j[j.length-1])}c(b,u,m,t,q,L,j)};helpers.checkListOf=function(b,c,m,t,q,L,j){z(c,m)||helpers.throwCheckError(b,{functionName:t,typeName:"list of "+q,ordinalPosition:helpers.ordinalize(L),actualValue:c},L,j)};helpers.map=function(b,c){for(var m=Array(c.length),t=0;t<c.length;t++)m[t]=b(c[t]);return m};helpers.schemeListToArray=function(b){for(var c=[];!b.isEmpty();)c.push(b.first()),b=b.rest();return c};helpers.deepListToArray=I;helpers.flattenSchemeListToArray=
B;helpers.assocListToHash=function(b){for(var c={};!b.isEmpty();){var m=b.first().first(),t=b.first().rest().first();c[m]=t;b=b.rest()}return c};helpers.ordinalize=function(b){if(11==b%100)return b+"th";var c=b;switch(b%10){case 1:c+="st";break;case 2:c+="nd";break;case 3:c+="rd";break;default:c+="th"}return c};helpers.wrapJsObject=function(b){return void 0===b?types.jsObject("undefined",b):null===b?types.jsObject("null",b):"function"==typeof b?types.jsObject("function",b):b instanceof Array?types.jsObject("array",
b):"string"==typeof b?types.jsObject("'"+b.toString()+"'",b):types.jsObject(b.toString(),b)};helpers.getKeyCodeName=function(b){b=b.charCode||b.keyCode;switch(b){case 8:b="\u0008";break;case 16:b="shift";break;case 17:b="control";break;case 19:b="pause";break;case 27:b="escape";break;case 33:b="prior";break;case 34:b="next";break;case 35:b="end";break;case 36:b="home";break;case 37:b="left";break;case 38:b="up";break;case 39:b="right";break;case 40:b="down";break;case 42:b="print";break;case 45:b=
"insert";break;case 46:b=String.fromCharCode(127);break;case 144:b="numlock";break;case 145:b="scroll";break;default:b=112<=b&&123>=b?"f"+(b-111):""}return b};helpers.maybeCallAfterAttach=function(b){for(b=[b];0!==b.length;){var c=b.pop();c.afterAttach&&c.afterAttach(c);if(c.hasChildNodes&&c.hasChildNodes())for(var c=c.childNodes,m=0;m<c.length;m++)b.push(c[m])}};helpers.makeLocationDom=function(b){var c=document.createElement("span"),m=document.createElement("span"),t=document.createElement("span"),
q=document.createElement("span"),L=document.createElement("span"),j=document.createElement("span");c.className="location-reference";m.className="location-id";t.className="location-offset";q.className="location-line";L.className="location-column";j.className="location-span";m.appendChild(document.createTextNode(b.id+""));t.appendChild(document.createTextNode(b.offset+""));q.appendChild(document.createTextNode(b.line+""));L.appendChild(document.createTextNode(b.column+""));j.appendChild(document.createTextNode(b.span+
""));c.appendChild(m);c.appendChild(t);c.appendChild(q);c.appendChild(L);c.appendChild(j);return c};helpers.isLocationDom=function(b){return b&&(b.nodeType===Node.TEXT_NODE||b.nodeType===Node.ELEMENT_NODE)&&"location-reference"===b.className}})();var jsworld={};
(function(){function j(){}function F(b){fa.push(b)}function y(b){b=fa.indexOf(b);-1!=b&&fa.splice(b,1)}function c(){g=new j;fa=[];for(var b=0;b<ba.length;b++)ba[b]();ba=[];T=!1}function b(c,k){if(T)setTimeout(function(){b(c,k)},100);else{var e=g;T=!0;var p=function(b,c){b(g,e,c)},v=function(b){g=e;throw b;},E=function(){helpers.forEachK(fa,p,v,function(){T=!1;k()})};try{c(g,function(c){g=c;g instanceof w?(c=g.getEffects(),helpers.forEachK(c,function(c,v){c.invokeEffect(b,v)},function(b){throw b;},
function(){g=g.getWorld();E()})):E()})}catch(ma){throw g=e,"undefined"!==typeof console&&console.log&&ma.stack&&console.log(ma.stack),ma;}}}function z(b,c){for(var g=Array(b.length),k=0;k<b.length;k++)g[k]=c(b[k]);return g}function I(b,c){for(var g=[],k=0;k<b.length;k++)g=g.concat(c(b[k]));return g}function B(b,c){for(var g=0;g<b.length;g++)if(b[g]==c)return!0;return!1}function e(b){for(var c=[b],b=b.firstChild;null!=b;b=b.nextSibling)c.push(e(b));return c}function u(b){var c=[b.node];if(!0==b.node.jsworldOpaque)return c;
for(var g=0;g<b.children.length;g++)c=c.concat(u(b.children[g]));return c}function m(b){var c=[];if(!0==b.node.jsworldOpaque)return[];for(var g=0;g<b.children.length;g++)c.push({relation:"parent",parent:b.node,child:b.children[g].node});for(g=0;g<b.children.length-1;g++)c.push({relation:"neighbor",left:b.children[g].node,right:b.children[g+1].node});for(g=0;g<b.children.length;g++)c=c.concat(m(b.children[g]));return c}function t(b,c,g){function k(b,c){var v=b.compareDocumentPosition(c);return v&b.DOCUMENT_POSITION_CONTAINED_BY?
1:v&b.DOCUMENT_POSITION_CONTAINS||v&b.DOCUMENT_POSITION_FOLLOWING?-1:v&b.DOCUMENT_POSITION_PRECEDING?1:0}for(var v=0;v<g.length;v++)if("parent"==g[v].relation){var E=g[v].parent,e=g[v].child;e.parentNode&&E&&e.parentNode===E||E.appendChild(e)}for(E=!0;E;){E=!1;for(v=0;v<g.length;v++)if("neighbor"==g[v].relation){var e=g[v].left,w=g[v].right;if(!e.nextSibling||!(w&&e.nextSibling===w))e.parentNode.insertBefore(e,w),E=!0}}var T;try{T=c.concat(b).sort(k)}catch(p){T=null}g=b;for(b=b.parentNode;g!=b;){for(;!(null==
g.firstChild||g.jsworldOpaque);)g=g.firstChild;for(;g!=b;){e=g.nextSibling;E=g.parentNode;w=!1;if(null!=T)for(;0<T.length&&0<=k(g,T[0]);){if((v=T.shift())&&g&&v===g){w=!0;break}}else for(v=0;v<c.length;v++)if(c[v]&&g&&c[v]===g){w=!0;break}if(!w){if(!g.isJsworldOpaque)for(;null!=g.firstChild;)g.parentNode.appendChild(g.firstChild);e=g.nextSibling;g.parentNode.removeChild(g)}if(null==e)g=E;else{g=e;break}}}$(c)}function q(b){return b.replace(/\-(.)/g,function(b,c){return c.toUpperCase()})}function L(b,
c){for(var g=0;g<c.length;g++)b.style[q(c[g].attrib)]=c[g].values.join(" ")}function V(b,c){for(var g=0;g<b.length;g++);for(g=0;g<c.length;g++)if("id"in c[g])for(var k=0;k<b.length;k++)(c[g].id.match(/^\./)?"class"in b[k]&&B(b[k]["class"].split(/\s+/),c[g].id.substring(1)):"id"in b[k]&&b[k].id==c[g].id)&&L(b[k],c[g].attribs);else L(c[g].node,c[g].attribs)}function $(b){for(var c=0;c<b.length;c++)if(b[c].onWorldChange)b[c].onWorldChange(g)}function S(b,c,g,k,v,E){c instanceof j?k(b,function(c){var k=
ta(c),e=u(k);v(b,function(b){V(e,I(b,ca));t(g,e,m(k));E()})}):ya(function(E){function e(b,c){return ua?c(ua):v(b,c)}(function(b,c){return ra?c(ra):k(b,c)})(c,function(w){k(b,function(k){e(c,function(c){v(b,function(b){var v=ta(k),e=u(v);w!==k?(ra=k,V(e,I(b,ca)),t(g,e,m(v))):c!==b&&(ua=b,V(e,I(b,ca)));E()})})})})},E)}function ya(b,c){var g;void 0!=M?(g=new aa,b(function(){g.restore();c()})):b(c)}function aa(){this.focused=M;this.selectionStart=M.selectionStart;this.selectionEnd=M.selectionEnd}function Y(b,
c,g,k,v){this.top=b;this.world=c;this.handlers=k;this.handlerCreators=g;this.attribs=v}function na(g,k,e,w,v){c();var E=z(e,function(b){return b()});0<D.length&&D[D.length-1].pause();var T=new Y(g,k,e,E,w);D.push(T);F(function(b,c,v){T.world=b;v()});for(var p=new da(function(b,c){c(!1)},function(b,c){c(b)}),e=0;e<E.length;e++)if(E[e]instanceof da)p=E[e];else E[e].onRegister(g);F(function(b,c,E){p.test(b,function(k){k?(k=p.last_picture_handler(),k.onRegister(g),k._listener(b,c,function(){E()}),H.shutdown(),
v(b)):E()})});K(g,w);b(function(b,c){c(k)},G)}function da(b,c,g){this.test=b;this.receiver=c;this.last_picture_handler=g}function C(b,c,g){b.addEventListener?b.addEventListener(c,g,!1):b.attachEvent("on"+c,g,!1)}function X(c,g,k){var e=function(c){b(function(b,g){k(b,c,g)},G)};C(c,g,e);ba.push(function(){oa(c,g,e)})}function ga(c,g,k){var e=function(c){setTimeout(function(){b(function(b,g){k(b,c,g)},G)},0)};C(c,g,e);ba.push(function(){oa(c,g,e)})}function ka(b){C(b,"focus",function(){M=b});C(b,"blur",
function(){M=void 0});return b}function ta(b){return isPage(b)?ta(e(b.toDomNode())):void 0==b.length?{node:b,children:[]}:{node:b[0],children:z(b.slice(1),ta)}}function Z(b){return{attrib:b[0],values:b.slice(1)}}function ca(b){var c=z(b.slice(1),Z);return"string"==typeof b[0]?[{id:b[0],attribs:c}]:"length"in b[0]?z(b[0],function(b){return{id:b,attribs:c}}):[{node:b[0],attribs:c}]}function ha(b,c){if(!isPage(b))if(!b instanceof Array&&Fa(b,c),0==b.length&&Fa(b,c),b[0].nodeType==Node.TEXT_NODE){if(1<
b.length)throw new W(helpers.format("Text node ~s can not have children",[b]),b);}else if(b[0].nodeType==Node.ELEMENT_NODE)for(var g=1;g<b.length;g++)ha(b[g],b);else throw new W(helpers.format("expected a Text or an Element, received ~s within ~s",[b,c]),b[0]);}function W(b,c){this.msg=b;this.elt=c}function K(b,c){if(c)for(a in c)Object.hasOwnProperty.call(c,a)&&("function"==typeof c[a]?X(b,a,c[a]):b[a]=c[a]);return b}function N(b){return ka(K(document.createElement("div"),b))}function Ba(b){var c=
document.createElement("div");c.appendChild(document.createTextNode(b));c.style["white-space"]="pre";c.jsworldOpaque=!0;return c}function p(b){var c=document.createElement("option");c.text=b.value;c.value=b.value;return c}jsworld.Jsworld={};var H=jsworld.Jsworld,M=!1,G=function(){},g=new j,T=!1,fa=[],ba=[],D=[];H.shutdown=function(){for(;0<D.length;){var b=D.pop();b&&b.pause()}c()};H.change_world=b;Number.prototype.NaN0=function(){return isNaN(this)?0:this};H.getPosition=function(b){for(var c=0,g=
0;b.offsetParent;)c+=b.offsetLeft+(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():0),g+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():0),b=b.offsetParent;c+=b.offsetLeft+(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():0);g+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():0);return{x:c,y:g}};var P=0;H.gensym=function(){return P++};H.map=z;H.mapi=function(b,c){for(var g=Array(b.length),k=0;k<b.length;k++)g[k]=c(b[k],
k);return g};H.fold=function(b,c,g){for(var k=0;k<b.length;k++)c=g(b[k],c);return c};H.augment=function(b,c){var g={},k;for(k in b)g[k]=b[k];for(k in c)g[k]=c[k];return g};H.assoc_cons=function(b,c,g){var k={},v;for(v in b)k[v]=b[v];k[c]=g;return k};H.cons=function(b,c){return[b].concat(c)};H.append=function(b,c){return b.concat(c)};H.array_join=function(b,c){for(var g=[],k=0;k<b.length;k++)g.push([b[k],c[k]]);return g};H.removeq=function(b,c){for(var g=0;g<b.length;g++)if(b[g]===c)return b.slice(0,
g).concat(b.slice(g+1));return b};H.removef=function(b){for(var c=0;c<b.length;c++)if(f(b[c]))return b.slice(0,c).concat(b.slice(c+1));return b};H.filter=function(b,c){for(var g=[],k=0;k<b.length;k++)c(b[k])&&g.push(b[k]);return g};H.without=function(b,c){var g={},k;for(k in b)k!=c&&(g[k]=b[k]);return g};H.memberq=function(b,c){for(var g=0;g<b.length;g++)if(b[g]===c)return!0;return!1};H.member=B;H.head=function(b){return b[0]};H.tail=function(b){return b.slice(1,b.length)};H.node_to_tree=e;var ra,
ua;aa.prototype.restore=function(){if(this.focused.parentNode)this.focused.selectionStart=this.selectionStart,this.focused.selectionEnd=this.selectionEnd,this.focused.focus();else if(this.focused.id){var b=document.getElementById(this.focused.id);b&&(b.selectionStart=this.selectionStart,b.selectionEnd=this.selectionEnd,b.focus())}};Y.prototype.restart=function(){na(this.top,this.world,this.handlerCreators,this.attribs)};Y.prototype.pause=function(){for(var b=0;b<this.handlers.length;b++)if(!(this.handlers[b]instanceof
da))this.handlers[b].onUnregister(top)};H.big_bang=na;H.on_tick=function(c,g){return function(){var k,e=function(){k=setTimeout(v,c)},v=function(){b(g,e)};return{onRegister:function(){e()},onUnregister:function(){k&&clearTimeout(k)}}}};H.on_key=function(c){return function(){var g=!1,k=function(){g=!1},e,v=function(b,g){c(b,e,g)},E=function(c){if(27!=c.keyCode){e=c;if("keydown"===e.type&&""===helpers.getKeyCodeName(e)&&!e.altKey)return!1;"keydown"===e.type&&""!==helpers.getKeyCodeName(e)&&ia(e);za(e);
g!==e.type&&(g=e.type,b(v,k))}};return{onRegister:function(b){C(b,"keypress",E);C(b,"keydown",E)},onUnregister:function(b){oa(b,"keypress",E);oa(b,"keydown",E)}}}};H.on_mouse=function(c){return function(){var g,k,e=!1,v=function(){e=!1},E=function(b,v){c(b,g,v)},w=function(c){g=c;k&&k.focus();ia(g);za(g);e||(e=!0,b(E,v))};return{onRegister:function(b){k=b;C(k,"mousedown",w);C(k,"mouseup",w);C(k,"mousemove",w)},onUnregister:function(b){oa(b,"mousedown",w);oa(b,"mouseup",w);oa(b,"mousemove",w)}}}};
H.on_tap=function(c){return function(){var g,k,e=!1,v=function(){e=!1},E=function(b,v){c(b,g,v)},w=function(c){g=c;k&&k.focus();ia(g);za(g);e||(e=!0,b(E,v))};return{onRegister:function(b){k=b;C(k,"touchstart",w)},onUnregister:function(b){oa(b,"touchstart",w)}}}};H.on_tilt=function(c){return function(){var g,k=0,e=0,v,E=function(b,g){c(b,k,e,g)},w=function(){b(E,T)},T=function(){v=setTimeout(w,250)};return window.DeviceOrientationEvent?(g=function(b){ia(b);za(b);null===b.gamma||null===b.beta?v&&(clearTimeout(v),
v=void 0):0===window.orientation?(k=b.gamma,e=b.beta):90===window.orientation?(k=b.beta,e=-b.gamma):-90===window.orientation?(k=-b.beta,e=b.gamma):180===window.orientation?(k=-b.gamma,e=-b.beta):(k=b.gamma,e=b.beta)},{onRegister:function(){C(window,"deviceorientation",g);T()},onUnregister:function(){v&&clearTimeout(v);oa(window,"deviceorientation",g)}}):{onRegister:function(){},onUnregister:function(){}}}};H.on_draw=function(b,c){var g,k=function(b){ha(b,b);g(b)},v=function(c,v){g=v;b(c,k)};return function(){var b=
{_top:null,_listener:function(g,k,e){S(g,k,b._top,v,c,e)},onRegister:function(c){b._top=c;F(b._listener)},onUnregister:function(){y(b._listener)}};return b}};H.stop_when=function(b,c,g){return function(){void 0==c&&(c=function(b,c){c(b)});return new da(b,c,g)}};H.on_world_change=function(b){var c=function(c,g,v){b(c,v)};return function(){return{onRegister:function(){F(c)},onUnregister:function(){y(c)}}}};var oa=function(b,c,g){b.addEventListener?b.removeEventListener(c,g,!1):b.detachEvent("on"+c,
g,!1)},Fa=function(b,c){throw new W(helpers.format("Expected a non-empty array, received ~s within ~s",[b,c]),b);};W.prototype.toString=function(){return"on-draw: "+this.msg};H.p=function(b){return ka(K(document.createElement("p"),b))};H.div=N;H.button=function(b,c){var g=document.createElement("button");g.onclick=function(){return!1};X(g,"click",b);return ka(K(g,c))};var ia=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1},za=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=
!0},pa=function(b){C(b,"click",function(b){za(b)});return b};H.input=function(b,c,g){var b=b.toLowerCase(),e={text:qa,password:qa,checkbox:k};if(e[b])return e[b](b,c,g);throw Error("js-input: does not currently support type "+b);};var qa=function(c,g,k){var e=document.createElement("input");e.type=c;ga(e,"keypress",function(b,c,v){g(b,e.value,v)});var v=e.value,E=setInterval(function(){e.parentNode?v!=e.value&&(v=e.value,b(function(b,c){g(b,e.value,c)},G)):clearInterval(E)},1E3);return pa(ka(K(e,
k)))},k=function(b,c,g){var k=document.createElement("input");k.type=b;ga(k,"change",function(b,g,e){c(b,k.checked,e)});C(k,"click",function(b){za(b)});return K(k,g)};H.text=Ba;H.select=function(b,c,g){for(var k=document.createElement("select"),v=0;v<c.length;v++)k.add(p({value:c[v]}),null);k.jsworldOpaque=!0;X(k,"change",g);return ka(K(k,b))};H.textarea=function(b){return ka(K(document.createElement("textarea"),b))};H.h1=function(b){return ka(K(document.createElement("h1"),b))};H.canvas=function(b){return ka(K(document.createElement("canvas"),
b))};H.img=function(b,c){var g=document.createElement("img");g.src=b;return ka(K(g,c))};H.raw_node=function(b,c){return ka(K(b,c))};var w=function(b,c){b instanceof w?(this.w=b.w,this.e=b.e.concat(c)):(this.w=b,this.e=c)};w.prototype.getWorld=function(){return this.w};w.prototype.getEffects=function(){return this.e};H.with_effect=function(b,c){return new w(b,[c])};H.with_multiple_effects=function(b,c){return new w(b,c)};H.has_effects=function(b){return b instanceof w};H.alert_effect=function(b){return new Sa(b)};
var Sa=function(b){this.msg=b};Sa.prototype.invokeEffect=function(b){alert(this.msg);b()};H.music_effect=function(b){return new O(b)};var O=function(b){this.musicUrl=b};O.prototype.invokeEffect=function(b){(new Audio(url)).play();b()};var U=function(b,c){"undefined"===typeof b&&(b=[]);this.elts=b;this.attribs=c};U.prototype.add=function(b,c,g){return new U(this.elts.concat([{elt:b,positionTop:g,positionLeft:c}]),this.attribs)};U.prototype.toDomNode=function(){for(var b=N(),c=0;c<this.elts.length;c++){var g=
this.elts[c].elt;g.style||(g.style="");g.style.position="absolute";g.style.left=this.elts[c].positionLeft+"px";g.style.top=this.elts[c].positionTop+"px";b.appendChild(g)}K(b,this.attribs);return b};isPage=function(b){return b instanceof U};H.isPage=isPage;H.emptyPage=function(b){return new U([],b)};H.placeOnPage=function(b,c,g,k){"string"===typeof b&&(b=Ba(b));return k.add(b,c,g)};H.getCurrentWorld=function(){return g}})();var __PLTNUMBERS_TOP__;
"undefined"!==typeof exports?__PLTNUMBERS_TOP__=exports:(this.jsnums||(this.jsnums={}),__PLTNUMBERS_TOP__=this.jsnums);
(function(){function j(d){return RegExp("^([+-]?["+d+"]+)/(["+d+"]+)$")}function F(d){return RegExp("^[+-]?["+d+"]+$")}function y(d){return RegExp("^(?:([+-]?)("+("(["+d+"]*)\\.(["+d+"]+)")+"|"+("(["+d+"]+)\\.(["+d+"]*)")+"))$")}function c(d,i){return RegExp("^(?:([+-]?(?:"+("["+d+"]+")+"|"+("["+d+"]*\\.["+d+"]+")+"|"+("["+d+"]+\\.["+d+"]*")+"))["+i+"]([+-]?["+d+"]+))$")}function b(d){return 2===d?"01":8===d?"0-7":10===d?"0-9":16===d?"0-9a-fA-F":D("digitsForRadix: invalid radix",this,d)}function z(d){return 2===
d||8===d||10===d?"defsl":16===d?"sl":D("expMarkForRadix: invalid radix",this,d)}function I(d){this.defaultp=function(){return 0==d};this.exactp=function(){return 1==d};this.inexactp=function(){return 2==d}}function B(d,i,o,h){var g=d.match(j(b(i)));if(g)return Q.makeInstance(B(g[1],i,o),B(g[2],i,o));if("+nan.0"===d||"-nan.0"===d)return A.nan;if("+inf.0"===d)return A.inf;if("-inf.0"===d)return A.neginf;if("-0.0"===d)return Ya;if(g=d.match(y(b(i)))){var d=g[1],v=void 0!==g[3]?g[3]:g[5],h=void 0!==g[4]?
g[4]:g[6],d="-"==d?-1:1,g=""===v?0:o.intAsExactp()?B(v,i,I.on,!0):parseInt(v,i),v=""===h?0:o.intAsExactp()?B(h,i,I.on,!0):parseInt(h,i),i=o.intAsExactp()?Xa(i,h.length):Math.pow(i,h.length),i=""===h?0:o.intAsExactp()?la(v,i):v/i;o.floatAsInexactp()?(o=U(d,w(g,i)),o="number"===typeof o?A.makeInstance(o):o.toInexact()):o=U(d,w(g,i));return o}if(g=d.match(c(b(i),z(i))))return d=B(g[1],i,o),o=B(g[2],i,o),U(d,Xa(i,o));if(d.match(F(b(i))))return i=parseInt(d,i),Ma(i)?Ca(d):o.intAsExactp()?i:A.makeInstance(i);
if(h)0===d.length&&D("no digits"),D("bad number: "+d,this);else return!1}function e(d,i,b){null!=d&&("number"==typeof d?this.fromNumber(d,i,b):null==i&&"string"!=typeof d?this.fromString(d,256):this.fromString(d,i))}function u(){return new e(null)}function m(d,i,b,o,c,h){for(;0<=--h;){var g=i*this[d++]+b[o]+c,c=Math.floor(g/67108864);b[o++]=g&67108863}return c}function t(d,i,b,o,c,h){for(var g=i&32767,i=i>>15;0<=--h;){var v=this[d]&32767,ja=this[d++]>>15,l=i*v+ja*g,v=g*v+((l&32767)<<15)+b[o]+(c&1073741823),
c=(v>>>30)+(l>>>15)+i*ja+(c>>>30);b[o++]=v&1073741823}return c}function q(d,i,b,o,c,h){for(var g=i&16383,i=i>>14;0<=--h;){var v=this[d]&16383,ja=this[d++]>>14,l=i*v+ja*g,v=g*v+((l&16383)<<14)+b[o]+c,c=(v>>28)+(l>>14)+i*ja;b[o++]=v&268435455}return c}function L(d,i){var b=rb[d.charCodeAt(i)];return null==b?-1:b}function V(d){var i=u();i.fromInt(d);return i}function $(d){var i=this.s-d.s;if(0!=i)return i;var b=this.t,i=0>this.s?d.t-b:b-d.t;if(0!=i)return i;for(;0<=--b;)if(0!=(i=this[b]-d[b]))return i;
return 0}function S(d){var i=1,b;if(0!=(b=d>>>16))d=b,i+=16;if(0!=(b=d>>8))d=b,i+=8;if(0!=(b=d>>4))d=b,i+=4;if(0!=(b=d>>2))d=b,i+=2;0!=d>>1&&(i+=1);return i}function ya(d){var i=u();this.abs().divRemTo(d,null,i);0>this.s&&0<i.compareTo(e.ZERO)&&d.subTo(i,i);return i}function aa(d){this.m=d}function Y(d){this.m=d;this.mp=d.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<d.DB-15)-1;this.mt2=2*d.t}function na(d){return 0==this.compareTo(d)}function da(d,i){return d&i}function C(d,
i){return d|i}function X(d,i){return d^i}function ga(d,i){return d&~i}function ka(d){var i=u();this.addTo(d,i);return i}function ta(d){var i=u();this.subTo(d,i);return i}function Z(d){var i=u();this.multiplyTo(d,i);return i}function ca(d){var i=u();this.divRemTo(d,i,null);return i}function ha(d){var i=u();this.divRemTo(d,null,i);return i}function W(d){var i=u(),b=u();this.divRemTo(d,i,b);return[i,b]}function K(){}function N(d){return d}function Ba(d){return this.bnpExp(d,new K)}function p(d){this.r2=
u();this.q3=u();e.ONE.dlShiftTo(2*d.t,this.r2);this.mu=this.r2.divide(d);this.m=d}function H(d){var i=0>this.s?this.negate():this.clone(),d=0>d.s?d.negate():d.clone();if(0>i.compareTo(d))var b=i,i=d,d=b;var b=i.getLowestSetBit(),o=d.getLowestSetBit();if(0>o)return i;b<o&&(o=b);0<o&&(i.rShiftTo(o,i),d.rShiftTo(o,d));for(;0<i.signum();)0<(b=i.getLowestSetBit())&&i.rShiftTo(b,i),0<(b=d.getLowestSetBit())&&d.rShiftTo(b,d),0<=i.compareTo(d)?(i.subTo(d,i),i.rShiftTo(1,i)):(d.subTo(i,d),d.rShiftTo(1,d));
0<o&&d.lShiftTo(o,d);return d}function M(d){return function(){var i=this.toInexact();return i[d].apply(i,arguments)}}var G=__PLTNUMBERS_TOP__,g=function(d,i,b){b=b||{};return function(o,c){if(b.isXSpecialCase&&b.isXSpecialCase(o))return b.onXSpecialCase(o,c);if(b.isYSpecialCase&&b.isYSpecialCase(c))return b.onYSpecialCase(o,c);if("number"===typeof o&&"number"===typeof c)return d(o,c);"number"===typeof o&&(o=ba(o,c));"number"===typeof c&&(c=ba(c,o));o.level<c.level&&(o=o.liftTo(c));c.level<o.level&&
(c=c.liftTo(o));return i(o,c)}},T=function(d){var i=d.match(c(b(10),z(10)));return i?(d=i[1].match(/^([^.]*)(.*)$/),i=Number(i[2]),0===d[2].length?d[1]+fa(i):i>=d[2].length-1?d[1]+d[2].substring(1)+fa(i-(d[2].length-1)):d[1]+d[2].substring(1,1+i)):d},fa=function(d){var i=[];i.length=d;for(var b=0;b<d;b++)i[b]="0";return i.join("")},ba=function(d,i){switch(i.level){case 0:return Ca(d);case 1:return new Q(d,1);case 2:return new A(d);case 3:return new J(d,0);default:D("IMPOSSIBLE: cannot lift fixnum integer to "+
i.toString(),d,i)}},D=function(d,i,b){G.onThrowRuntimeError(d,i,b)},P=function(d){return"number"===typeof d||d instanceof Q||d instanceof A||d instanceof J||d instanceof e},ra=function(d){return"number"===typeof d||P(d)&&d.isRational()},ua=function(d){return"number"===typeof d||P(d)&&d.isReal()},oa=function(d){return"number"===typeof d||P(d)&&d.isExact()},Fa=function(d){return"number"===typeof d?!1:P(d)&&d.isInexact()},ia=function(d){return"number"===typeof d||P(d)&&d.isInteger()},za=function(d){return"number"===
typeof d||P(d)&&d.isInteger()&&d.isExact()},pa=function(d){return"number"===typeof d?d:d.toFixnum()},qa=function(d){return"number"===typeof d?d:d.toExact()},k=function(d){return"number"===typeof d?A.makeInstance(d):d.toInexact()},w=function(d,i){return"number"===typeof d&&"number"===typeof i&&Ma(d+i)?Ca(d).add(Ca(i)):d instanceof A&&i instanceof A?d.add(i):Sa(d,i)},Sa=g(function(d,i){var b=d+i;return Ma(b)?Ca(d).add(Ca(i)):b},function(d,i){return d.add(i)},{isXSpecialCase:function(d){return za(d)&&
o(d)},onXSpecialCase:function(d,i){return i},isYSpecialCase:function(d){return za(d)&&o(d)},onYSpecialCase:function(d){return d}}),O=g(function(d,i){var b=d-i;return Ma(b)?Ca(d).subtract(Ca(i)):b},function(d,i){return d.subtract(i)},{isXSpecialCase:function(d){return za(d)&&o(d)},onXSpecialCase:function(d,i){return Da(i)},isYSpecialCase:function(d){return za(d)&&o(d)},onYSpecialCase:function(d){return d}}),U=function(d,i){var b;return"number"===typeof d&&"number"===typeof i?(b=d*i,Ma(b)?Ca(d).multiply(Ca(i)):
b):d instanceof A&&i instanceof A?d.multiply(i):ea(d,i)},ea=g(function(d,i){var b=d*i;return Ma(b)?Ca(d).multiply(Ca(i)):b},function(d,i){return d.multiply(i)},{isXSpecialCase:function(d){return za(d)&&(o(d)||h(d)||ja(d))},onXSpecialCase:function(d,i){if(o(d))return 0;if(h(d))return i;if(ja(d))return Da(i)},isYSpecialCase:function(d){return za(d)&&(o(d)||h(d)||ja(d))},onYSpecialCase:function(d,i){if(o(i))return 0;if(h(i))return d;if(ja(i))return Da(d)}}),la=g(function(d,i){o(i)&&D("/: division by zero",
d,i);var b=d/i;return Ma(b)?Ca(d).divide(Ca(i)):Math.floor(b)!==b?Q.makeInstance(d,i):b},function(d,i){return d.divide(i)},{isXSpecialCase:function(d){return sa(d,0)},onXSpecialCase:function(d,i){sa(i,0)&&D("/: division by zero",d,i);return 0},isYSpecialCase:function(d){return sa(d,0)},onYSpecialCase:function(d,i){D("/: division by zero",d,i)}}),wa=g(function(d,i){return d===i},function(d,i){return d.equals(i)}),sa=function(d,i){if(d===i)return!0;if("number"===typeof d&&"number"===typeof i||d===Ya||
i===Ya)return d===i;if(d instanceof J||i instanceof J)return sa(Oa(d),Oa(i))&&sa(Ta(d),Ta(i));var b=oa(d),o=oa(i);return(b&&o||!b&&!o)&&wa(d,i)},v=g(function(d,i){return d>=i},function(d,i){(!ua(d)||!ua(i))&&D(">=: couldn't be applied to complex number",d,i);return d.greaterThanOrEqual(i)}),E=g(function(d,i){return d<=i},function(d,i){(!ua(d)||!ua(i))&&D("<=: couldn't be applied to complex number",d,i);return d.lessThanOrEqual(i)}),ma=g(function(d,i){return d>i},function(d,i){(!ua(d)||!ua(i))&&D(">: couldn't be applied to complex number",
d,i);return d.greaterThan(i)}),Ka=g(function(d,i){return d<i},function(d,i){(!ua(d)||!ua(i))&&D("<: couldn't be applied to complex number",d,i);return d.lessThan(i)}),Xa=function(){var d=g(function(d,i){var b=Math.pow(d,i);return Ma(b)?Ca(d).expt(Ca(i)):b},function(d,i){return wa(i,0)?w(i,1):d.expt(i)});return function(i,b){return wa(b,0)?w(b,1):ua(b)&&Ka(b,0)?d(la(1,i),Da(b)):d(i,b)}}(),Ea=function(d){return sa(d,0)?1:"number"===typeof d?A.makeInstance(Math.exp(d)):d.exp()},fb=function(d,b){ia(d)||
D("modulo: the first argument "+d+" is not an integer.",d,b);ia(b)||D("modulo: the second argument "+b+" is not an integer.",d,b);var o;if("number"===typeof d)return o=d%b,0>b?0>=o?o:o+b:0>o?o+b:o;o=i(l(d),l(b));return Ka(b,0)?E(o,0)?o:w(o,b):Ka(o,0)?w(o,b):o},$a=function(d){return"number"===typeof d?d:d.numerator()},Ia=function(d){return"number"===typeof d?1:d.denominator()},Ja=function(d){return"number"===typeof d?0<=d?(d=Math.sqrt(d),Math.floor(d)===d?d:A.makeInstance(d)):J.makeInstance(0,Ja(-d)):
d.sqrt()},R=function(d){return"number"===typeof d?Math.abs(d):d.abs()},l=function(d){return"number"===typeof d?d:d.floor()},xa=function(d){return"number"===typeof d?d:d.ceiling()},va=function(d){return"number"===typeof d?d:d.conjugate()},Aa=function(d){return sa(d,1)?0:"number"===typeof d?A.makeInstance(Math.log(d)):d.log()},Ua=function(d){return"number"===typeof d?0<d?0:A.pi:d.angle()},Za=function(d){return sa(d,0)?0:"number"===typeof d?A.makeInstance(Math.tan(d)):d.tan()},cb=function(d){return sa(d,
0)?0:"number"===typeof d?A.makeInstance(Math.atan(d)):d.atan()},gb=function(d){return sa(d,0)?1:"number"===typeof d?A.makeInstance(Math.cos(d)):d.cos()},Wa=function(d){return sa(d,0)?0:"number"===typeof d?A.makeInstance(Math.sin(d)):d.sin()},hb=function(d){return sa(d,1)?0:"number"===typeof d?A.makeInstance(Math.acos(d)):d.acos()},lb=function(d){return sa(d,0)?0:"number"===typeof d?A.makeInstance(Math.asin(d)):d.asin()},Ta=function(d){return"number"===typeof d?0:d.imaginaryPart()},Oa=function(d){return"number"===
typeof d?d:d.realPart()},db=function(d){return"number"===typeof d?d:d.round()},Qa=function(d){return U(d,d)},mb=function(d){ia(d)||D("integer-sqrt: the argument "+d.toString()+" is not an integer.",d);return"number"===typeof d?0>d?J.makeInstance(0,Math.floor(Math.sqrt(-d))):Math.floor(Math.sqrt(d)):d.integerSqrt()},eb=function(d,i){ia(d)||D("quotient: the first argument "+d.toString()+" is not an integer.",d);ia(i)||D("quotient: the second argument "+i.toString()+" is not an integer.",i);return ib(d,
i)},ab=function(d,i){ia(d)||D("remainder: the first argument "+d.toString()+" is not an integer.",d);ia(i)||D("remainder: the second argument "+i.toString()+" is not an integer.",i);return sb(d,i)},Ma=function(d){return-9E15>d||9E15<d},Da=function(d){return"number"===typeof d?-d:d.negate()},nb=function(d,i){for(var b=1;;){if(o(i))return b;wa(fb(i,2),0)?(d=U(d,d),i=la(i,2)):(b=U(b,d),i=O(i,1))}},La=function(d,i,b){b=b||{};return function(o,c){o instanceof Q?o=$a(o):o instanceof J&&(o=Oa(o));c instanceof
Q?c=$a(c):c instanceof J&&(c=Oa(c));if("number"===typeof o&&"number"===typeof c){var h=d(o,c);if(!Ma(h)||b.ignoreOverflow)return h}if(o instanceof A||c instanceof A)return b.doNotCoerseToFloating?d(pa(o),pa(c)):A.makeInstance(d(pa(o),pa(c)));"number"===typeof o&&(o=Ca(o));"number"===typeof c&&(c=Ca(c));return i(o,c)}},jb=function(d,i,b){b=b||{};return function(o){o instanceof Q?o=$a(o):o instanceof J&&(o=Oa(o));if("number"===typeof o){var c=d(o);if(!Ma(c)||b.ignoreOverflow)return c}if(o instanceof
A)return d(pa(o));"number"===typeof o&&(o=Ca(o));return i(o)}},i=La(function(d,i){return d%i},function(d,i){return ya.call(d,i)}),d=La(function(d,i){for(var b;0!==i;)b=d,d=i,i=b%i;return d},function(d,i){return H.call(d,i)}),o=jb(function(d){return 0===d},function(d){return na.call(d,e.ZERO)}),h=jb(function(d){return 1===d},function(d){return na.call(d,e.ONE)}),ja=jb(function(d){return-1===d},function(d){return na.call(d,e.NEGATIVE_ONE)}),Ga=La(function(d,i){return d+i},function(d,i){return ka.call(d,
i)}),Bb=La(function(d,i){return d-i},function(d,i){return ta.call(d,i)}),Ha=La(function(d,i){return d*i},function(d,i){return Z.call(d,i)}),ib=La(function(d,i){return(d-d%i)/i},function(d,i){return ca.call(d,i)}),sb=La(function(d,i){return d%i},function(d,i){return ha.call(d,i)}),Pa=La(function(d,i){return d/i},function(d,i){return pa(d)/pa(i)},{ignoreOverflow:!0,doNotCoerseToFloating:!0}),tb=La(function(d,i){return d===i},function(d,i){return na.call(d,i)},{doNotCoerseToFloating:!0}),ub=La(function(d,
i){return d>i},function(d,i){return 0<$.call(d,i)},{doNotCoerseToFloating:!0}),ob=La(function(d,i){return d<i},function(d,i){return 0>$.call(d,i)},{doNotCoerseToFloating:!0}),vb=La(function(d,i){return d>=i},function(d,i){return 0<=$.call(d,i)},{doNotCoerseToFloating:!0}),Cb=La(function(d,i){return d<=i},function(d,i){return 0>=$.call(d,i)},{doNotCoerseToFloating:!0}),Q=function(d,i){this.n=d;this.d=i};Q.prototype.toString=function(){return h(this.d)?this.n.toString()+"":this.n.toString()+"/"+this.d.toString()};
Q.prototype.level=1;Q.prototype.liftTo=function(d){return 2===d.level?new A(Pa(this.n,this.d)):3===d.level?new J(this,0):D("invalid level of Number",this,d)};Q.prototype.isFinite=function(){return!0};Q.prototype.equals=function(d){return d instanceof Q&&tb(this.n,d.n)&&tb(this.d,d.d)};Q.prototype.isInteger=function(){return h(this.d)};Q.prototype.isRational=function(){return!0};Q.prototype.isReal=function(){return!0};Q.prototype.add=function(d){return Q.makeInstance(Ga(Ha(this.n,d.d),Ha(this.d,d.n)),
Ha(this.d,d.d))};Q.prototype.subtract=function(d){return Q.makeInstance(Bb(Ha(this.n,d.d),Ha(this.d,d.n)),Ha(this.d,d.d))};Q.prototype.negate=function(){return Q.makeInstance(-this.n,this.d)};Q.prototype.multiply=function(d){return Q.makeInstance(Ha(this.n,d.n),Ha(this.d,d.d))};Q.prototype.divide=function(d){(o(this.d)||o(d.n))&&D("/: division by zero",this,d);return Q.makeInstance(Ha(this.n,d.d),Ha(this.d,d.n))};Q.prototype.toExact=function(){return this};Q.prototype.toInexact=function(){return A.makeInstance(this.toFixnum())};
Q.prototype.isExact=function(){return!0};Q.prototype.isInexact=function(){return!1};Q.prototype.toFixnum=function(){return Pa(this.n,this.d)};Q.prototype.numerator=function(){return this.n};Q.prototype.denominator=function(){return this.d};Q.prototype.greaterThan=function(d){return ub(Ha(this.n,d.d),Ha(this.d,d.n))};Q.prototype.greaterThanOrEqual=function(d){return vb(Ha(this.n,d.d),Ha(this.d,d.n))};Q.prototype.lessThan=function(d){return ob(Ha(this.n,d.d),Ha(this.d,d.n))};Q.prototype.lessThanOrEqual=
function(d){return Cb(Ha(this.n,d.d),Ha(this.d,d.n))};Q.prototype.integerSqrt=function(){var d=Ja(this);return ra(d)?qa(l(d)):ua(d)?qa(l(d)):J.makeInstance(qa(l(Oa(d))),qa(l(Ta(d))))};Q.prototype.sqrt=function(){if(vb(this.n,0)){var d=Ja(this.n),i=Ja(this.d);return wa(l(d),d)&&wa(l(i),i)?Q.makeInstance(d,i):A.makeInstance(Pa(d,i))}d=Ja(Da(this.n));i=Ja(this.d);return wa(l(d),d)&&wa(l(i),i)?J.makeInstance(0,Q.makeInstance(d,i)):J.makeInstance(0,A.makeInstance(Pa(d,i)))};Q.prototype.abs=function(){return Q.makeInstance(R(this.n),
this.d)};Q.prototype.floor=function(){var d=ib(this.n,this.d);return ob(this.n,0)?O(d,1):d};Q.prototype.ceiling=function(){var d=ib(this.n,this.d);return ob(this.n,0)?d:w(d,1)};Q.prototype.conjugate=function(){return this};Q.prototype.magnitude=Q.prototype.abs;Q.prototype.log=function(){return A.makeInstance(Math.log(this.n/this.d))};Q.prototype.angle=function(){return o(this.n)?0:ub(this.n,0)?0:A.pi};Q.prototype.tan=function(){return A.makeInstance(Math.tan(Pa(this.n,this.d)))};Q.prototype.atan=
function(){return A.makeInstance(Math.atan(Pa(this.n,this.d)))};Q.prototype.cos=function(){return A.makeInstance(Math.cos(Pa(this.n,this.d)))};Q.prototype.sin=function(){return A.makeInstance(Math.sin(Pa(this.n,this.d)))};Q.prototype.expt=function(d){return za(d)&&v(d,0)?nb(this,d):A.makeInstance(Math.pow(Pa(this.n,this.d),Pa(d.n,d.d)))};Q.prototype.exp=function(){return A.makeInstance(Math.exp(Pa(this.n,this.d)))};Q.prototype.acos=function(){return A.makeInstance(Math.acos(Pa(this.n,this.d)))};Q.prototype.asin=
function(){return A.makeInstance(Math.asin(Pa(this.n,this.d)))};Q.prototype.imaginaryPart=function(){return 0};Q.prototype.realPart=function(){return this};Q.prototype.round=function(){var d=wa(this.d,2),i=ob(this.n,0),b=this.n;i&&(b=Da(b));var o=ib(b,this.d);d?o=w(o,1):(d=sb(b,this.d),ma(U(d,2),this.d)&&(o=w(o,1)));i&&(o=Da(o));return o};Q.makeInstance=function(i,b){void 0===i&&D("n undefined",i,b);void 0===b&&(b=1);o(b)&&D("division by zero: "+i+"/"+b);ob(b,0)&&(i=Da(i),b=Da(b));var c=d(R(i),R(b)),
i=ib(i,c),b=ib(b,c);return h(b)||o(i)?i:new Q(i,b)};var A=function(d){this.n=d},pb=new A(Number.NaN),Db=new A(Number.POSITIVE_INFINITY),wb=new A(Number.NEGATIVE_INFINITY),xb=new A(Number.POSITIVE_INFINITY),yb=new A(Number.NEGATIVE_INFINITY),Ya=new A(-0.0),zb=new A(0);A.pi=new A(Math.PI);A.e=new A(Math.E);A.nan=pb;A.inf=Db;A.neginf=wb;A.makeInstance=function(d){return isNaN(d)?A.nan:d===Number.POSITIVE_INFINITY?A.inf:d===Number.NEGATIVE_INFINITY?A.neginf:0===d?-Infinity===1/d?Ya:zb:new A(d)};A.prototype.isExact=
function(){return!1};A.prototype.isInexact=function(){return!0};A.prototype.isFinite=function(){return isFinite(this.n)||this===xb||this===yb};A.prototype.toExact=function(){(!isFinite(this.n)||isNaN(this.n))&&D("toExact: no exact representation for "+this,this);var d=this.n.toString().match(/^(.*)\.(.*)$/);return d?(parseInt(d[1]),parseInt(d[2]),d=Math.pow(10,d[2].length),Q.makeInstance(Math.round(this.n*d),d)):this.n};A.prototype.toInexact=function(){return this};A.prototype.isInexact=function(){return!0};
A.prototype.level=2;A.prototype.liftTo=function(d){return 3===d.level?new J(this,0):D("invalid level of Number",this,d)};A.prototype.toString=function(){if(isNaN(this.n))return"+nan.0";if(this.n===Number.POSITIVE_INFINITY)return"+inf.0";if(this.n===Number.NEGATIVE_INFINITY)return"-inf.0";if(this===Ya)return"-0.0";var d=this.n.toString();return d.match("\\.")?d:d+".0"};A.prototype.equals=function(d){return d instanceof A&&this.n===d.n};A.prototype.isRational=function(){return this.isFinite()};A.prototype.isInteger=
function(){return this.isFinite()&&this.n===Math.floor(this.n)};A.prototype.isReal=function(){return!0};var qb=function(d){return Ka(d,0)?-1:ma(d,0)?1:d===Ya?-1:0};A.prototype.add=function(d){return this.isFinite()&&d.isFinite()?A.makeInstance(this.n+d.n):isNaN(this.n)||isNaN(d.n)?pb:this.isFinite()&&!d.isFinite()?d:!this.isFinite()&&d.isFinite()?this:1===qb(this)*qb(d)?this:pb};A.prototype.subtract=function(d){return this.isFinite()&&d.isFinite()?A.makeInstance(this.n-d.n):isNaN(this.n)||isNaN(d.n)?
pb:!this.isFinite()&&!d.isFinite()?qb(this)===qb(d)?pb:this:this.isFinite()?U(d,-1):this};A.prototype.negate=function(){return A.makeInstance(-this.n)};A.prototype.multiply=function(d){return A.makeInstance(this.n*d.n)};A.prototype.divide=function(d){return A.makeInstance(this.n/d.n)};A.prototype.toFixnum=function(){return this.n};A.prototype.numerator=function(){var i=this.n.toString().match(/^(.*)\.(.*)$/);if(i){var b=parseInt(i[2]),i=Math.pow(10,i[2].length),b=d(i,b);return A.makeInstance(Math.round(this.n*
(i/b)))}return this};A.prototype.denominator=function(){var i=this.n.toString().match(/^(.*)\.(.*)$/);if(i){var b=parseInt(i[2]),i=Math.pow(10,i[2].length),b=d(i,b);return A.makeInstance(Math.round(i/b))}return A.makeInstance(1)};A.prototype.floor=function(){return A.makeInstance(Math.floor(this.n))};A.prototype.ceiling=function(){return A.makeInstance(Math.ceil(this.n))};A.prototype.greaterThan=function(d){return this.n>d.n};A.prototype.greaterThanOrEqual=function(d){return this.n>=d.n};A.prototype.lessThan=
function(d){return this.n<d.n};A.prototype.lessThanOrEqual=function(d){return this.n<=d.n};A.prototype.integerSqrt=function(){if(this===Ya)return this;if(ia(this))return 0<=this.n?A.makeInstance(Math.floor(Math.sqrt(this.n))):J.makeInstance(zb,A.makeInstance(Math.floor(Math.sqrt(-this.n))));D("integerSqrt: can only be applied to an integer",this)};A.prototype.sqrt=function(){return 0>this.n?J.makeInstance(0,A.makeInstance(Math.sqrt(-this.n))):A.makeInstance(Math.sqrt(this.n))};A.prototype.abs=function(){return A.makeInstance(Math.abs(this.n))};
A.prototype.log=function(){return 0>this.n?(new J(this,0)).log():A.makeInstance(Math.log(this.n))};A.prototype.angle=function(){return 0===this.n?0:0<this.n?0:A.pi};A.prototype.tan=function(){return A.makeInstance(Math.tan(this.n))};A.prototype.atan=function(){return A.makeInstance(Math.atan(this.n))};A.prototype.cos=function(){return A.makeInstance(Math.cos(this.n))};A.prototype.sin=function(){return A.makeInstance(Math.sin(this.n))};A.prototype.expt=function(d){return 1===this.n?(d.isFinite()||
isNaN(d.n),this):A.makeInstance(Math.pow(this.n,d.n))};A.prototype.exp=function(){return A.makeInstance(Math.exp(this.n))};A.prototype.acos=function(){return A.makeInstance(Math.acos(this.n))};A.prototype.asin=function(){return A.makeInstance(Math.asin(this.n))};A.prototype.imaginaryPart=function(){return 0};A.prototype.realPart=function(){return this};A.prototype.round=function(){return isFinite(this.n)?this===Ya?this:0.5===Math.abs(Math.floor(this.n)-this.n)?0===Math.floor(this.n)%2?A.makeInstance(Math.floor(this.n)):
A.makeInstance(Math.ceil(this.n)):A.makeInstance(Math.round(this.n)):this};A.prototype.conjugate=function(){return this};A.prototype.magnitude=A.prototype.abs;var J=function(d,i){this.r=d;this.i=i};J.makeInstance=function(d,i){void 0===i&&(i=0);if(oa(i)&&ia(i)&&o(i))return d;if(Fa(d)||Fa(i))d=k(d),i=k(i);return new J(d,i)};J.prototype.toString=function(){var d=this.r.toString(),i=this.i.toString();return"-"===i[0]||"+"===i[0]?d+i+"i":d+"+"+i+"i"};J.prototype.isFinite=function(){return("number"===
typeof this.r?isFinite(this.r):this.r.isFinite())&&("number"===typeof this.i?isFinite(this.i):this.i.isFinite())};J.prototype.isRational=function(){return ra(this.r)&&sa(this.i,0)};J.prototype.isInteger=function(){return ia(this.r)&&sa(this.i,0)};J.prototype.toExact=function(){return J.makeInstance(qa(this.r),qa(this.i))};J.prototype.toInexact=function(){return J.makeInstance(k(this.r),k(this.i))};J.prototype.isExact=function(){return oa(this.r)&&oa(this.i)};J.prototype.isInexact=function(){return Fa(this.r)||
Fa(this.i)};J.prototype.level=3;J.prototype.liftTo=function(d){D("Don't know how to lift Complex number",this,d)};J.prototype.equals=function(d){return d instanceof J&&wa(this.r,d.r)&&wa(this.i,d.i)};J.prototype.greaterThan=function(d){(!this.isReal()||!d.isReal())&&D(">: expects argument of type real number",this,d);return ma(this.r,d.r)};J.prototype.greaterThanOrEqual=function(d){(!this.isReal()||!d.isReal())&&D(">=: expects argument of type real number",this,d);return v(this.r,d.r)};J.prototype.lessThan=
function(d){(!this.isReal()||!d.isReal())&&D("<: expects argument of type real number",this,d);return Ka(this.r,d.r)};J.prototype.lessThanOrEqual=function(d){(!this.isReal()||!d.isReal())&&D("<=: expects argument of type real number",this,d);return E(this.r,d.r)};J.prototype.abs=function(){wa(this.i,0).valueOf()||D("abs: expects argument of type real number",this);return R(this.r)};J.prototype.toFixnum=function(){wa(this.i,0).valueOf()||D("toFixnum: expects argument of type real number",this);return pa(this.r)};
J.prototype.numerator=function(){this.isReal()||D("numerator: can only be applied to real number",this);return $a(this.n)};J.prototype.denominator=function(){this.isReal()||D("floor: can only be applied to real number",this);return Ia(this.n)};J.prototype.add=function(d){return J.makeInstance(w(this.r,d.r),w(this.i,d.i))};J.prototype.subtract=function(d){return J.makeInstance(O(this.r,d.r),O(this.i,d.i))};J.prototype.negate=function(){return J.makeInstance(Da(this.r),Da(this.i))};J.prototype.multiply=
function(d){if(d.isReal())return J.makeInstance(U(this.r,d.r),U(this.i,d.r));var i=O(U(this.r,d.r),U(this.i,d.i)),d=w(U(this.r,d.i),U(this.i,d.r));return J.makeInstance(i,d)};J.prototype.divide=function(d){var i,b,o,c,h;if(d.isReal())return J.makeInstance(la(this.r,d.r),la(this.i,d.r));if(this.isInexact()||d.isInexact())return i=this.r,b=this.i,o=d.r,c=d.i,E(R(c),R(o))?(h=la(c,o),d=la(w(i,U(b,h)),w(o,U(c,h))),i=la(O(b,U(i,h)),w(o,U(c,h)))):(h=la(o,c),d=la(w(U(i,h),b),w(U(o,h),c)),i=la(O(U(b,h),i),
w(U(o,h),c))),J.makeInstance(d,i);b=va(d);i=U(this,b);b=Oa(U(d,b));return J.makeInstance(la(Oa(i),b),la(Ta(i),b))};J.prototype.conjugate=function(){return J.makeInstance(this.r,O(0,this.i))};J.prototype.magnitude=function(){var d=w(U(this.r,this.r),U(this.i,this.i));return Ja(d)};J.prototype.isReal=function(){return sa(this.i,0)};J.prototype.integerSqrt=function(){if(ia(this))return mb(this.r);D("integerSqrt: can only be applied to an integer",this)};J.prototype.sqrt=function(){if(this.isReal())return Ja(this.r);
var d=w(this.magnitude(),this.r),i=Ja(la(d,2)),d=la(this.i,Ja(U(d,2)));return J.makeInstance(i,d)};J.prototype.log=function(){var d=this.magnitude(),i=this.angle();return w(Aa(d),U(i,Va))};J.prototype.angle=function(){if(this.isReal())return Ua(this.r);if(wa(0,this.r)){var d=la(A.pi,2);return ma(this.i,0)?d:Da(d)}d=cb(la(R(this.i),R(this.r)));return ma(this.r,0)?ma(this.i,0)?d:Da(d):ma(this.i,0)?O(A.pi,d):O(d,A.pi)};var Va=J.makeInstance(0,1),Ab=J.makeInstance(0,-1);J.prototype.tan=function(){return la(this.sin(),
this.cos())};J.prototype.atan=function(){return wa(this,Va)||wa(this,Ab)?wb:U(Va,U(A.makeInstance(0.5),Aa(la(w(Va,this),w(Va,O(0,this))))))};J.prototype.cos=function(){if(this.isReal())return gb(this.r);var d=U(this,Va),i=Da(d),d=w(Ea(d),Ea(i));return la(d,2)};J.prototype.sin=function(){if(this.isReal())return Wa(this.r);var d=U(this,Va),i=Da(d),b=J.makeInstance(0,2),d=O(Ea(d),Ea(i));return la(d,b)};J.prototype.expt=function(d){if(za(d)&&v(d,0))return nb(this,d);d=U(d,this.log());return Ea(d)};J.prototype.exp=
function(){var d=Ea(this.r),i=gb(this.i),b=Wa(this.i);return U(d,w(i,U(b,Va)))};J.prototype.acos=function(){if(this.isReal())return hb(this.r);var d=la(A.pi,2),i=U(this,Va),b=Ja(O(1,Qa(this))),i=Aa(w(i,b)),i=U(i,Va);return w(d,i)};J.prototype.asin=function(){if(this.isReal())return lb(this.r);var d=O(1,Qa(this)),d=Ja(d);return U(2,cb(la(this,w(1,d))))};J.prototype.ceiling=function(){this.isReal()||D("ceiling: can only be applied to real number",this);return xa(this.r)};J.prototype.floor=function(){this.isReal()||
D("floor: can only be applied to real number",this);return l(this.r)};J.prototype.imaginaryPart=function(){return this.i};J.prototype.realPart=function(){return this.r};J.prototype.round=function(){this.isReal()||D("round: can only be applied to real number",this);return db(this.r)};var Eb=/^(#[ei]#[bodx]|#[bodx]#[ei]|#[bodxei])(.*)$/;I.def=new I(0);I.on=new I(1);I.off=new I(2);I.prototype.intAsExactp=function(){return this.defaultp()||this.exactp()};I.prototype.floatAsInexactp=function(){return this.defaultp()||
this.inexactp()};var bb;"undefined"!==typeof navigator&&"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=t,bb=30):"undefined"!==typeof navigator&&"Netscape"!=navigator.appName?(e.prototype.am=m,bb=26):(e.prototype.am=q,bb=28);e.prototype.DB=bb;e.prototype.DM=(1<<bb)-1;e.prototype.DV=1<<bb;e.prototype.FV=Math.pow(2,52);e.prototype.F1=52-bb;e.prototype.F2=2*bb-52;var rb=[],kb,Ra;kb=48;for(Ra=0;9>=Ra;++Ra)rb[kb++]=Ra;kb=97;for(Ra=10;36>Ra;++Ra)rb[kb++]=Ra;kb=65;for(Ra=10;36>Ra;++Ra)rb[kb++]=
Ra;aa.prototype.convert=function(d){return 0>d.s||0<=d.compareTo(this.m)?d.mod(this.m):d};aa.prototype.revert=function(d){return d};aa.prototype.reduce=function(d){d.divRemTo(this.m,null,d)};aa.prototype.mulTo=function(d,i,b){d.multiplyTo(i,b);this.reduce(b)};aa.prototype.sqrTo=function(d,i){d.squareTo(i);this.reduce(i)};Y.prototype.convert=function(d){var i=u();d.abs().dlShiftTo(this.m.t,i);i.divRemTo(this.m,null,i);0>d.s&&0<i.compareTo(e.ZERO)&&this.m.subTo(i,i);return i};Y.prototype.revert=function(d){var i=
u();d.copyTo(i);this.reduce(i);return i};Y.prototype.reduce=function(d){for(;d.t<=this.mt2;)d[d.t++]=0;for(var i=0;i<this.m.t;++i){var b=d[i]&32767,o=b*this.mpl+((b*this.mph+(d[i]>>15)*this.mpl&this.um)<<15)&d.DM,b=i+this.m.t;for(d[b]+=this.m.am(0,o,d,i,0,this.m.t);d[b]>=d.DV;)d[b]-=d.DV,d[++b]++}d.clamp();d.drShiftTo(this.m.t,d);0<=d.compareTo(this.m)&&d.subTo(this.m,d)};Y.prototype.mulTo=function(d,i,b){d.multiplyTo(i,b);this.reduce(b)};Y.prototype.sqrTo=function(d,i){d.squareTo(i);this.reduce(i)};
e.prototype.copyTo=function(d){for(var i=this.t-1;0<=i;--i)d[i]=this[i];d.t=this.t;d.s=this.s};e.prototype.fromInt=function(d){this.t=1;this.s=0>d?-1:0;0<d?this[0]=d:-1>d?this[0]=d+DV:this.t=0};e.prototype.fromString=function(d,i){var b;if(16==i)b=4;else if(8==i)b=3;else if(256==i)b=8;else if(2==i)b=1;else if(32==i)b=5;else if(4==i)b=2;else{this.fromRadix(d,i);return}this.s=this.t=0;for(var o=d.length,c=!1,h=0;0<=--o;){var g=8==b?d[o]&255:L(d,o);0>g?"-"==d.charAt(o)&&(c=!0):(c=!1,0==h?this[this.t++]=
g:h+b>this.DB?(this[this.t-1]|=(g&(1<<this.DB-h)-1)<<h,this[this.t++]=g>>this.DB-h):this[this.t-1]|=g<<h,h+=b,h>=this.DB&&(h-=this.DB))}8==b&&0!=(d[0]&128)&&(this.s=-1,0<h&&(this[this.t-1]|=(1<<this.DB-h)-1<<h));this.clamp();c&&e.ZERO.subTo(this,this)};e.prototype.clamp=function(){for(var d=this.s&this.DM;0<this.t&&this[this.t-1]==d;)--this.t};e.prototype.dlShiftTo=function(d,i){var b;for(b=this.t-1;0<=b;--b)i[b+d]=this[b];for(b=d-1;0<=b;--b)i[b]=0;i.t=this.t+d;i.s=this.s};e.prototype.drShiftTo=function(d,
i){for(var b=d;b<this.t;++b)i[b-d]=this[b];i.t=Math.max(this.t-d,0);i.s=this.s};e.prototype.lShiftTo=function(d,i){var b=d%this.DB,o=this.DB-b,c=(1<<o)-1,h=Math.floor(d/this.DB),g=this.s<<b&this.DM,v;for(v=this.t-1;0<=v;--v)i[v+h+1]=this[v]>>o|g,g=(this[v]&c)<<b;for(v=h-1;0<=v;--v)i[v]=0;i[h]=g;i.t=this.t+h+1;i.s=this.s;i.clamp()};e.prototype.rShiftTo=function(d,i){i.s=this.s;var b=Math.floor(d/this.DB);if(b>=this.t)i.t=0;else{var o=d%this.DB,c=this.DB-o,h=(1<<o)-1;i[0]=this[b]>>o;for(var g=b+1;g<
this.t;++g)i[g-b-1]|=(this[g]&h)<<c,i[g-b]=this[g]>>o;0<o&&(i[this.t-b-1]|=(this.s&h)<<c);i.t=this.t-b;i.clamp()}};e.prototype.subTo=function(d,i){for(var b=0,o=0,c=Math.min(d.t,this.t);b<c;)o+=this[b]-d[b],i[b++]=o&this.DM,o>>=this.DB;if(d.t<this.t){for(o-=d.s;b<this.t;)o+=this[b],i[b++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;b<d.t;)o-=d[b],i[b++]=o&this.DM,o>>=this.DB;o-=d.s}i.s=0>o?-1:0;-1>o?i[b++]=this.DV+o:0<o&&(i[b++]=o);i.t=b;i.clamp()};e.prototype.multiplyTo=function(d,i){var b=
this.abs(),o=d.abs(),c=b.t;for(i.t=c+o.t;0<=--c;)i[c]=0;for(c=0;c<o.t;++c)i[c+b.t]=b.am(0,o[c],i,c,0,b.t);i.s=0;i.clamp();this.s!=d.s&&e.ZERO.subTo(i,i)};e.prototype.squareTo=function(d){for(var i=this.abs(),b=d.t=2*i.t;0<=--b;)d[b]=0;for(b=0;b<i.t-1;++b){var o=i.am(b,i[b],d,2*b,0,1);if((d[b+i.t]+=i.am(b+1,2*i[b],d,2*b+1,o,i.t-b-1))>=i.DV)d[b+i.t]-=i.DV,d[b+i.t+1]=1}0<d.t&&(d[d.t-1]+=i.am(b,i[b],d,2*b,0,1));d.s=0;d.clamp()};e.prototype.divRemTo=function(d,i,b){var o=d.abs();if(!(0>=o.t)){var c=this.abs();
if(c.t<o.t)null!=i&&i.fromInt(0),null!=b&&this.copyTo(b);else{null==b&&(b=u());var h=u(),g=this.s,d=d.s,v=this.DB-S(o[o.t-1]);0<v?(o.lShiftTo(v,h),c.lShiftTo(v,b)):(o.copyTo(h),c.copyTo(b));o=h.t;c=h[o-1];if(0!=c){var ja=c*(1<<this.F1)+(1<o?h[o-2]>>this.F2:0),l=this.FV/ja,ja=(1<<this.F1)/ja,k=1<<this.F2,Ga=b.t,E=Ga-o,w=null==i?u():i;h.dlShiftTo(E,w);0<=b.compareTo(w)&&(b[b.t++]=1,b.subTo(w,b));e.ONE.dlShiftTo(o,w);for(w.subTo(h,h);h.t<o;)h[h.t++]=0;for(;0<=--E;){var T=b[--Ga]==c?this.DM:Math.floor(b[Ga]*
l+(b[Ga-1]+k)*ja);if((b[Ga]+=h.am(0,T,b,E,0,o))<T){h.dlShiftTo(E,w);for(b.subTo(w,b);b[Ga]<--T;)b.subTo(w,b)}}null!=i&&(b.drShiftTo(o,i),g!=d&&e.ZERO.subTo(i,i));b.t=o;b.clamp();0<v&&b.rShiftTo(v,b);0>g&&e.ZERO.subTo(b,b)}}}};e.prototype.invDigit=function(){if(1>this.t)return 0;var d=this[0];if(0==(d&1))return 0;var i=d&3,i=i*(2-(d&15)*i)&15,i=i*(2-(d&255)*i)&255,i=i*(2-((d&65535)*i&65535))&65535,i=i*(2-d*i%this.DV)%this.DV;return 0<i?this.DV-i:-i};e.prototype.isEven=function(){return 0==(0<this.t?
this[0]&1:this.s)};e.prototype.bnpExp=function(d,i){if(4294967295<d||1>d)return e.ONE;var b=u(),o=u(),c=i.convert(this),h=S(d)-1;for(c.copyTo(b);0<=--h;)if(i.sqrTo(b,o),0<(d&1<<h))i.mulTo(o,c,b);else var g=b,b=o,o=g;return i.revert(b)};e.prototype.toString=function(d){if(0>this.s)return"-"+this.negate().toString(d);if(16==d)d=4;else if(8==d)d=3;else if(2==d)d=1;else if(32==d)d=5;else if(4==d)d=2;else return this.toRadix(d);var i=(1<<d)-1,b,o=!1,c=[],h=this.t,g=this.DB-h*this.DB%d;if(0<h--){if(g<this.DB&&
0<(b=this[h]>>g))o=!0,c.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));for(;0<=h;)g<d?(b=(this[h]&(1<<g)-1)<<d-g,b|=this[--h]>>(g+=this.DB-d)):(b=this[h]>>(g-=d)&i,0>=g&&(g+=this.DB,--h)),0<b&&(o=!0),o&&c.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(b))}return o?c.join(""):"0"};e.prototype.negate=function(){var d=u();e.ZERO.subTo(this,d);return d};e.prototype.abs=function(){return 0>this.s?this.negate():this};e.prototype.compareTo=$;e.prototype.bitLength=function(){return 0>=this.t?
0:this.DB*(this.t-1)+S(this[this.t-1]^this.s&this.DM)};e.prototype.mod=ya;e.prototype.modPowInt=function(d,i){var b;b=256>d||i.isEven()?new aa(i):new Y(i);return this.exp(d,b)};e.ZERO=V(0);e.ONE=V(1);K.prototype.convert=N;K.prototype.revert=N;K.prototype.mulTo=function(d,i,b){d.multiplyTo(i,b)};K.prototype.sqrTo=function(d,i){d.squareTo(i)};p.prototype.convert=function(d){if(0>d.s||d.t>2*this.m.t)return d.mod(this.m);if(0>d.compareTo(this.m))return d;var i=u();d.copyTo(i);this.reduce(i);return i};
p.prototype.revert=function(d){return d};p.prototype.reduce=function(d){d.drShiftTo(this.m.t-1,this.r2);d.t>this.m.t+1&&(d.t=this.m.t+1,d.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>d.compareTo(this.r2);)d.dAddOffset(1,this.m.t+1);for(d.subTo(this.r2,d);0<=d.compareTo(this.m);)d.subTo(this.m,d)};p.prototype.mulTo=function(d,i,b){d.multiplyTo(i,b);this.reduce(b)};p.prototype.sqrTo=function(d,i){d.squareTo(i);this.reduce(i)};
var Na=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Fb=67108864/Na[Na.length-1];e.prototype.chunkSize=function(d){return Math.floor(Math.LN2*this.DB/Math.log(d))};e.prototype.toRadix=function(d){null==
d&&(d=10);if(0==this.signum()||2>d||36<d)return"0";var i=this.chunkSize(d),i=Math.pow(d,i),b=V(i),o=u(),c=u(),h="";for(this.divRemTo(b,o,c);0<o.signum();)h=(i+c.intValue()).toString(d).substr(1)+h,o.divRemTo(b,o,c);return c.intValue().toString(d)+h};e.prototype.fromRadix=function(d,i){this.fromInt(0);null==i&&(i=10);for(var b=this.chunkSize(i),o=Math.pow(i,b),c=!1,h=0,g=0,v=0;v<d.length;++v){var ja=L(d,v);0>ja?"-"==d.charAt(v)&&0==this.signum()&&(c=!0):(g=i*g+ja,++h>=b&&(this.dMultiply(o),this.dAddOffset(g,
0),g=h=0))}0<h&&(this.dMultiply(Math.pow(i,h)),this.dAddOffset(g,0));c&&e.ZERO.subTo(this,this)};e.prototype.fromNumber=function(d,i,b){if("number"==typeof i)if(2>d)this.fromInt(1);else{this.fromNumber(d,b);this.testBit(d-1)||this.bitwiseTo(e.ONE.shiftLeft(d-1),C,this);for(this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>d&&this.subTo(e.ONE.shiftLeft(d-1),this)}else{var b=[],o=d&7;b.length=(d>>3)+1;i.nextBytes(b);b[0]=0<o?b[0]&(1<<o)-1:0;this.fromString(b,
256)}};e.prototype.bitwiseTo=function(d,i,b){var o,c,h=Math.min(d.t,this.t);for(o=0;o<h;++o)b[o]=i(this[o],d[o]);if(d.t<this.t){c=d.s&this.DM;for(o=h;o<this.t;++o)b[o]=i(this[o],c);b.t=this.t}else{c=this.s&this.DM;for(o=h;o<d.t;++o)b[o]=i(c,d[o]);b.t=d.t}b.s=i(this.s,d.s);b.clamp()};e.prototype.changeBit=function(d,i){var b=e.ONE.shiftLeft(d);this.bitwiseTo(b,i,b);return b};e.prototype.addTo=function(d,i){for(var b=0,o=0,c=Math.min(d.t,this.t);b<c;)o+=this[b]+d[b],i[b++]=o&this.DM,o>>=this.DB;if(d.t<
this.t){for(o+=d.s;b<this.t;)o+=this[b],i[b++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;b<d.t;)o+=d[b],i[b++]=o&this.DM,o>>=this.DB;o+=d.s}i.s=0>o?-1:0;0<o?i[b++]=o:-1>o&&(i[b++]=this.DV+o);i.t=b;i.clamp()};e.prototype.dMultiply=function(d){this[this.t]=this.am(0,d-1,this,0,0,this.t);++this.t;this.clamp()};e.prototype.dAddOffset=function(d,i){if(0!=d){for(;this.t<=i;)this[this.t++]=0;for(this[i]+=d;this[i]>=this.DV;)this[i]-=this.DV,++i>=this.t&&(this[this.t++]=0),++this[i]}};e.prototype.multiplyLowerTo=
function(d,i,b){var o=Math.min(this.t+d.t,i);b.s=0;for(b.t=o;0<o;)b[--o]=0;var c;for(c=b.t-this.t;o<c;++o)b[o+this.t]=this.am(0,d[o],b,o,0,this.t);for(c=Math.min(d.t,i);o<c;++o)this.am(0,d[o],b,o,0,i-o);b.clamp()};e.prototype.multiplyUpperTo=function(d,i,b){--i;var o=b.t=this.t+d.t-i;for(b.s=0;0<=--o;)b[o]=0;for(o=Math.max(i-this.t,0);o<d.t;++o)b[this.t+o-i]=this.am(i-o,d[o],b,0,0,this.t+o-i);b.clamp();b.drShiftTo(1,b)};e.prototype.modInt=function(d){if(0>=d)return 0;var i=this.DV%d,b=0>this.s?d-
1:0;if(0<this.t)if(0==i)b=this[0]%d;else for(var o=this.t-1;0<=o;--o)b=(i*b+this[o])%d;return b};e.prototype.millerRabin=function(d){var i=this.subtract(e.ONE),b=i.getLowestSetBit();if(0>=b)return!1;var o=i.shiftRight(b),d=d+1>>1;d>Na.length&&(d=Na.length);for(var c=u(),h=0;h<d;++h){c.fromInt(Na[h]);var g=c.modPow(o,this);if(0!=g.compareTo(e.ONE)&&0!=g.compareTo(i)){for(var v=1;v++<b&&0!=g.compareTo(i);)if(g=g.modPowInt(2,this),0==g.compareTo(e.ONE))return!1;if(0!=g.compareTo(i))return!1}}return!0};
e.prototype.clone=function(){var d=u();this.copyTo(d);return d};e.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};e.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};e.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};e.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?
0:1};e.prototype.toByteArray=function(){var d=this.t,i=[];i[0]=this.s;var b=this.DB-d*this.DB%8,o,c=0;if(0<d--){if(b<this.DB&&(o=this[d]>>b)!=(this.s&this.DM)>>b)i[c++]=o|this.s<<this.DB-b;for(;0<=d;)if(8>b?(o=(this[d]&(1<<b)-1)<<8-b,o|=this[--d]>>(b+=this.DB-8)):(o=this[d]>>(b-=8)&255,0>=b&&(b+=this.DB,--d)),0!=(o&128)&&(o|=-256),0==c&&(this.s&128)!=(o&128)&&++c,0<c||o!=this.s)i[c++]=o}return i};e.prototype.equals=na;e.prototype.min=function(d){return 0>this.compareTo(d)?this:d};e.prototype.max=
function(d){return 0<this.compareTo(d)?this:d};e.prototype.and=function(d){var i=u();this.bitwiseTo(d,da,i);return i};e.prototype.or=function(d){var i=u();this.bitwiseTo(d,C,i);return i};e.prototype.xor=function(d){var i=u();this.bitwiseTo(d,X,i);return i};e.prototype.andNot=function(d){var i=u();this.bitwiseTo(d,ga,i);return i};e.prototype.not=function(){for(var d=u(),i=0;i<this.t;++i)d[i]=this.DM&~this[i];d.t=this.t;d.s=~this.s;return d};e.prototype.shiftLeft=function(d){var i=u();0>d?this.rShiftTo(-d,
i):this.lShiftTo(d,i);return i};e.prototype.shiftRight=function(d){var i=u();0>d?this.lShiftTo(-d,i):this.rShiftTo(d,i);return i};e.prototype.getLowestSetBit=function(){for(var d=0;d<this.t;++d)if(0!=this[d]){var i=d*this.DB;d=this[d];if(0==d)d=-1;else{var b=0;0==(d&65535)&&(d>>=16,b+=16);0==(d&255)&&(d>>=8,b+=8);0==(d&15)&&(d>>=4,b+=4);0==(d&3)&&(d>>=2,b+=2);0==(d&1)&&++b;d=b}return i+d}return 0>this.s?this.t*this.DB:-1};e.prototype.bitCount=function(){for(var d=0,i=this.s&this.DM,b=0;b<this.t;++b){for(var o=
this[b]^i,c=0;0!=o;)o&=o-1,++c;d+=c}return d};e.prototype.testBit=function(d){var i=Math.floor(d/this.DB);return i>=this.t?0!=this.s:0!=(this[i]&1<<d%this.DB)};e.prototype.setBit=function(d){return this.changeBit(d,C)};e.prototype.clearBit=function(d){return this.changeBit(d,ga)};e.prototype.flipBit=function(d){return this.changeBit(d,X)};e.prototype.add=ka;e.prototype.subtract=ta;e.prototype.multiply=Z;e.prototype.divide=ca;e.prototype.remainder=ha;e.prototype.divideAndRemainder=W;e.prototype.modPow=
function(d,i){var b=d.bitLength(),o,c=V(1),h;if(0>=b)return c;o=18>b?1:48>b?3:144>b?4:768>b?5:6;h=8>b?new aa(i):i.isEven()?new p(i):new Y(i);var g=[],v=3,ja=o-1,l=(1<<o)-1;g[1]=h.convert(this);if(1<o){b=u();for(h.sqrTo(g[1],b);v<=l;)g[v]=u(),h.mulTo(b,g[v-2],g[v]),v+=2}for(var k=d.t-1,Ga,e=!0,E=u(),b=S(d[k])-1;0<=k;){b>=ja?Ga=d[k]>>b-ja&l:(Ga=(d[k]&(1<<b+1)-1)<<ja-b,0<k&&(Ga|=d[k-1]>>this.DB+b-ja));for(v=o;0==(Ga&1);)Ga>>=1,--v;if(0>(b-=v))b+=this.DB,--k;if(e)g[Ga].copyTo(c),e=!1;else{for(;1<v;)h.sqrTo(c,
E),h.sqrTo(E,c),v-=2;0<v?h.sqrTo(c,E):(v=c,c=E,E=v);h.mulTo(E,g[Ga],c)}for(;0<=k&&0==(d[k]&1<<b);)h.sqrTo(c,E),v=c,c=E,E=v,0>--b&&(b=this.DB-1,--k)}return h.revert(c)};e.prototype.modInverse=function(d){var i=d.isEven();if(this.isEven()&&i||0==d.signum())return e.ZERO;for(var b=d.clone(),o=this.clone(),c=V(1),h=V(0),g=V(0),v=V(1);0!=b.signum();){for(;b.isEven();){b.rShiftTo(1,b);if(i){if(!c.isEven()||!h.isEven())c.addTo(this,c),h.subTo(d,h);c.rShiftTo(1,c)}else h.isEven()||h.subTo(d,h);h.rShiftTo(1,
h)}for(;o.isEven();){o.rShiftTo(1,o);if(i){if(!g.isEven()||!v.isEven())g.addTo(this,g),v.subTo(d,v);g.rShiftTo(1,g)}else v.isEven()||v.subTo(d,v);v.rShiftTo(1,v)}0<=b.compareTo(o)?(b.subTo(o,b),i&&c.subTo(g,c),h.subTo(v,h)):(o.subTo(b,o),i&&g.subTo(c,g),v.subTo(h,v))}if(0!=o.compareTo(e.ONE))return e.ZERO;if(0<=v.compareTo(d))return v.subtract(d);if(0>v.signum())v.addTo(d,v);else return v;return 0>v.signum()?v.add(d):v};e.prototype.pow=Ba;e.prototype.expt=Ba;e.prototype.gcd=H;e.prototype.isProbablePrime=
function(d){var i,b=this.abs();if(1==b.t&&b[0]<=Na[Na.length-1]){for(i=0;i<Na.length;++i)if(b[0]==Na[i])return!0;return!1}if(b.isEven())return!1;for(i=1;i<Na.length;){for(var o=Na[i],c=i+1;c<Na.length&&o<Fb;)o*=Na[c++];for(o=b.modInt(o);i<c;)if(0==o%Na[i++])return!1}return b.millerRabin(d)};e.NEGATIVE_ONE=e.ONE.negate();var Ca=function(d){"number"===typeof d&&(d+="");d=T(d);return new e(d,10)};e.prototype.level=0;e.prototype.liftTo=function(d){if(1===d.level)return new Q(this,1);return 2===d.level?
(d=this.toFixnum(),d===Number.POSITIVE_INFINITY?xb:d===Number.NEGATIVE_INFINITY?yb:new A(d)):3===d.level?new J(this,0):D("invalid level for BigInteger lift",this,d)};e.prototype.isFinite=function(){return!0};e.prototype.isInteger=function(){return!0};e.prototype.isRational=function(){return!0};e.prototype.isReal=function(){return!0};e.prototype.isExact=function(){return!0};e.prototype.isInexact=function(){return!1};e.prototype.toExact=function(){return this};e.prototype.toInexact=function(){return A.makeInstance(this.toFixnum())};
e.prototype.toFixnum=function(){var d=0,i=this.toString(),b;if("-"===i[0]){for(b=1;b<i.length;b++)d=10*d+Number(i[b]);return-d}for(b=0;b<i.length;b++)d=10*d+Number(i[b]);return d};e.prototype.greaterThan=function(d){return 0<this.compareTo(d)};e.prototype.greaterThanOrEqual=function(d){return 0<=this.compareTo(d)};e.prototype.lessThan=function(d){return 0>this.compareTo(d)};e.prototype.lessThanOrEqual=function(d){return 0>=this.compareTo(d)};e.prototype.divide=function(d){var i=W.call(this,d);return 0===
i[1].compareTo(e.ZERO)?i[0]:w(i[0],Q.makeInstance(i[1],d))};e.prototype.numerator=function(){return this};e.prototype.denominator=function(){return 1};(function(){var d=function(d,i){for(;!E(Qa(i),d)||!Ka(d,Qa(w(i,1)));)i=l(la(w(i,l(la(d,i))),2));return i};e.prototype.integerSqrt=function(){var i;if(0<=qb(this))return d(this,this);i=this.negate();return J.makeInstance(0,d(i,i))}})();(function(){e.prototype.sqrt=function(){var d=this.integerSqrt(),i;if(sa(Qa(d),this))return d;i=pa(this);return isFinite(i)?
0<=i?A.makeInstance(Math.sqrt(i)):J.makeInstance(0,A.makeInstance(Math.sqrt(-i))):d}})();e.prototype.floor=function(){return this};e.prototype.ceiling=function(){return this};e.prototype.conjugate=M("conjugate");e.prototype.magnitude=M("magnitude");e.prototype.log=M("log");e.prototype.angle=M("angle");e.prototype.atan=M("atan");e.prototype.acos=M("acos");e.prototype.asin=M("asin");e.prototype.tan=M("tan");e.prototype.cos=M("cos");e.prototype.sin=M("sin");e.prototype.exp=M("exp");e.prototype.imaginaryPart=
function(){return 0};e.prototype.realPart=function(){return this};e.prototype.round=function(){return this};var Gb=function(){return function(d,i,b){var o=512;b&&"undefined"!==typeof b.limit&&(o=b.limit);ia(d)||D("toRepeatingDecimal: n "+d.toString()+" is not an integer.");ia(i)||D("toRepeatingDecimal: d "+i.toString()+" is not an integer.");wa(i,0)&&D("toRepeatingDecimal: d equals 0");Ka(i,0)&&D("toRepeatingDecimal: d < 0");b=Ka(d,0)?"-":"";d=R(d);b+=eb(d,i);a:{var d=ab(d,i),c=o,o=[],h={};for(h[d]=
!0;;){if(0>=c--){i=[o.join(""),"..."];break a}var g=eb(U(d,10),i),d=ab(U(d,10),i);o.push(g.toString());if(h[d])break;else h[d]=!0}h=d;for(c=[];!(g=eb(U(d,10),i),d=ab(U(d,10),i),c.push(g.toString()),wa(d,h)););i=o.join("");for(d=c.join("");i.length>=d.length&&i.substring(i.length-d.length)===d;)i=i.substring(0,i.length-d.length);i=[i,d]}return[b].concat(i)}}();G.fromFixnum=function(d){if(isNaN(d)||!isFinite(d))return A.makeInstance(d);var i=Math.floor(d);return i===d?Ma(i)?Ca(T(d+"")):i:A.makeInstance(d)};
G.fromString=function(d,i){var o=10,i="undefined"===typeof i?I.def:!0===i?I.on:!1===i?I.off:D("exactness must be true or false",this,r),c=d.toLowerCase().match(Eb);if(c){var h=c[1].toLowerCase(),g=h.match(/(#[ei])/),h=h.match(/(#[bodx])/);g&&(g=g[1].charAt(1),i="e"===g?I.on:"i"===g?I.off:D("invalid exactness flag",this,r));h&&(g=h[1].charAt(1),o="b"===g?2:"o"===g?8:"d"===g?10:"x"===g?16:D("invalid radix flag",this,r))}var g=c?c[2]:d,h=i,c=c?!0:!1,v,ja=b(o),l="["+z(o)+"]",k="["+ja+"]+";v=k+"/"+k;ja=
"(?:"+("(?:"+k+"|"+("["+ja+"]*\\.["+ja+"]+")+"|"+("["+ja+"]+\\.["+ja+"]*")+")")+"|"+v+")(?:"+l+"[+-]?"+k+")?";l="(?:[+-]?"+ja+"|[+-](?:inf.0|nan.0|inf.f|nan.f))";ja=RegExp("^("+l+")?([+-]"+("(?:"+ja+"|(?:inf.0|nan.0|inf.f|nan.f))")+"?)i$");l=RegExp("^("+l+")@("+l+")$");v=g.match(RegExp("^([+-]?"+v+")([+-]"+v+"?)i$"));ja=g.match(ja);l=g.match(l);return(v=v?v:ja?ja:l?l:!1)?J.makeInstance(B(v[1]||"0",o,h),B("+"===v[2]?"1":"-"===v[2]?"-1":v[2],o,h)):B(g,o,h,c)};G.makeBignum=Ca;G.makeRational=Q.makeInstance;
G.makeFloat=A.makeInstance;G.makeComplex=J.makeInstance;G.makeComplexPolar=function(d,i){return sa(i,0)?d:J.makeInstance(U(d,gb(i)),U(d,Wa(i)))};G.pi=A.pi;G.e=A.e;G.nan=A.nan;G.negative_inf=A.neginf;G.inf=A.inf;G.negative_one=-1;G.zero=0;G.one=1;G.i=Va;G.negative_i=Ab;G.negative_zero=Ya;G.onThrowRuntimeError=function(d){throw Error(d);};G.isSchemeNumber=P;G.isRational=ra;G.isReal=ua;G.isExact=oa;G.isInexact=Fa;G.isInteger=ia;G.toFixnum=pa;G.toExact=qa;G.toInexact=k;G.add=w;G.subtract=O;G.multiply=
U;G.divide=la;G.equals=wa;G.eqv=sa;G.approxEquals=function(d,i,b){return Ka(R(O(d,i)),b)};G.greaterThanOrEqual=v;G.lessThanOrEqual=E;G.greaterThan=ma;G.lessThan=Ka;G.expt=Xa;G.exp=Ea;G.modulo=fb;G.numerator=$a;G.denominator=Ia;G.integerSqrt=mb;G.sqrt=Ja;G.abs=R;G.quotient=eb;G.remainder=ab;G.floor=l;G.ceiling=xa;G.conjugate=va;G.magnitude=function(d){return"number"===typeof d?Math.abs(d):d.magnitude()};G.log=Aa;G.angle=Ua;G.tan=Za;G.atan=cb;G.cos=gb;G.sin=Wa;G.tan=Za;G.acos=hb;G.asin=lb;G.cosh=function(d){return sa(d,
0)?A.makeInstance(1):la(w(Ea(d),Ea(Da(d))),2)};G.sinh=function(d){return la(O(Ea(d),Ea(Da(d))),2)};G.imaginaryPart=Ta;G.realPart=Oa;G.round=db;G.sqr=Qa;G.gcd=function(d,b){ia(d)||D("gcd: the argument "+d.toString()+" is not an integer.",d);for(var c=R(d),h,g,v=0;v<b.length;v++){g=R(b[v]);for(ia(g)||D("gcd: the argument "+g.toString()+" is not an integer.",g);!o(g);)h=c,c=g,g=i(h,g)}return c};G.lcm=function(i,b){ia(i)||D("lcm: the argument "+i.toString()+" is not an integer.",i);var c=R(i);if(o(c))return 0;
for(var h=0;h<b.length;h++){ia(b[h])||D("lcm: the argument "+b[h].toString()+" is not an integer.",b[h]);var g=d(c,b[h]);if(o(g))return 0;c=la(U(c,b[h]),g)}return c};G.toRepeatingDecimal=Gb;G.BigInteger=e;G.Rational=Q;G.FloatPoint=A;G.Complex=J;G.MIN_FIXNUM=-9E15;G.MAX_FIXNUM=9E15})();
var _Hashtable=function(){function j(b){return"function"===typeof b}function F(b){if("string"===typeof b)return b;return j(b.hashCode)?(b=b.hashCode(),"string"!==typeof b?F(b):b):j(b.toString)?b.toString():""+b}function y(b,c){return b.equals(c)}function c(b,c){return j(c.equals)?c.equals(b):b===c}function b(b,c){return b===c}function z(b,c,e,m,t){for(var u,q=0,j=b.length;q<j;q++)if(u=b[q],t(c,e(u)))return m?[q,u]:!0;return!1}function I(b,c){if(j(b.splice))b.splice(c,1);else if(c===b.length-1)b.length=
c;else{var e=b.slice(c+1);b.length=c;for(var m=0,t=e.length;m<t;m++)b[c+m]=e[m]}}function B(b,c){if(null===b)throw Error("null is not a valid "+c);if("undefined"===typeof b)throw Error(c+" must not be undefined");}function e(b,c,e){this.entries=[];this.addEntry(b,c);null!==e&&(this.getEqualityFunction=function(){return e})}function u(b){return b[0]}function m(b){return b[1]}function t(){}function q(b){return b[0]}function L(b,c){var e=b[c];return e&&e instanceof t?e[1]:null}e.prototype={getEqualityFunction:function(b){return j(b.equals)?
y:c},searchForEntry:function(b){return z(this.entries,b,u,!0,this.getEqualityFunction(b))},getEntryForKey:function(b){return this.searchForEntry(b)[1]},getEntryIndexForKey:function(b){return this.searchForEntry(b)[0]},removeEntryForKey:function(b){return(b=this.searchForEntry(b))?(I(this.entries,b[0]),!0):!1},addEntry:function(b,c){this.entries[this.entries.length]=[b,c]},size:function(){return this.entries.length},keys:function(b){for(var c=b.length,e=0,m=this.entries.length;e<m;e++)b[c+e]=this.entries[e][0]},
values:function(b){for(var c=b.length,e=0,m=this.entries.length;e<m;e++)b[c+e]=this.entries[e][1]},containsKey:function(b){return z(this.entries,b,u,!1,this.getEqualityFunction(b))},containsValue:function(c){return z(this.entries,c,m,!1,b)}};t.prototype=[];return function(b,c){var m=[],u={},b=j(b)?b:F,c=j(c)?c:null;this.put=function(q,j){B(q,"key");B(j,"value");var z=b(q),I=L(u,z);I?(z=I.getEntryForKey(q))?z[1]=j:I.addEntry(q,j):(I=new t,I[0]=z,I[1]=new e(q,j,c),m[m.length]=I,u[z]=I)};this.get=function(c){B(c,
"key");var e=b(c);if(e=L(u,e))if(c=e.getEntryForKey(c))return c[1];return null};this.containsKey=function(c){B(c,"key");var e=b(c);return(e=L(u,e))?e.containsKey(c):!1};this.containsValue=function(b){B(b,"value");for(var c=0,e=m.length;c<e;c++)if(m[c][1].containsValue(b))return!0;return!1};this.clear=function(){m.length=0;u={}};this.isEmpty=function(){return 0===m.length};this.keys=function(){for(var b=[],c=0,e=m.length;c<e;c++)m[c][1].keys(b);return b};this.values=function(){for(var b=[],c=0,e=m.length;c<
e;c++)m[c][1].values(b);return b};this.remove=function(c){B(c,"key");var e=b(c),t=L(u,e);t&&t.removeEntryForKey(c)&&0===t.size()&&(c=t.getEqualityFunction(c),c=z(m,e,q,!0,c),I(m,c[0]),delete u[e])};this.size=function(){for(var b=0,c=0,e=m.length;c<e;c++)b+=m[c][1].size();return b}}}(),types={};
(function(){function j(b,c,g){var k=document.createElement("span");k.className=c;k.ariaText=g;k.setAttribute("aria-label",g);k.appendChild(document.createTextNode(b));return k}function F(){var b=document.createElement("span");b.appendChild(document.createTextNode("("));b.className="lParen";return b}function y(){var b=document.createElement("span");b.appendChild(document.createTextNode(")"));b.className="rParen";return b}function c(b){return b.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,
function(b){return String.fromCharCode(parseInt(b.replace(/\\u/g,""),16))})}var b={}.hasOwnProperty,z=0;makeEqHashCode=function(){z++;return z};getEqHashCode=function(b){b&&!b._eqHashCode&&(b._eqHashCode=makeEqHashCode());return b&&b._eqHashCode?b._eqHashCode:"string"==typeof b?b:0};var I=function(){this.parentMap=m()};I.prototype.find=function(b){var c=this.parentMap.containsKey(b)?this.parentMap.get(b):b;if(c===b)return c;c=this.find(c);this.parentMap.put(b,c);return c};I.prototype.merge=function(b,
c){this.parentMap.put(this.find(b),this.find(c))};var B=function(){var b=!1,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,g=function(){};g.extend=function(g){var k=this.prototype;b=!0;var e=new this;b=!1;for(var w in g)e[w]="function"==typeof g[w]&&"function"==typeof k[w]&&c.test(g[w])?function(b,c){return function(){var g=this._super;this._super=k[b];var v=c.apply(this,arguments);this._super=g;return v}}(w,g[w]):g[w];w=function(){!b&&this.init&&this.init.apply(this,arguments)};w.prototype=e;w.constructor=
w;w.extend=arguments.callee;return w};return g}();StructType=function(b,c,g,k,e,w,m,T,p){this.name=b;this.type=c;this.numberOfArgs=g;this.numberOfFields=k;this.firstField=e;this.constructor=w;this.predicate=m;this.accessor=T;this.mutator=p};StructType.prototype.toString=function(){return"#<struct-type:"+this.name+">"};StructType.prototype.isEqual=function(b){return this===b};var e=function(b,c,g,k,e,w){c||(c={type:u,numberOfArgs:0,numberOfFields:0,firstField:0});var m=c.numberOfArgs,T=c.type.extend({init:function(b,
c){w||(w=function(b){if(3==arguments.length)b(arguments[1]);else{var c=[],g;for(g=1;g<arguments.length-1;g++)c.push(arguments[g]);b(new ha(c))}});var v=this;c.unshift(function(c){var c=c instanceof ha?c.elts:[c],E=c.slice(0,m);v._super(b,E);for(E=0;E<g;E++)v._fields.push(c[E+m]);for(E=0;E<k;E++)v._fields.push(e)});c.push(V.makeInstance(b));w.apply(null,c)}});T.prototype.type=T;return new StructType(b,T,g+m,g+k,c.firstField+c.numberOfFields,function(){for(var c=[],g=0;g<arguments.length;g++)c.push(arguments[g]);
return new T(b,c)},function(b){return b instanceof T},function(b,c){return b._fields[c+this.firstField]},function(b,c,g){b._fields[c+this.firstField]=g})},u=B.extend({init:function(b){this._constructorName=b;this._fields=[]},toWrittenString:function(b){var c=[],g;c.push("(");c.push(this._constructorName);for(g=0;g<this._fields.length;g++)c.push(" "),c.push(C(this._fields[g],b));c.push(")");return c.join("")},toDisplayedString:this.toWrittenString,toDomNode:function(b){var c=document.createElement("span"),
g=document.createElement("span");g.appendChild(document.createTextNode(this._constructorName));ariaText=this._constructorName+":";c.appendChild(F());c.appendChild(g);for(g=0;g<this._fields.length;g++){var k=X(this._fields[g],b);ariaText+=" "+k.ariaText;c.appendChild(k)}c.appendChild(y());c.ariaText=ariaText;c.setAttribute("aria-label",ariaText);return c},isEqual:function(b,c){if(void 0==b.type||this.type!==b.type||!(b instanceof this.type))return!1;for(var g=0;g<this._fields.length;g++)if(!ca(this._fields[g],
b._fields[g],c))return!1;return!0}});u.prototype.type=u;var m=function(){return new _Hashtable(function(b){return getEqHashCode(b)},function(b,c){return b===c})},t=function(){this.hash=m();this.mutable=!0};t.prototype.toWrittenString=function(b){for(var c=this.hash.keys(),g=[],k=0;k<c.length;k++){var e=types.toWrittenString(c[k],b),w=types.toWrittenString(this.hash.get(c[k]),b);g.push("("+e+" . "+w+")")}return"#hasheq("+g.join(" ")+")"};t.prototype.toDisplayedString=t.prototype.toWrittenString;t.prototype.isEqual=
function(b,c){if(!(b instanceof t)||this.hash.keys().length!=b.hash.keys().length)return!1;for(var g=this.hash.keys(),k=0;k<g.length;k++)if(!b.hash.containsKey(g[k])||!ca(this.hash.get(g[k]),b.hash.get(g[k]),c))return!1;return!0};var q=function(){this.hash=new _Hashtable(function(b){return C(b)},function(b,c){return ca(b,c,new I)});this.mutable=!0};q.prototype.toWrittenString=function(b){for(var c=this.hash.keys(),g=[],k=0;k<c.length;k++){var e=types.toWrittenString(c[k],b),w=types.toWrittenString(this.hash.get(c[k]),
b);g.push("("+e+" . "+w+")")}return"#hash("+g.join(" ")+")"};q.prototype.toDisplayedString=q.prototype.toWrittenString;q.prototype.toDomNode=function(b){var c=document.createElement("span");document.createElement("span");var g=this.hash.keys(),k="hashtable with "+g.length+" item"+(1==g.length?"":"s")+": ";c.appendChild(document.createTextNode(this.toDisplayedString()));for(var e=0;e<g.length;e++)var w=X(g[e],b),T=X(this.hash.get(g[e]),b),k=k+(" "+w.ariaText+" maps to "+T.ariaText);c.ariaText=k;c.setAttribute("aria-label",
k);return c};q.prototype.isEqual=function(b,c){if(!(b instanceof q)||this.hash.keys().length!=b.hash.keys().length)return!1;for(var g=this.hash.keys(),k=0;k<g.length;k++)if(!b.hash.containsKey(g[k])||!ca(this.hash.get(g[k]),b.hash.get(g[k]),c))return!1;return!0};var L=function(b,c){this.val=b;this.mutable=c};L.prototype.unbox=function(){return this.val};L.prototype.set=function(b){this.mutable&&(this.val=b)};L.prototype.toString=function(){return"#&"+this.val.toString()};L.prototype.toWrittenString=
function(b){return"#&"+C(this.val,b)};L.prototype.toDisplayedString=this.toWrittenString;L.prototype.toDomNode=function(b){var c=document.createElement("span"),g=document.createElement("span");g.appendChild(document.createTextNode("#&"));var k="a box containing: "+X(this.val).ariaText;c.className="wescheme-box";c.ariaText=k;c.setAttribute("aria-label",k);c.appendChild(g);c.appendChild(X(this.val,b));return c};Logic={TRUE:!0,FALSE:!1};Boolean.prototype.toString=function(){return this.valueOf()?"true":
"false"};Boolean.prototype.toWrittenString=Boolean.prototype.toString;Boolean.prototype.toDisplayedString=Boolean.prototype.toString;Boolean.prototype.toDomNode=function(){return j(this.toString(),"wescheme-boolean",this.toString()+", a Boolean")};Boolean.prototype.isEqual=function(b){return this==b};Char=function(b){this.val=b};Char.makeInstance=function(b){return new Char(b)};Char.prototype.toString=function(){var b=this.val.charCodeAt(0);switch(b){case 0:b="#\\nul";break;case 8:b="#\\backspace";
break;case 9:b="#\\tab";break;case 10:b="#\\newline";break;case 11:b="#\\vtab";break;case 12:b="#\\page";break;case 13:b="#\\return";break;case 20:b="#\\space";break;case 127:b="#\\rubout";break;default:if(32<=b&&126>=b)b="#\\"+this.val;else{for(b=b.toString(16).toUpperCase();4>b.length;)b="0"+b;b="#\\u"+b}}return b};Char.prototype.toWrittenString=Char.prototype.toString;Char.prototype.toDisplayedString=function(){return this.val};Char.prototype.toDomNode=function(){return j(this.toString(),"wescheme-character",
this.toString().substring(2)+", a Character")};Char.prototype.getValue=function(){return this.val};Char.prototype.isEqual=function(b){return b instanceof Char&&this.val==b.val};var V=function(b){this.val=b},$={};V.makeInstance=function(c){b.call($,c)||($[c]=new V(c));return $[c]};V.prototype.isEqual=function(b){return b instanceof V&&this.val==b.val};V.prototype.toString=function(){return this.val};V.prototype.toWrittenString=function(){return this.val};V.prototype.toDisplayedString=this.toWrittenString;
V.prototype.toDomNode=function(){var b=j(this.toString(),"wescheme-symbol","'"+this.val+", a Symbol");b.style.fontFamily="monospace";b.style.whiteSpace="pre";return b};Empty=function(){};Empty.EMPTY=new Empty;Empty.prototype.isEqual=function(b){return b instanceof Empty};Empty.prototype.reverse=function(){return this};Empty.prototype.first=function(){throw Error("first can't be applied on empty.");};Empty.prototype.rest=function(){throw Error("rest can't be applied on empty.");};Empty.prototype.isEmpty=
function(){return!0};Empty.prototype.toWrittenString=function(){return"empty"};Empty.prototype.toDisplayedString=this.toWrittenString;Empty.prototype.toString=function(){return"()"};Empty.prototype.toDomNode=function(){document.createElement("span");var b=j("empty","wescheme-symbol","empty");b.style.fontFamily="monospace";b.style.whiteSpace="pre";return b};Empty.prototype.append=function(b){return b};Cons=function(b,c){this.f=b;this.r=c};Cons.prototype.reverse=function(){for(var b=this,c=Empty.EMPTY;!b.isEmpty();)c=
Cons.makeInstance(b.first(),c),b=b.rest();return c};Cons.makeInstance=function(b,c){return new Cons(b,c)};Cons.prototype.isEqual=function(b,c){return!(b instanceof Cons)?Logic.FALSE:ca(this.first(),b.first(),c)&&ca(this.rest(),b.rest(),c)};Cons.prototype.first=function(){return this.f};Cons.prototype.rest=function(){return this.r};Cons.prototype.isEmpty=function(){return!1};Cons.prototype.append=function(b){if(b===Empty.EMPTY)return this;for(var c=this.reverse();!c.isEmpty();)b=Cons.makeInstance(c.first(),
b),c=c.rest();return b};Cons.prototype.toWrittenString=function(b){for(var c=["list"],g=this;g instanceof Cons;)c.push(C(g.first(),b)),g=g.rest();if(g!==Empty.EMPTY){for(var c=this,g=C,k=[],e=[];c instanceof Cons;)k.push("(cons "),k.push(g(c.first(),b)),k.push(" "),e.push(")"),c=c.rest();k.push(g(c,b));b=k.join("")+e.join("")}else b="("+c.join(" ")+")";return b};Cons.prototype.toString=Cons.prototype.toWrittenString;Cons.prototype.toDisplayedString=this.toWrittenString;Cons.prototype.toDomNode=function(b){var c=
document.createElement("span"),g=document.createElement("span");c.className="wescheme-cons";g.appendChild(document.createTextNode("list"));c.appendChild(F());c.appendChild(g);for(var g=this,k=0,e="";g instanceof Cons;){var w=X(g.first(),b);c.appendChild(w);k++;e+=", "+w.ariaText||w.textContent;g=g.rest()}if(g!==Empty.EMPTY){k=this;g=c=document.createElement("span");e=document.createElement("span");e.appendChild(document.createTextNode("cons"));ariaText="";trailingRParens="";for(g.className="wescheme-cons";k instanceof
Cons;)g.appendChild(F()),g.appendChild(e.cloneNode(!0)),ariaText+=" (cons",trailingRParens+=")",w=X(k.first(),b),ariaText+=" "+w.ariaText||w.textContent,g.appendChild(w),w=document.createElement("span"),g.appendChild(w),g.appendChild(y()),g=w,k=k.rest();b=X(k,b);ariaText+=" "+(b.ariaText||b.textContent)+")"+trailingRParens;g.appendChild(b);c.ariaText=ariaText;c.setAttribute("aria-label",ariaText);return c}c.appendChild(y());b="list of "+k+" element"+(1==k?"":"s")+": "+e;c.setAttribute("aria-label",
b);c.ariaText=b;return c};Vector=function(b,c){this.elts=Array(b);if(c)for(var g=0;g<b;g++)this.elts[g]=c[g];else for(g=0;g<b;g++)this.elts[g]=void 0;this.mutable=!0};Vector.makeInstance=function(b,c){return new Vector(b,c)};Vector.prototype.length=function(){return this.elts.length};Vector.prototype.ref=function(b){return this.elts[b]};Vector.prototype.set=function(b,c){this.elts[b]=c};Vector.prototype.isEqual=function(b,c){if(null!=b&&void 0!=b&&b instanceof Vector){if(b.length()!=this.length())return!1;
for(var g=0;g<this.length();g++)if(!ca(this.elts[g],b.elts[g],c))return!1;return!0}return!1};Vector.prototype.toList=function(){for(var b=Empty.EMPTY,c=this.length()-1;0<=c;c--)b=Cons.makeInstance(this.elts[c],b);return b};Vector.prototype.toWrittenString=function(b){for(var c=[],g=0;g<this.length();g++)c.push(C(this.ref(g),b));return"#("+c.join(" ")+")"};Vector.prototype.toDisplayedString=this.toWrittenString;Vector.prototype.toDomNode=function(b){var c=document.createElement("span"),g=document.createElement("span"),
k=document.createElement("span");g.appendChild(document.createTextNode("#("));g.className="lParen";k.appendChild(document.createTextNode(")"));k.className="rParen";c.className="wescheme-vector";c.appendChild(g);for(var g="a vector of size "+this.length()+": ",e=0;e<this.length();e++){var w=X(this.ref(e),b),g=g+(" "+w.ariaText);c.appendChild(w)}c.appendChild(k);c.setAttribute("aria-label",g);c.ariaText=g;return c};var S=function(b){this.chars=b;this.length=b.length;this.mutable=!0};S.makeInstance=
function(b){return new S(b)};S.fromString=function(b){return S.makeInstance(b.split(""))};S.prototype.toString=function(){return this.chars.join("")};S.prototype.toWrittenString=function(){return'"'+ya(this.toString())+'"'};S.prototype.toDisplayedString=S.prototype.toString;S.prototype.copy=function(){return S.makeInstance(this.chars.slice(0))};S.prototype.substring=function(b,c){if(null==c||void 0==c)c=this.length;return S.makeInstance(this.chars.slice(b,c))};S.prototype.charAt=function(b){return this.chars[b]};
S.prototype.charCodeAt=function(b){return this.chars[b].charCodeAt(0)};S.prototype.replace=function(b,c){return S.fromString(this.toString().replace(b,c))};S.prototype.isEqual=function(b){return!(b instanceof S||"string"==typeof b)?!1:this.toString()===b.toString()};S.prototype.set=function(b,c){this.chars[b]=c};S.prototype.toUpperCase=function(){return S.fromString(this.chars.join("").toUpperCase())};S.prototype.toLowerCase=function(){return S.fromString(this.chars.join("").toLowerCase())};S.prototype.match=
function(b){return this.toString().match(b)};var ya=function(b){for(var c=[],g=0;g<b.length;g++){var k=b.charCodeAt(g);switch(k){case 7:c.push("\\a");break;case 8:c.push("\\b");break;case 9:c.push("\\t");break;case 10:c.push("\\n");break;case 11:c.push("\\v");break;case 12:c.push("\\f");break;case 13:c.push("\\r");break;case 34:c.push('\\"');break;case 92:c.push("\\\\");break;default:if(32<=k&&126>=k)c.push(b.charAt(g));else{for(k=k.toString(16).toUpperCase();4>k.length;)k="0"+k;c.push("\\u"+k)}}}return c.join("")},
aa=function(b,c){this.name=b;this.obj=c};aa.prototype.toString=function(){return"#<js-object:"+typeof this.obj+":"+this.name+">"};aa.prototype.isEqual=function(b){return this.obj===b.obj};var Y=function(b,c,g){this.startup=b;this.shutdown=c;this.startupArgs=g;this.shutdownArg=void 0};Y.prototype.toString=function(){return"#<world-config>"};Y.prototype.isEqual=function(b,c){if(!ca(this.startup,b.startup,c)||!ca(this.shutdown,b.shutdown,c)||this.startupArgs.length!=b.startupArgs.length||!ca(this.shutdownArg,
b.shutdownArg,c))return!1;for(var g=0;g<args.length;g++)if(!ca(this.startupArgs[g],b.startupArgs[g],c))return!1;return!0};var na=e("effect",!1,0,0,!1,!1);na.type.prototype.invokeEffect=function(){helpers.raise(types.incompleteExn(types.exnFail,"effect type created without using make-effect-type",[]))};var da=e("render-effect",!1,0,0,!1,!1);da.type.prototype.callImplementation=function(){helpers.raise(types.incompleteExn(types.exnFail,"render effect created without using make-render-effect-type",[]))};
var C=function(b,c){c||(c=m());if("object"==typeof b){if(c.containsKey(b))return"...";c.put(b,!0)}if(void 0==b||null==b)return"#<undefined>";if("string"==typeof b)return'"'+ya(b.toString())+'"';if("object"!=typeof b&&"function"!=typeof b)return b.toString();var g;g="undefined"!==typeof b.toWrittenString?b.toWrittenString(c):"undefined"!==typeof b.toDisplayedString?b.toDisplayedString(c):b.toString();c.remove(b);return g},X=function(b,c){c||(c=m());if("undefined"!==typeof b.toDomNode)return b.toDomNode(c);
if(ta(b)){var g;a:{var k=b.toString();if(jsnums.isExact(b))if(jsnums.isInteger(b))g="wescheme-number Integer",k+="";else{if(jsnums.isRational(b)){g=node=ka(b);break a}b instanceof jsnums.Complex?(g="wescheme-number Complex",k+=", Complex Number"):k+=", Number"}else b instanceof jsnums.Complex?(g=" wescheme-numberComplex",k+=", a Complex Number"):k+=", a Number";g=j(b.toString(),g,k)}return g}if("object"==typeof b){if(c.containsKey(b))return g=document.createElement("span"),g.style["font-family"]=
"monospace",g.appendChild(document.createTextNode("...")),g;c.put(b,!0)}if(void 0==b||null==b)return g=document.createElement("span"),g.style["font-family"]="monospace",g.appendChild(document.createTextNode("#<undefined>")),g;if("string"==typeof b)return ga(C(b));if("object"!=typeof b&&"function"!=typeof b)return ga(b.toString());g=b.nodeType?b:"undefined"!==typeof b.toWrittenString?ga(b.toWrittenString(c)):"undefined"!==typeof b.toDisplayedString?ga(b.toDisplayedString(c)):ga(b.toString());c.remove(b);
return g},ga=function(b){var g=b.split("\n"),k=g.map(c),e,w=document.createElement("span"),T=document.createElement("span"),m=document.createElement("span");m.style.paddingLeft=T.style.paddingLeft="0px";var p;0<g.length&&(T.appendChild(document.createTextNode(k[0])),m.appendChild(document.createTextNode(g[0])));for(e=1;e<g.length;e++)p=document.createElement("br"),p.style.clear="left",T.appendChild(p),T.appendChild(document.createTextNode(k[e])),m.appendChild(document.createTextNode(g[e]));w.className=
"wescheme-string";g=k.join(" ")+", a String";w.ariaText=g;w.setAttribute("aria-label",g);w.style.fontFamily="monospace";w.style.whiteSpace="pre-wrap";w.appendChild(m);if(b!==c(b)){w.appendChild(T);var t=!0;m.style.display="none";w.onclick=function(){t=!t;m.style.display=!t?"inline":"none";T.style.display=t?"inline":"none"};w.style.cursor="pointer"}return w},ka=function(b){var c=document.createElement("span"),g=jsnums.toRepeatingDecimal(jsnums.numerator(b),jsnums.denominator(b),{limit:25}),k=document.createElement("span");
k.appendChild(document.createTextNode(g[0]+"."+g[1]));c.appendChild(k);"..."===g[2]?k.appendChild(document.createTextNode(g[2])):"0"!==g[2]&&(k=document.createElement("span"),k.style.textDecoration="overline",k.appendChild(document.createTextNode(g[2])),c.appendChild(k));var e=document.createElement("span"),g=document.createElement("sup");g.appendChild(document.createTextNode(""+jsnums.numerator(b)));k=document.createElement("sub");k.appendChild(document.createTextNode(""+jsnums.denominator(b)));
var w=document.createElement("span");w.appendChild(document.createTextNode("/"));e.appendChild(g);e.appendChild(w);e.appendChild(k);g=document.createElement("span");g.appendChild(c);g.appendChild(e);e.style.display="none";var T=!0;g.onclick=function(){T=!T;c.style.display=T?"inline":"none";e.style.display=!T?"inline":"none"};g.style.cursor="pointer";g.className="wescheme-number Rational";g.ariaText=""+jsnums.numerator(b)+" over "+(""+jsnums.denominator(b));return g},ta=jsnums.isSchemeNumber,Z=function(b){return"string"===
typeof b||b instanceof S},ca=function(b,c,g){if(b===c)return!0;if(ta(b)&&ta(c))return jsnums.equals(b,c);if(Z(b)&&Z(c))return b.toString()===c.toString();if(void 0==b||null==b)return void 0==c||null==c;if("object"==typeof b&&"object"==typeof c&&b.isEqual&&c.isEqual){if(g.find(b)===g.find(c))return!0;g.merge(b,c);return b.isEqual(c,g)}return!1},ha=function(b){this.elts=b};ha.prototype.toDomNode=function(b){var c=document.createElement("span");c.style.whiteSpace="pre";if(0<this.elts.length){c.appendChild(X(this.elts[0],
b));for(var g=1;g<this.elts.length;g++){var k=X(this.elts[g],b);c.appendChild(document.createTextNode("\n"));c.appendChild(k)}}return c};var W=function(){};W.prototype.toString=function(){return"#<undefined>"};var W=new W,K=function(){};K.prototype.toString=function(){return"#<void>"};var N=new K,K=function(){};K.prototype.toString=function(){return"#<eof>"};var K=new K,Ba=function(b,c,g,k,e,w,T){this.name=b;this.locs=c;this.numParams=g;this.paramTypes=k;this.isRest=e;this.closureVals=w;this.body=
T};Ba.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};Ba.prototype.toDomNode=function(){return j(this.toString(),"wescheme-primproc",this.name===Empty.EMPTY?"anonymous function":this.name+", a function")};var p=function(b,c){this.name=b;this.closures=c};p.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<case-lambda-procedure:~a>",[this.name]):"#<case-lambda-procedure>"};var H=function(b,c){this.name=
!1;this.vstack=b.slice(0);this.cstack=c.slice(0)};H.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};H.prototype.toDomNode=function(){return j(this.toWrittenString(),"wescheme-primproc",this.name===Empty.EMPTY?"anonymous function":this.name+", a function")};var M=function(){this.slots=[];this.definedMask=[]};M.prototype.addSlot=function(b){void 0===b?(this.slots.push(types.UNDEFINED),this.definedMask.push(!1)):(this.slots.push(b),
b instanceof G?b.value===types.UNDEFINED?this.definedMask.push(!1):this.definedMask.push(!0):this.definedMask.push(!0))};M.prototype.ref=function(b,c){if(this.slots[b]instanceof G){if(this.definedMask[b])return this.slots[b].value;helpers.raise(types.incompleteExn(types.exnFailContractVariable,new ua([new oa(this.slots[b].name,c),": this variable is not defined"]),[this.slots[b].name]))}else{if(this.definedMask[b])return this.slots[b];helpers.raise(types.incompleteExn(types.exnFailContractVariable,
"variable has not been defined",[!1]))}};M.prototype.set=function(b,c){this.slots[b]instanceof G?this.slots[b].value=c:this.slots[b]=c;this.definedMask[b]=!0};M.prototype.length=function(){return this.slots.length};var G=function(b,c){this.name=b;this.value=c},g=function(b,c){this.prefix=b;this.pos=c};g.prototype.ref=function(){return this.prefix.ref(this.pos)};g.prototype.set=function(b){this.prefix.set(this.pos,b)};var T=function(b){this.dict=b||{}};T.prototype.invoke=function(){};T.prototype.update=
function(b,c){this.dict[b.val]=c;return this};var fa=function(b){this.dict=b};fa.prototype.toDomNode=function(){var b=document.createElement("span");b.appendChild(document.createTextNode("#<continuation-mark-set>"));return b};fa.prototype.toWrittenString=function(){return"#<continuation-mark-set>"};fa.prototype.toDisplayedString=this.toWrittenString;fa.prototype.ref=function(b){return this.dict.containsKey(b)?this.dict.get(b):[]};var ba=function(){},D=new ba,P=function(b,c,g,k,e){this.name=b;this.numParams=
c;this.isRest=g;this.assignsToValueRegister=k;this.impl=e};P.prototype.toString=function(){return"#<function:"+this.name+">"};P.prototype.toWrittenString=P.prototype.toString;P.prototype.toDisplayedString=P.prototype.toString;P.prototype.toDomNode=function(){return j(this.toString(),"wescheme-primproc",this.name+", a function")};var ra=function(b,c){this.name=b;this.cases=c};ra.prototype.toString=function(){return"#<function:"+this.name+">"};ra.prototype.toWrittenString=ra.prototype.toString;ra.prototype.toDisplayedString=
ra.prototype.toString;ra.prototype.toDomNode=function(){return j(this.toString(),"wescheme-caseprimitive",this.name+", a function")};var ua=function(b){this.args=b};ua.prototype.toString=function(){var b=[],c;for(c=0;c<this.args.length;c++)b.push(""+this.args[c]);return b.join("")};var oa=function(b,c){this.text=b;this.location=c};oa.prototype.toString=function(){return this.text+""};var Fa=function(b){this.coloredParts=b};Fa.prototype.toString=function(){var b,c=[];for(b=0;b<this.coloredParts.length;b++)c.push(this.coloredParts[b].text+
"");return c.join("")};var ia=function(b,c,g){this.text=b;this.locations=c;this.solid=g};ia.prototype.toString=function(){return this.text};var za=function(b){return Vector.makeInstance(b.length,b)},pa=za(["<no-location>",0,0,0,0]),qa=e("posn",!1,2,0,!1,!1),k=e("color",!1,4,0,!1,!1),w=e("arity-at-least",!1,1,0,!1,function(b,c,g){helpers.check(void 0,c,function(b){return jsnums.isExact(b)&&jsnums.isInteger(b)&&jsnums.greaterThanOrEqual(b,0)},g,"exact non-negative integer",1);b(c)});types.symbol=V.makeInstance;
types.rational=jsnums.makeRational;types["float"]=jsnums.makeFloat;types.complex=jsnums.makeComplex;types.bignum=jsnums.makeBignum;types.list=function(b){var c=Empty.EMPTY,g;for(g=b.length-1;0<=g;g--)c=Cons.makeInstance(b[g],c);return c};types.vector=za;types["char"]=Char.makeInstance;types.string=function(b){if(b instanceof S)return b;if(b instanceof Array)return S.makeInstance(b);if("string"===typeof b)return S.fromString(b);throw types.internalError("makeString expects and array of 1-character strings or a string; given "+
b.toString(),!1);};types.box=function(b){return new L(b,!0)};types.boxImmutable=function(b){return new L(b,!1)};types.pair=function(b,c){return Cons.makeInstance(b,c)};types.hash=function(b){for(var c=new q;!b.isEmpty();)c.hash.put(b.first().first(),b.first().rest()),b=b.rest();return c};types.hashEq=function(b){for(var c=new t;!b.isEmpty();)c.hash.put(b.first().first(),b.first().rest()),b=b.rest();return c};types.jsObject=function(b,c){return new aa(b,c)};types.toWrittenString=C;types.toDisplayedString=
function(b,c){c||(c=m());if("object"==typeof b){if(c.containsKey(b))return"...";c.put(b,!0)}if(void 0==b||null==b)return"#<undefined>";if("string"==typeof b)return b;if("object"!=typeof b&&"function"!=typeof b)return b.toString();var g;g="undefined"!==typeof b.toDisplayedString?b.toDisplayedString(c):"undefined"!==typeof b.toWrittenString?b.toWrittenString(c):b.toString();c.remove(b);return g};types.toDomNode=X;types.posn=qa.constructor;types.posnX=function(b){return qa.accessor(b,0)};types.posnY=
function(b){return qa.accessor(b,1)};types.color=function(b,c,g,e){void 0===e&&(e=255);return k.constructor(b,c,g,e)};types.colorRed=function(b){return k.accessor(b,0)};types.colorGreen=function(b){return k.accessor(b,1)};types.colorBlue=function(b){return k.accessor(b,2)};types.colorAlpha=function(b){return k.accessor(b,3)};types.arityAtLeast=w.constructor;types.arityValue=function(b){return w.accessor(b,0)};types.FALSE=Logic.FALSE;types.TRUE=Logic.TRUE;types.EMPTY=Empty.EMPTY;types.isEqual=ca;types.isNumber=
ta;types.isSymbol=function(b){return b instanceof V};types.isChar=function(b){return b instanceof Char};types.isString=Z;types.isPair=function(b){return b instanceof Cons};types.isVector=function(b){return b instanceof Vector};types.isBox=function(b){return b instanceof L};types.isHash=function(b){return b instanceof t||b instanceof q};types.isStruct=function(b){return b instanceof u};types.isPosn=qa.predicate;types.isArityAtLeast=w.predicate;types.isColor=k.predicate;types.isFunction=function(b){return b instanceof
P||b instanceof ra||b instanceof Ba||b instanceof p||b instanceof H};types.getProcedureType=function(b){return b instanceof P?"PrimProc":b instanceof ra?"CasePrimitive":b instanceof Ba?"ClosureValue":b instanceof p?"CaseLambdaValue":b instanceof H?"ContinuationClosureValue":!1};types.isJsObject=function(b){return b instanceof aa};types.UnionFind=I;types.cons=Cons.makeInstance;types.UNDEFINED=W;types.VOID=N;types.EOF=K;types.ValuesWrapper=ha;types.ClosureValue=Ba;types.ContinuationPrompt=ba;types.defaultContinuationPrompt=
D;types.ContinuationClosureValue=H;types.CaseLambdaValue=p;types.PrimProc=P;types.CasePrimitive=ra;types.contMarkRecordControl=function(b){return new T(b)};types.isContMarkRecordControl=function(b){return b instanceof T};types.continuationMarkSet=function(b){return new fa(b)};types.isContinuationMarkSet=function(b){return b instanceof fa};types.PrefixValue=M;types.GlobalBucket=G;types.ModuleVariableRecord=function(b,c){this.resolvedModuleName=b;this.variableName=c};types.VariableReference=g;types.Box=
L;types.ThreadCell=function(b,c){this.v=b;this.isPreserved=c||!1};types.Class=B;types.makeStructureType=e;types.isStructType=function(b){return b instanceof StructType};types.makeLowLevelEqHash=m;var Sa=function(b,c){this.val=b;this.contMarks=c?c:!1};types.internalError=function(b,c){return new Sa(b,c)};types.isInternalError=function(b){return b instanceof Sa};var O=function(b){this.val=b};types.schemeError=function(b){return new O(b)};types.isSchemeError=function(b){return b instanceof O};var U=
function(b,c,g){this.constructor=b;this.msg=c;this.otherArgs=g};types.incompleteExn=function(b,c,g){return new U(b,c,g)};types.isIncompleteExn=function(b){return b instanceof U};var ea=e("exn",!1,2,0,!1,function(b,c,g,k){helpers.check(void 0,g,types.isContinuationMarkSet,k,"continuation mark set",2);b(new ha([c,g]))});types.exn=ea.constructor;types.isExn=ea.predicate;types.exnMessage=function(b){return ea.accessor(b,0)};types.exnContMarks=function(b){return ea.accessor(b,1)};types.exnSetContMarks=
function(b,c){ea.mutator(b,1,c)};var la=e("exn:break",ea,1,0,!1,function(b,c,g,k){b(new ha([c,g,k]))});types.exnBreak=la.constructor;types.isExnBreak=la.predicate;types.exnBreakContinuation=function(b){return la.accessor(b,0)};B=e("exn:fail",ea,0,0,!1,!1);types.exnFail=B.constructor;types.isExnFail=B.predicate;W=e("exn:fail:contract",B,0,0,!1,!1);types.exnFailContract=W.constructor;types.isExnFailContract=W.predicate;B=e("exn:fail:contract:arity",W,0,0,!1,!1);types.exnFailContractArity=W.constructor;
types.isExnFailContractArity=W.predicate;var wa=e("exn:fail:contract:variable",W,1,0,!1,!1);types.exnFailContractVariable=W.constructor;types.isExnFailContractVariable=W.predicate;types.exnFailContractVariableId=function(b){return wa.accessor(b,0)};W=e("exn:fail:contract:division-by-zero",W,0,0,!1,!1);types.exnFailContractDivisionByZero=W.constructor;types.isExnFailContractDivisionByZero=W.predicate;var sa=e("exn:fail:contract:arity:position",B,1,0,!1,!1);types.exnFailContractArityWithPosition=sa.constructor;
types.isExnFailContractArityWithPosition=sa.predicate;types.exnFailContractArityWithPositionLocations=function(b){return sa.accessor(b,0)};types.worldConfig=function(b,c,g){return new Y(b,c,g)};types.isWorldConfig=function(b){return b instanceof Y};types.makeEffectType=function(b,c,g,k,w,T){c||(c=na);var b=e(b,c,g,0,!1,w),m=b.firstField+b.numberOfFields;b.type.prototype.invokeEffect=function(b,c){var g=new P("update-world",1,!1,!0,function(c,g){helpers.check(c,g,helpers.procArityContains(1),"update-world",
"procedure (arity 1)",1);b(function(b,k){interpret.call(c,g,[b],k,function(b){throw b;})},function(){c.v=N})}),e=this._fields.slice(0,m);e.unshift(g);T(k,e,c)};return b};types.isEffectType=function(b){return b instanceof StructType&&b.type.prototype.invokeEffect?!0:!1};types.isEffect=na.predicate;types.makeRenderEffectType=function(b,c,g,k,w){c||(c=da);var b=e(b,c,g,0,!1,w),T=b.firstField+b.numberOfFields;b.type.prototype.callImplementation=function(b,c){var g=this._fields.slice(0,T);b(k,g,c)};return b};
types.isRenderEffectType=function(b){return b instanceof StructType&&b.type.prototype.callImplementation?!0:!1};types.isRenderEffect=da.predicate;types.NoLocation=pa;types.isNoLocation=function(b){return b===pa};types.ColoredPart=oa;types.Message=ua;types.isColoredPart=function(b){return b instanceof oa};types.isMessage=function(b){return b instanceof ua};types.GradientPart=Fa;types.isGradientPart=function(b){return b instanceof Fa};types.MultiPart=ia;types.isMultiPart=function(b){return b instanceof
ia}})();var state={};
(function(){var j=function(b){sys.print(types.toWrittenString(b)+"\n")},F=function(){throw Error("There is a software configuration error by the system's maintainer: the toplevel node has not been initialized yet.");},y=function(b,c,m){m(b+" not known")},c=function(){this.v=[];this.vstack=[];this.cstack=[];this.heap={};this.globals={};this.hooks={printHook:j,displayHook:j,toplevelNodeHook:F,imageProxyHook:!1,dynamicModuleLoader:y};this.invokedModules={};this.breakRequested=!1;this.breakRequestedListeners=
[]};c.prototype.clearForEval=function(b){this.v=[];this.vstack=[];this.cstack=[];if(!b||!b.preserveBreak)this.breakRequested=!1,this.breakRequestedListeners=[];b&&b.clearGlobals&&(this.globals={})};c.prototype.save=function(){return{v:this.v,vstack:this.vstack.slice(0),cstack:this.cstack.slice(0),heap:this.heap,globals:z(this.globals),hooks:this.hooks,breakRequested:this.breakRequested,breakRequestedListeners:z(this.breakRequestedListeners),invokedModules:this.invokedModules}};var b={}.hasOwnProperty,
z=function(c){var u={},m;for(m in c)b.call(c,m)&&(u[m]=c[m]);return u};c.prototype.restore=function(b){this.v=b.v;this.vstack=b.vstack;this.cstack=b.cstack;this.heap=b.heap;this.globals=b.globals;this.hooks=b.hooks;this.breakRequestListeners=b.breakRequestListeners;this.invokedModules=b.invokedModules};c.prototype.requestBreak=function(){this.breakRequested=!0;for(var b=0;b<this.breakRequestedListeners.length;b++)try{this.breakRequestedListeners[b]()}catch(c){helpers.reportError(c)}};c.prototype.addBreakRequestedListener=
function(b){this.breakRequestedListeners.push(b)};c.prototype.removeBreakRequestedListener=function(b){for(var c=this.breakRequestedListeners.length-1;0<=c;c--)this.breakRequestedListeners[c]===b&&this.breakRequestedListeners.splice(c,1)};c.prototype.pushControl=function(b){this.cstack.push(b)};c.prototype.pushManyControls=function(b){for(var c=0;c<b.length;c++)this.cstack.push(b[b.length-1-c])};c.prototype.isStuck=function(){return 0===this.cstack.length};c.prototype.popControl=function(){if(0===
this.cstack.length)throw types.internalError("cstack empty",I(this));return this.cstack.pop()};c.prototype.pushValue=function(b){this.vstack.push(b)};c.prototype.popValue=function(){if(0===this.vstack.length)throw types.internalError("vstack empty",I(this));return this.vstack.pop()};c.prototype.pushn=function(b){for(var c=0;c<b;c++)this.vstack.push(types.UNDEFINED)};c.prototype.popn=function(b){for(var c=[],m=0;m<b;m++){if(0===this.vstack.length)throw types.internalError("vstack empty",I(this));c.push(this.vstack.pop())}return c};
c.prototype.peekn=function(b){if(0>this.vstack.length-1-(b||0))throw types.internalError("vstack not long enough",I(this));return this.vstack[this.vstack.length-1-(b||0)]};c.prototype.setn=function(b,c){this.vstack[this.vstack.length-1-(b||0)]=c};c.prototype.refPrefix=function(b,c,m){b=this.vstack[this.vstack.length-1-b].ref(c,m);if(b instanceof types.ModuleVariableRecord&&this.invokedModules[b.resolvedModuleName]){c=this.invokedModules[b.resolvedModuleName];if("undefined"!==typeof c.providedValues[b.variableName])return c.providedValues[b.variableName];
throw types.schemeError(types.exnFailContractVariable("reference to an identifier before its definition: "+b.variableName,!1,b.variableName));}return b};c.prototype.setPrefix=function(b,c,m){this.vstack[this.vstack.length-1-b].set(c,m)};c.prototype.setPrintHook=function(b){this.hooks.printHook=b};c.prototype.getPrintHook=function(){return this.hooks.printHook};c.prototype.setDisplayHook=function(b){this.hooks.displayHook=b};c.prototype.setImageProxyHook=function(b){this.hooks.imageProxyHook=b};c.prototype.getImageProxyHook=
function(){return this.hooks.imageProxyHook};c.prototype.getDisplayHook=function(){return this.hooks.displayHook};c.prototype.getToplevelNodeHook=function(){return this.hooks.toplevelNodeHook};c.prototype.setToplevelNodeHook=function(b){this.hooks.toplevelNodeHook=b};var I=function(b){for(var c=types.makeLowLevelEqHash(),m=0;m<b.cstack.length;m++)if(types.isContMarkRecordControl(b.cstack[m])){var t=b.cstack[m].dict,q;for(q in t)c.put(q,[t[q]]),c.get(q).push(t[q])}return types.continuationMarkSet(c)},
B=function(c,u){for(var m in c)if(b.call(c,m))if(b.call(u,m)){if(c[m]!==u[m])return!1}else return!1;for(m in u)if(b.call(u,m))if(b.call(c,m)){if(c[m]!==u[m])return!1}else return!1;return!0};state.State=c;state.isState=function(b){return b instanceof c};state.captureCurrentContinuationMarks=I;state.getStackTraceFromContinuationMarks=function(b){for(var c=[],b=b.ref("moby-stack-record-continuation-mark-key"),m=b.length-1;0<=m;m--){var t=b[m],q=t.ref(0),j=t.ref(1),z=t.ref(2),I=t.ref(3),t=t.ref(4),q=
{id:q,offset:j,line:z,column:I,span:t};(0===c.length||!B(c[c.length-1],q))&&c.push(q)}return c}})();"undefined"===typeof world&&(world={});
(function(j){var F=function(e,u){var m=e[0],t=e[1],q=e[2],j=e[3],m=c(m,t,q,j,u[0],7,-680876936),j=c(j,m,t,q,u[1],12,-389564586),q=c(q,j,m,t,u[2],17,606105819),t=c(t,q,j,m,u[3],22,-1044525330),m=c(m,t,q,j,u[4],7,-176418897),j=c(j,m,t,q,u[5],12,1200080426),q=c(q,j,m,t,u[6],17,-1473231341),t=c(t,q,j,m,u[7],22,-45705983),m=c(m,t,q,j,u[8],7,1770035416),j=c(j,m,t,q,u[9],12,-1958414417),q=c(q,j,m,t,u[10],17,-42063),t=c(t,q,j,m,u[11],22,-1990404162),m=c(m,t,q,j,u[12],7,1804603682),j=c(j,m,t,q,u[13],12,-40341101),
q=c(q,j,m,t,u[14],17,-1502002290),t=c(t,q,j,m,u[15],22,1236535329),m=b(m,t,q,j,u[1],5,-165796510),j=b(j,m,t,q,u[6],9,-1069501632),q=b(q,j,m,t,u[11],14,643717713),t=b(t,q,j,m,u[0],20,-373897302),m=b(m,t,q,j,u[5],5,-701558691),j=b(j,m,t,q,u[10],9,38016083),q=b(q,j,m,t,u[15],14,-660478335),t=b(t,q,j,m,u[4],20,-405537848),m=b(m,t,q,j,u[9],5,568446438),j=b(j,m,t,q,u[14],9,-1019803690),q=b(q,j,m,t,u[3],14,-187363961),t=b(t,q,j,m,u[8],20,1163531501),m=b(m,t,q,j,u[13],5,-1444681467),j=b(j,m,t,q,u[2],9,-51403784),
q=b(q,j,m,t,u[7],14,1735328473),t=b(t,q,j,m,u[12],20,-1926607734),m=y(t^q^j,m,t,u[5],4,-378558),j=y(m^t^q,j,m,u[8],11,-2022574463),q=y(j^m^t,q,j,u[11],16,1839030562),t=y(q^j^m,t,q,u[14],23,-35309556),m=y(t^q^j,m,t,u[1],4,-1530992060),j=y(m^t^q,j,m,u[4],11,1272893353),q=y(j^m^t,q,j,u[7],16,-155497632),t=y(q^j^m,t,q,u[10],23,-1094730640),m=y(t^q^j,m,t,u[13],4,681279174),j=y(m^t^q,j,m,u[0],11,-358537222),q=y(j^m^t,q,j,u[3],16,-722521979),t=y(q^j^m,t,q,u[6],23,76029189),m=y(t^q^j,m,t,u[9],4,-640364487),
j=y(m^t^q,j,m,u[12],11,-421815835),q=y(j^m^t,q,j,u[15],16,530742520),t=y(q^j^m,t,q,u[2],23,-995338651),m=z(m,t,q,j,u[0],6,-198630844),j=z(j,m,t,q,u[7],10,1126891415),q=z(q,j,m,t,u[14],15,-1416354905),t=z(t,q,j,m,u[5],21,-57434055),m=z(m,t,q,j,u[12],6,1700485571),j=z(j,m,t,q,u[3],10,-1894986606),q=z(q,j,m,t,u[10],15,-1051523),t=z(t,q,j,m,u[1],21,-2054922799),m=z(m,t,q,j,u[8],6,1873313359),j=z(j,m,t,q,u[15],10,-30611744),q=z(q,j,m,t,u[6],15,-1560198380),t=z(t,q,j,m,u[13],21,1309151649),m=z(m,t,q,j,
u[4],6,-145523070),j=z(j,m,t,q,u[11],10,-1120210379),q=z(q,j,m,t,u[2],15,718787259),t=z(t,q,j,m,u[9],21,-343485551);e[0]=B(m,e[0]);e[1]=B(t,e[1]);e[2]=B(q,e[2]);e[3]=B(j,e[3])},y=function(b,c,m,j,q,z){c=B(B(c,b),B(j,z));return B(c<<q|c>>>32-q,m)},c=function(b,c,m,j,q,z,I){return y(c&m|~c&j,b,c,q,z,I)},b=function(b,c,m,j,q,z,I){return y(c&j|m&~j,b,c,q,z,I)},z=function(b,c,m,j,q,z,I){return y(m^(c|~j),b,c,q,z,I)},I="0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f".split(","),B=function(b,c){return b+c&4294967295};
"5d41402abc4b2a76b9719d911017c592"!=(j.md5=function(b){var c=b,m=c.length,b=[1732584193,-271733879,-1732584194,271733878],j;for(j=64;j<=c.length;j+=64){for(var q=b,z=c.substring(j-64,j),B=[],y=void 0,y=0;64>y;y+=4)B[y>>2]=z.charCodeAt(y)+(z.charCodeAt(y+1)<<8)+(z.charCodeAt(y+2)<<16)+(z.charCodeAt(y+3)<<24);F(q,B)}c=c.substring(j-64);q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(j=0;j<c.length;j++)q[j>>2]|=c.charCodeAt(j)<<(j%4<<3);q[j>>2]|=128<<(j%4<<3);if(55<j){F(b,q);for(j=0;16>j;j++)q[j]=0}q[14]=8*
m;F(b,q);for(c=0;c<b.length;c++){m=b;j=c;q=b[c];z="";for(B=0;4>B;B++)z+=I[q>>8*B+4&15]+I[q>>8*B&15];m[j]=z}return b.join("")})("hello")&&(B=function(b,c){var j=(b&65535)+(c&65535);return(b>>16)+(c>>16)+(j>>16)<<16|j&65535})})(world);"undefined"===typeof world&&(world={});
(function(){world.config={};var j=function(){this.vals={changeWorld:!1,shutdownWorld:!1,initialEffect:!1,onRedraw:!1,onDraw:!1,onDrawCss:!1,tickDelay:!1,onTick:!1,onTickEffect:!1,onKey:!1,onKeyEffect:!1,onMouse:!1,onTilt:!1,onTiltEffect:!1,onTap:!1,onTapEffect:!1,onAcceleration:!1,onAccelerationEffect:!1,onShake:!1,onShakeEffect:!1,onSmsReceive:!1,onSmsReceiveEffect:!1,onLocationChange:!1,onLocationChangeEffect:!1,onAnnounce:!1,onAnnounceEffect:!1,stopWhen:!1,stopWhenEffect:!1,connectToGame:!1,onGameStart:!1,
onOpponentTurn:!1,onMyTurn:!1,afterMyTurn:!1,onGameFinish:!1}};j.prototype.lookup=function(j){if(j in this.vals)return this.vals[j];throw Error("Can't find "+j+" in the configuration");};j.prototype.updateAll=function(F){var y=new j,c=this.vals,b={},z;for(z in c)Object.hasOwnProperty.call(c,z)&&(b[z]=c[z]);for(z in F)Object.hasOwnProperty.call(F,z)&&(b[z]=F[z]);y.vals=b;return y};world.config.WorldConfig=j;world.config.CONFIG=new j;world.config.Kernel=world.config.Kernel||{};world.config.Kernel.getNoneEffect=
function(){throw Error("getNoneEffect: We should not be calling effects!");}})();
(function(){world.stimuli={};var j=[],F=function(){},y=function(b,c,B){this.config=b;this.caller=c;this.restarter=B;j.push(this)};y.prototype.doStimuli=function(b,c,j,e){var u=this;try{u.change(function(b,e){var m=[b].concat(j);c?u.caller(c,m,e):e(b)},e)}catch(m){this.onShutdown()}};y.prototype.onTilt=function(b,j){var B=this.lookup("onTilt");this.doStimuli(this.lookup("onTiltEffect"),B,helpers.map(c,b),j)};y.prototype.onAcceleration=function(b,j){var B=this.lookup("onAcceleration");this.doStimuli(this.lookup("onAccelerationEffect"),
B,helpers.map(c,b),j)};y.prototype.onShake=function(b,c){var j=this.lookup("onShake");this.doStimuli(this.lookup("onShakeEffect"),j,[],c)};y.prototype.onSmsReceive=function(b,c){var j=this.lookup("onSmsReceive");this.doStimuli(this.lookup("onSmsReceiveEffect"),j,[b[0]+"",b[1]+""],c)};y.prototype.onLocation=function(b,j){var B=this.lookup("onLocationChange");this.doStimuli(this.lookup("onLocationChangeEffect"),B,helpers.map(c,b),j)};y.prototype.onKey=function(b,c){var j=helpers.getKeyCodeName(b[0]),
e=this.lookup("onKey");this.doStimuli(this.lookup("onKeyEffect"),e,[j],c)};y.prototype.onAnnounce=function(b,c){for(var j=b[1],e=types.EMPTY,u=0;u<j.length;u++)e=types.cons(j[j.length-u-1],e);j=this.lookup("onAnnounce");u=this.lookup("onAnnounceEffect");this.doStimuli(j,u,[b[0],e],c)};y.prototype.onShutdown=function(){var b=j.indexOf(this);-1!=b&&j.splice(b,1);(b=this.lookup("shutdownWorld"))&&b()};var c=types["float"];y.prototype.lookup=function(b){return this.config.lookup(b)};y.prototype.change=
function(b,c){this.lookup("changeWorld")?this.lookup("changeWorld")(b,c):c()};var b=function(b){return function(){for(var c=arguments,B=0;B<j.length;B++)j[B][b](c,F)}};world.stimuli.StimuliHandler=y;world.stimuli.onTilt=b("onTilt");world.stimuli.onAcceleration=b("onAcceleration");world.stimuli.onShake=b("onShake");world.stimuli.onSmsReceive=b("onSmsReceive");world.stimuli.onLocation=b("onLocation");world.stimuli.onKey=b("onKey");world.stimuli.onAnnounce=b("onAnnounce");world.stimuli.massShutdown=
function(){for(var b=0;b<j.length;b++){var c=j[b].lookup("shutdownWorld");c&&c()}j=[]}})();"undefined"===typeof world&&(world={});
(function(){function j(b,c){if(0===c)return" transparent ";var e=F(types.colorRed(b),types.colorGreen(b),types.colorBlue(b)),j=world.Kernel.colorLabs.map(function(b){return{l:b.l,a:b.a,b:b.b,name:b.name,d:Math.sqrt(Math.pow(e.l-b.l,2)+Math.pow(e.a-b.a,2)+Math.pow(e.b-b.b,2))}}),j=j.sort(function(b,c){return b.d<c.d?-1:b.d>c.d?1:0}),j=j[0].name;return(isNaN(c)?"solid"===c?" solid ":" outline ":" translucent ")+j.toLowerCase()}function F(b,c,e){b=function(b,c,g){function e(b){b=parseFloat(b/255);return 100*
(0.04045<b?Math.pow((b+0.055)/1.055,2.4):b/12.92)}b=e(b);c=e(c);g=e(g);return[0.4124*b+0.3576*c+0.1805*g,0.2126*b+0.7152*c+0.0722*g,0.0193*b+0.1192*c+0.9505*g]}(b,c,e);b=function(b,c,g){function e(b){return 0.008856<b?Math.pow(b,1/3):7.787*b+16/116}c/=100;g/=108.883;b=e(b/95.047);c=e(c);g=e(g);return[116*c-16,500*(b-c),200*(c-g)]}(b[0],b[1],b[2]);return{l:b[0],a:b[1],b:b[2]}}world.Kernel={};var y=[],c=function(b){var c=function(){};c.prototype=b;return new c},b=[];world.Kernel.addAnnounceListener=
function(c){b.push(c)};world.Kernel.removeAnnounceListener=function(c){c=b.indexOf(c);-1!==c&&b.splice(c,1)};world.Kernel.announce=function(c,e){var j;for(j=0;j<b.length;j++)try{b[j](c,e)}catch(m){}};world.Kernel.updateWorld=function(b){world=b(world);for(b=0;b<y.length;b++)y[b](world)};world.Kernel.shutdownWorld=function(){};var z=function(b,c){if(b.length!==c.length)return!1;var e=b.map(function(b){return"x:"+b.x+",y:"+b.y}).join(","),j=c.map(function(b){return"x:"+b.x+",y:"+b.y}).join(",");return(e+
","+e).includes(j)},I=function(b){return{xs:b.map(function(b){return b.x}),ys:b.map(function(b){return b.y})}},B=function(b){b=I(b).xs;return Math.max.apply(Math,b)-Math.min.apply(Math,b)},e=function(b){b=I(b).ys;return Math.max.apply(Math,b)-Math.min.apply(Math,b)},u=function(b){var c=I(b),e=-Math.min.apply(Math,c.xs),j=-Math.min.apply(Math,c.ys);return b.map(function(b){return{x:b.x+e,y:b.y+j}})},m=function(){};world.Kernel.BaseImage=m;m.prototype.getHeight=function(){return Math.round(this.height)};
m.prototype.getWidth=function(){return Math.round(this.width)};m.prototype.getBaseline=function(){return Math.round(this.height)};m.prototype.getVertices=function(){return this.vertices?this.vertices:[{x:0,y:0},{x:this.width,y:0},{x:0,y:this.height},{x:this.width,y:this.height}]};m.prototype.render=function(b,c,j){if(!this.vertices)throw Error("BaseImage.render is not implemented for this type!");b.save();b.beginPath();var m="outline"!==this.style.toString().toLowerCase(),p;if(b.isEqualityTest||m)p=
this.vertices;else{var q=B(this.vertices)/2,t=e(this.vertices)/2;p=this.vertices.map(function(b){return{x:b.x+(b.x<q?0.5:-0.5),y:b.y+(b.y<t?0.5:-0.5)}})}b.moveTo(c+p[0].x,j+p[0].y);p.forEach(function(e){b.lineTo(c+e.x,j+e.y)});b.closePath();m?(b.fillStyle=ga(this.color,this.style),b.fill()):(b.strokeStyle=ga(this.color),b.stroke());b.restore()};world.Kernel.makeCanvas=makeCanvas=function(b,c){var e=document.createElement("canvas");e.width=b;e.height=c;e.style.width=e.width+"px";e.style.height=e.height+
"px";return e};m.prototype.toDomNode=function(){var b=this,c=b.getWidth(),e=b.getHeight(),j=world.Kernel.makeCanvas(c,e),m;j.afterAttach=function(){m=j.getContext("2d");b.render(m,0,0)};j.ariaText=this.ariaText||"image";return j};m.prototype.toWrittenString=function(){return"<image>"};m.prototype.toDisplayedString=this.toWrittenString;m.prototype.isEqual=function(b,c){if(!(b instanceof m)||this.getWidth()!==b.getWidth()||this.getHeight()!==b.getHeight())return!1;if(this.vertices&&b.vertices&&this.style===
b.style&&types.isEqual(this.color,b.color,c)&&z(this.vertices,b.vertices))return console.log("Using fast path for image equality check"),!0;console.log("Using slow path for image equality check");var e=this.toDomNode(),j=b.toDomNode();e.style.visibility=j.style.visibility="hidden";if(e.width!==j.width||e.height!==j.height)return!1;try{var p=e.getContext("2d"),q=j.getContext("2d");p.isEqualityTest=!0;q.isEqualityTest=!0;this.render(p,0,0);b.render(q,0,0);for(var t=document.createElement("canvas").getContext("2d"),
u=document.createElement("canvas").getContext("2d"),C=Math.min(1E4,e.width),B=Math.min(1E4,e.height),p=0;p<e.height;p+=B)for(q=0;q<e.width;q+=C){C=Math.min(C,e.width-q);B=Math.min(B,e.height-p);t.canvas.width=u.canvas.width=C;t.canvas.height=u.canvas.height=B;console.log("processing chunk from ("+q+","+p+") to ("+(q+C)+","+(p+B)+")");t.clearRect(0,0,C,B);t.drawImage(e,q,p,C,B,0,0,C,B);u.clearRect(0,0,C,B);u.drawImage(j,q,p,C,B,0,0,C,B);var y=t.canvas.toDataURL(),I=u.canvas.toDataURL(),G=world.md5(y),
H=world.md5(I);if(G!==H)return!1}}catch(k){return console.log("Couldn't compare images:",k),!1}return!0};var t=function(b,c,e,j,m){this.width=b;this.height=c;this.children=e;this.withBorder=j;this.color=m;this.ariaText=" scene that is "+b+" by "+c+". children are: ";this.ariaText+=e.map(function(b,c){return"child "+(c+1)+": "+b[0].ariaText+", positioned at "+b[1]+","+b[2]+" "}).join(". ")};t.prototype=c(m.prototype);t.prototype.add=function(b,c,e){return new t(this.width,this.height,this.children.concat([[b,
c-b.getWidth()/2,e-b.getHeight()/2]]),this.withBorder,this.color)};t.prototype.render=function(b,c,e){var j,m,p;b.save();b.fillStyle=this.color?ga(this.color):"transparent";b.fillRect(c,e,this.width,this.height);b.restore();b.save();b.beginPath();b.rect(c,e,this.width,this.height);b.clip();this.children.forEach(function(q){j=q[0];m=q[1];p=q[2];j.render(b,m+c,p+e)});b.restore();this.withBorder&&(b.strokeStyle="black",b.strokeRect(c,e,this.width,this.height))};t.prototype.isEqual=function(b,c){return b instanceof
t&&this.width==b.width&&this.height==b.height&&this.children.length==b.children.length&&this.children.every(function(e,j){var m=b.children[j];return e[1]==m[1]&&e[2]==m[2]&&types.isEqual(e[0],m[0],c)})||m.prototype.isEqual.call(this,b,c)};var q=function(b,c,e){function j(){m.isLoaded=!0;m.width=m.img.width;m.height=m.img.height}var m=this;this.src=b;this.isLoaded=!1;this.ariaText=" image file from "+decodeURIComponent(b).slice(16);this.labeled=!1;this.animationHackImg=void 0;c&&c.complete?(m.img=
c,j()):(m.img=new Image,m.img.onload=j,m.img.onerror=function(){m.img.onerror="";m.img.src="http://www.wescheme.org/images/broken.png"},m.img.src=b);this.installHackToSupportAnimatedGifs(e)};q.prototype=c(m.prototype);var L={};setInterval(function(){var b=[],c;for(c in L)L.hasOwnProperty(c)&&!L[c].labeled&&b.push(L[c]);if(0!==b.length){var e=[];b.forEach(function(b){var c=document.createElement("canvas");c.width=b.width;c.height=b.height;c.getContext("2d").drawImage(b.animationHackImg,0,0);c=c.toDataURL();
if(4194304<Math.round(3*c.length/4))return L[b.src].labeled=!0,L[b.src].ariaText="a large image",e;e.push({image:{content:c.replace("data:image/png;base64,","")},features:[{type:"LABEL_DETECTION",maxResults:10}]})});c=JSON.stringify({requests:e});try{var j=new XMLHttpRequest;j.onload=function(){var c=JSON.parse(this.responseText);console.log(c.responses);c.responses.forEach(function(c,e){c.labelAnnotations.sort(function(b,c){return b.confidence<c.confidence?1:-1});var j=c.labelAnnotations[0].description;
L[b[e].src].labeled=!0;L[b[e].src].ariaText=" a picture of a "+j})};j.onerror=function(){console.log("failure")};j.open("POST","https://vision.googleapis.com/v1/images:annotate?key="+plt.config.API_KEY);j.setRequestHeader("content-type","application/json");j.send(c)}catch(m){console.log("Google Vision API lookup failed",m)}}},5E3);q.makeInstance=function(b,c,e){b in L?(e(L[b]),console.log("returning from cache",L[b])):L[b]=new q(b,c,e);return L[b]};q.installBrokenImage=function(b){L[b]=new ha("Unable to load "+
b,10,p.get("red"),"normal","Arial","","",!1)};q.prototype.render=function(b,c,e){b.drawImage(this.animationHackImg,c,e)};q.prototype.installHackToSupportAnimatedGifs=function(b){var c=this;this.animationHackImg=this.img.cloneNode(!0);document.body.appendChild(this.animationHackImg);this.animationHackImg.style.position="absolute";this.animationHackImg.style.top="-50000px";this.animationHackImg.complete?b(c):this.animationHackImg.onload=function(){b(c)}};q.prototype.getWidth=function(){return Math.round(this.img.width)};
q.prototype.getHeight=function(){return Math.round(this.img.height)};q.prototype.isEqual=function(b,c){return b instanceof q&&this.src===b.src||m.prototype.isEqual.call(this,b,c)};var V=function(b,c){var e=this;this.src=b;this.ariaText=" video file from "+decodeURIComponent(b).slice(16);c?(this.video=c,this.width=e.video.videoWidth,this.height=e.video.videoHeight,this.video.volume=1,this.video.poster="http://www.wescheme.org/images/broken.png",this.video.autoplay=!0,this.video.autobuffer=!0,this.video.loop=
!0,this.video.play()):(this.video=document.createElement("video"),this.video.src=b,this.video.addEventListener("canplay",function(){this.width=e.video.videoWidth;this.height=e.video.videoHeight;this.video.poster="http://www.wescheme.org/images/broken.png";this.video.autoplay=!0;this.video.autobuffer=!0;this.video.loop=!0;this.video.play()}),this.video.addEventListener("error",function(){e.video.onerror="";e.video.poster="http://www.wescheme.org/images/broken.png"}))};V.prototype=c(m.prototype);var $=
{};V.makeInstance=function(b,c){b in V||($[b]=new V(b,c));return $[b]};V.prototype.render=function(b,c,e){b.drawImage(this.video,c,e)};V.prototype.isEqual=function(b,c){return b instanceof V&&this.src===b.src||m.prototype.isEqual.call(this,b,c)};var S=function(b,c,e){this.src=b;var j=this;e&&4===e.readyState?(j.audio=e,j.audio.autoplay=!0,j.audio.autobuffer=!0,j.audio.currentTime=0,j.audio.loop=c,j.audio.play()):(j.audio=document.createElement("audio"),j.audio.src=b,j.audio.addEventListener("canplay",
function(){j.audio.autoplay=!0;j.audio.autobuffer=!0;j.audio.currentTime=0;j.audio.loop=c;j.audio.play()}));return!0},ya={};S.makeInstance=function(b,c,e){b in ya?(ya[b].audio.play(),afterInit(ya[b])):ya[b]=new S(b,c,e,afterInit);return ya[b]};c(m.prototype);var aa=function(b,c,j,m){var p,q,t,u;"left"===j?t=p=0:"right"===j?(p=Math.max(b.width,c.width)-b.width,t=Math.max(b.width,c.width)-c.width):"beside"===j?(p=0,t=b.width):"middle"===j||"center"===j?(p=Math.max(b.width,c.width)/2-b.width/2,t=Math.max(b.width,
c.width)/2-c.width/2):(p=Math.max(j,0)-j,t=Math.max(j,0));"top"===m?u=q=0:"bottom"===m?(q=Math.max(b.height,c.height)-b.height,u=Math.max(b.height,c.height)-c.height):"above"===m?(q=0,u=b.height):"baseline"===m?(q=Math.max(b.getBaseline(),c.getBaseline())-b.getBaseline(),u=Math.max(b.getBaseline(),c.getBaseline())-c.getBaseline()):"middle"===m||"center"===m?(q=Math.max(b.height,c.height)/2-b.height/2,u=Math.max(b.height,c.height)/2-c.height/2):(q=Math.max(m,0)-m,u=Math.max(m,0));var C=b.getVertices(),
z=c.getVertices(),C=C.map(function(b){return{x:b.x+p,y:b.y+q}}),z=z.map(function(b){return{x:b.x+t,y:b.y+u}});this._vertices=C.concat(z);this.x1=p;this.y1=q;this.x2=t;this.y2=u;this.img1=b;this.img2=c;var y;-1<["middle","center"].indexOf(j)&&-1<["middle","center"].indexOf(m)?y=" centered above ":"left"===j?y=" left-aligned ":"right"===j?y=" right-aligned ":"beside"===j?y=" beside ":isNaN(j)||(y=" shifted left by "+j);"top"===m?y+=" top-aligned ":"bottom"===m?y+=" bottom-aligned ":"above"===m?y+=" above ":
isNaN(m)||(y+=" , shifted up by "+m);this.width=B(this._vertices);this.height=e(this._vertices);this.ariaText=" an overlay: first image is"+b.ariaText+y+c.ariaText};aa.prototype=c(m.prototype);aa.prototype.getVertices=function(){return this._vertices};aa.prototype.render=function(b,c,e){b.save();this.img2.render(b,c+this.x2,e+this.y2);this.img1.render(b,c+this.x1,e+this.y1);b.restore()};aa.prototype.isEqual=function(b,c){return b instanceof aa&&this.width===b.width&&this.height===b.height&&this.x1===
b.x1&&this.y1===b.y1&&this.x2===b.x2&&this.y2===b.y2&&types.isEqual(this.img1,b.img1,c)&&types.isEqual(this.img2,b.img2,c)||m.prototype.isEqual.call(this,b,c)};var Y=function(b,c){c instanceof N&&c.width==c.height&&(b=0);var j=Math.sin(b*Math.PI/180),m=Math.cos(b*Math.PI/180),p=c.getVertices().map(function(b){return{x:b.x*m-b.y*j,y:b.x*j+b.y*m}}),q=I(p);this._vertices=u(p);this.img=c;this.width=B(p);this.height=e(p);this.angle=Math.round(b);this.translateX=-Math.min.apply(Math,q.xs);this.translateY=
-Math.min.apply(Math,q.ys);this.ariaText="Rotated image, "+b+" degrees: "+c.ariaText};Y.prototype=c(m.prototype);Y.prototype.getVertices=function(){return this._vertices};Y.prototype.render=function(b,c,e){b.save();b.translate(c+this.translateX,e+this.translateY);b.rotate(this.angle*Math.PI/180);this.img.render(b,0,0);b.restore()};Y.prototype.isEqual=function(b,c){return b instanceof Y&&this.width===b.width&&this.height===b.height&&this.angle===b.angle&&this.translateX===b.translateX&&this.translateY===
b.translateY&&types.isEqual(this.img,b.img,c)||m.prototype.isEqual.call(this,b,c)};var na=function(b,c,e){this._vertices=e.getVertices().map(function(e){return{x:e.x*b,y:e.y*c}});this.img=e;this.width=e.width*b;this.height=e.height*c;this.xFactor=b;this.yFactor=c;this.ariaText="Scaled Image, "+(b===c?"by "+b:"horizontally by "+b+" and vertically by "+c)+". "+e.ariaText};na.prototype=c(m.prototype);na.prototype.getVertices=function(){return this._vertices};na.prototype.render=function(b,c,e){b.save();
b.scale(this.xFactor,this.yFactor);this.img.render(b,c/this.xFactor,e/this.yFactor);b.restore()};na.prototype.isEqual=function(b,c){return b instanceof na&&this.width===b.width&&this.height===b.height&&this.xFactor===b.xFactor&&this.yFactor===b.yFactor&&types.isEqual(this.img,b.img,c)||m.prototype.isEqual.call(this,b,c)};var da=function(b,c,e,j,m){this.x=b;this.y=c;this.width=e;this.height=j;this.img=m;this.ariaText="Cropped image, from "+b+", "+c+" to "+(b+e)+", "+(c+j)+": "+m.ariaText};da.prototype=
c(m.prototype);da.prototype.render=function(b,c,e){b.save();b.beginPath();b.rect(c,e,this.width,this.height);b.clip();b.translate(-this.x,-this.y);this.img.render(b,c,e);b.restore()};da.prototype.isEqual=function(b,c){return b instanceof da&&this.width===b.width&&this.height===b.height&&this.x===b.x&&this.y===b.y&&types.isEqual(this.img,b.img,c)||m.prototype.isEqual.call(this,b,c)};var C=function(b){this.img=b;this.width=b.width;this.height=b.height;this.ariaText=" Framed image: "+b.ariaText};C.prototype=
c(m.prototype);C.prototype.render=function(b,c,e){b.save();this.img.render(b,c,e);b.beginPath();b.strokeStyle="black";b.strokeRect(c,e,this.width,this.height);b.closePath();b.restore()};C.prototype.isEqual=function(b,c){return b instanceof C&&types.isEqual(this.img,b.img,c)||m.prototype.isEqual.call(this,b,c)};var X=function(b,c){this.img=b;this.width=b.getWidth();this.height=b.getHeight();this.direction=c;this.ariaText=c+"ly flipped image: "+b.ariaText};X.prototype=c(m.prototype);X.prototype.render=
function(b,c,e){b.save();"horizontal"===this.direction&&(b.scale(-1,1),b.translate(-(this.width+2*c),0));"vertical"===this.direction&&(b.scale(1,-1),b.translate(0,-(this.height+2*e)));this.img.render(b,c,e);b.restore()};X.prototype.isEqual=function(b,c){return b instanceof X&&this.width===b.width&&this.height===b.height&&this.direction===b.direction&&types.isEqual(this.img,b.img,c)||m.prototype.isEqual.call(this,b,c)};var ga=function(b,c){var e=isNaN(c)?1:c/255,j=types.colorAlpha(b)/255;return"rgba("+
types.colorRed(b)+", "+types.colorGreen(b)+", "+types.colorBlue(b)+", "+e*j+")"},ka=function(b,c,e,m){this.width=Math.max(1,b);this.height=Math.max(1,c);this.style=e;this.color=m;this.vertices=[{x:0,y:c},{x:0,y:0},{x:b,y:0},{x:b,y:c}];this.ariaText=" a"+j(m,e)+(b===c?" square of size "+b:" rectangle of width "+b+" and height "+c)};ka.prototype=c(m.prototype);var ta=function(b,c,e,m){this.width=2*Math.sin(c/2*Math.PI/180)*b;this.height=2*Math.abs(Math.cos(c/2*Math.PI/180))*b;this.style=e;this.color=
m;this.vertices=[{x:this.width/2,y:0},{x:this.width,y:this.height/2},{x:this.width/2,y:this.height},{x:0,y:this.height/2}];this.ariaText=" a"+j(m,e)+" rhombus of size "+b+" and angle "+c};ta.prototype=c(m.prototype);var Z=function(b,c,j){b=b.map(function(b){return{x:types.posnX(b),y:types.posnY(b)}});this.width=B(b);this.height=e(b);this.style=c;this.color=j;this.vertices=u(b)};Z.prototype=c(m.prototype);var ca=function(b,c,m,p,q,t){this.outerRadius=Math.round(b/(2*Math.sin(Math.PI/c)));this.innerRadius=
Math.round(b/(2*Math.tan(Math.PI/c)));for(var C=3*Math.PI/2+Math.PI/c,z=0,y=[],I=0;I<c;I++)z+=2*m*Math.PI/c,y.push({x:Math.round(this.outerRadius*Math.cos(z-C)),y:Math.round(this.outerRadius*Math.sin(z-C))});this.width=B(y);this.height=e(y);this.style=p;this.color=q;this.vertices=u(y);this.ariaText=" a"+j(q,p)+(t?" "+t+" of size "+b:", "+c+" sided polygon with each side of length "+b)};ca.prototype=c(m.prototype);var ha=function(b,c,e,m,p,q,t,u,C){b=JSON.stringify(b);this.str=b.substring(1,b.length-
1);this.size=c;this.color=e;this.face=m;this.family=p;this.outline=C||!1;this.style="slant"===q?"oblique":q;this.weight="light"===t?"lighter":t;this.underline=u;this.font=this.style+" "+this.weight+" "+this.size+'px "'+this.face+'", '+this.family;b=document.createElement("div");m=document.createElement("span");p=document.createElement("img");m.style.font=this.font;p.width=42;p.height=1;p.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIHWM4MbPgPwAGzwLR05RbqwAAAABJRU5ErkJggg==";
b.style.cssText="position: absolute; top: 0px; left: 0px; zIndex=-1; white-space: pre;";m.appendChild(document.createTextNode(this.str));m.appendChild(p);b.appendChild(m);document.body.appendChild(b);p.style.display="none";m.style.display="inline";this.alphaBaseline=0;this.width=m.offsetWidth;this.height=m.offsetHeight;document.body.removeChild(b);this.ariaText=" the string "+this.str+", colored "+j(e,"solid")+" of size "+c};ha.prototype=c(m.prototype);ha.prototype.render=function(b,c,e){b.save();
b.textAlign="left";b.textBaseline="top";b.font=this.font;b.fillStyle=this.outline?"white":ga(this.color);b.fillText(this.str,c,e);this.outline&&(b.strokeStyle=ga(this.color),b.strokeText(this.str,c,e));this.underline&&(b.beginPath(),b.moveTo(c,e+this.size),b.lineTo(c+this.width,e+this.size),b.closePath(),b.strokeStyle=ga(this.color),b.stroke());b.restore()};ha.prototype.getBaseline=function(){return this.alphaBaseline};ha.prototype.isEqual=function(b,c){return b instanceof ha&&this.str===b.str&&this.size===
b.size&&this.face===b.face&&this.family===b.family&&this.style===b.style&&this.weight===b.weight&&this.underline===b.underline&&this.font===b.font&&types.isEqual(this.color,b.color,c)||m.prototype.isEqual.call(this,b,c)};var W=function(b,c,m,p,q){for(var t=Math.max(m,c),C=[],z=Math.PI/180,y=0;y<2*b+1;y++){var I=360/(2*b)*y*z-0.5,G=1===y%2?c:m;C.push({x:t+Math.sin(I)*G,y:t+Math.cos(I)*G})}this.width=B(C);this.height=e(C);this.style=p;this.color=q;this.vertices=u(C);this.ariaText=" a"+j(q,p)+", "+b+
"pointed star with inner radius "+m+" and outer radius "+c};W.prototype=c(m.prototype);var K=function(b,c,e,m,p){var q=e*Math.cos(c*Math.PI/180),t=e*Math.sin(c*Math.PI/180),u=0-Math.min(0,q),C=[];0<t?(C.push({x:u+0,y:0}),C.push({x:u+b,y:0}),C.push({x:u+q,y:t})):(C.push({x:u+0,y:-t}),C.push({x:u+b,y:-t}),C.push({x:u+q,y:0}));this.width=Math.max(b,q)+u;this.height=Math.abs(t);this.style=m;this.color=p;this.vertices=C;this.ariaText=" a"+j(p,m);this.ariaText=270===c?this.ariaText+(" right triangle whose base is of length "+
b+" and height of "+e):300===c&&b===e?this.ariaText+(" equilateral triangle with sides of length "+b):this.ariaText+(" triangle whose base is of length "+b+", with an angle of "+c%180+" degrees between it and a side of length "+e)};K.prototype=c(m.prototype);var N=function(b,c,e,m){this.width=b;this.height=c;this.style=e;this.color=m;this.ariaText=" a"+j(m,e)+(b===c?" circle of radius "+b/2:" ellipse of width "+b+" and height "+c)};N.prototype=c(m.prototype);N.prototype.render=function(b,c,e){b.save();
b.beginPath();var j="outline"!==this.style.toString().toLowerCase()?0:0.5,m=this.width-2*j,p=this.height-2*j,c=c+j,e=e+j,j=0.5522848*(m/2),q=0.5522848*(p/2),t=c+m,u=e+p,m=c+m/2,p=e+p/2;b.moveTo(c,p);b.bezierCurveTo(c,p-q,m-j,e,m,e);b.bezierCurveTo(m+j,e,t,p-q,t,p);b.bezierCurveTo(t,p+q,m+j,u,m,u);b.bezierCurveTo(m-j,u,c,p+q,c,p);b.closePath();"outline"===this.style.toString().toLowerCase()?(b.strokeStyle=ga(this.color),b.stroke()):(b.fillStyle=ga(this.color,this.style),b.fill());b.restore()};N.prototype.isEqual=
function(b,c){return b instanceof N&&this.width===b.width&&this.height===b.height&&this.style===b.style&&types.isEqual(this.color,b.color,c)||m.prototype.isEqual.call(this,b,c)};var Ba=function(b,c,e){var m;m=0<=b?0<=c?[{x:0,y:0},{x:b,y:c}]:[{x:0,y:-c},{x:b,y:0}]:0<=c?[{x:-b,y:0},{x:0,y:c}]:[{x:-b,y:-c},{x:0,y:0}];this.width=Math.max(1,Math.abs(b));this.height=Math.max(1,Math.abs(c));this.style="outline";this.color=e;this.vertices=m;this.ariaText=" a"+j(e,"solid")+" line of width "+b+" and height "+
c};Ba.prototype=c(m.prototype);world.Kernel.applyEffect=function(b){if(b!==types.EMPTY){if(types.isPair(b))return world.Kernel.applyEffect(b.first).concat(world.Kernel.applyEffect(b.rest));if(b=b.run())return b}return[]};c=function(){this.colors={}};c.prototype.put=function(b,c){this.colors[b]=c};c.prototype.get=function(b){return this.colors[b.toString().toUpperCase()]};var p=new c;p.put("ORANGE",types.color(255,165,0,255));p.put("RED",types.color(255,0,0,255));p.put("ORANGERED",types.color(255,
69,0,255));p.put("TOMATO",types.color(255,99,71,255));p.put("DARKRED",types.color(139,0,0,255));p.put("RED",types.color(255,0,0,255));p.put("FIREBRICK",types.color(178,34,34,255));p.put("CRIMSON",types.color(220,20,60,255));p.put("DEEPPINK",types.color(255,20,147,255));p.put("MAROON",types.color(176,48,96,255));p.put("INDIAN RED",types.color(205,92,92,255));p.put("INDIANRED",types.color(205,92,92,255));p.put("MEDIUM VIOLET RED",types.color(199,21,133,255));p.put("MEDIUMVIOLETRED",types.color(199,
21,133,255));p.put("VIOLET RED",types.color(208,32,144,255));p.put("VIOLETRED",types.color(208,32,144,255));p.put("LIGHTCORAL",types.color(240,128,128,255));p.put("HOTPINK",types.color(255,105,180,255));p.put("PALEVIOLETRED",types.color(219,112,147,255));p.put("LIGHTPINK",types.color(255,182,193,255));p.put("ROSYBROWN",types.color(188,143,143,255));p.put("PINK",types.color(255,192,203,255));p.put("ORCHID",types.color(218,112,214,255));p.put("LAVENDERBLUSH",types.color(255,240,245,255));p.put("SNOW",
types.color(255,250,250,255));p.put("CHOCOLATE",types.color(210,105,30,255));p.put("SADDLEBROWN",types.color(139,69,19,255));p.put("BROWN",types.color(132,60,36,255));p.put("DARKORANGE",types.color(255,140,0,255));p.put("CORAL",types.color(255,127,80,255));p.put("SIENNA",types.color(160,82,45,255));p.put("ORANGE",types.color(255,165,0,255));p.put("SALMON",types.color(250,128,114,255));p.put("PERU",types.color(205,133,63,255));p.put("DARKGOLDENROD",types.color(184,134,11,255));p.put("GOLDENROD",types.color(218,
165,32,255));p.put("SANDYBROWN",types.color(244,164,96,255));p.put("LIGHTSALMON",types.color(255,160,122,255));p.put("DARKSALMON",types.color(233,150,122,255));p.put("GOLD",types.color(255,215,0,255));p.put("YELLOW",types.color(255,255,0,255));p.put("OLIVE",types.color(128,128,0,255));p.put("BURLYWOOD",types.color(222,184,135,255));p.put("TAN",types.color(210,180,140,255));p.put("NAVAJOWHITE",types.color(255,222,173,255));p.put("PEACHPUFF",types.color(255,218,185,255));p.put("KHAKI",types.color(240,
230,140,255));p.put("DARKKHAKI",types.color(189,183,107,255));p.put("MOCCASIN",types.color(255,228,181,255));p.put("WHEAT",types.color(245,222,179,255));p.put("BISQUE",types.color(255,228,196,255));p.put("PALEGOLDENROD",types.color(238,232,170,255));p.put("BLANCHEDALMOND",types.color(255,235,205,255));p.put("MEDIUM GOLDENROD",types.color(234,234,173,255));p.put("MEDIUMGOLDENROD",types.color(234,234,173,255));p.put("PAPAYAWHIP",types.color(255,239,213,255));p.put("MISTYROSE",types.color(255,228,225,
255));p.put("LEMONCHIFFON",types.color(255,250,205,255));p.put("ANTIQUEWHITE",types.color(250,235,215,255));p.put("CORNSILK",types.color(255,248,220,255));p.put("LIGHTGOLDENRODYELLOW",types.color(250,250,210,255));p.put("OLDLACE",types.color(253,245,230,255));p.put("LINEN",types.color(250,240,230,255));p.put("LIGHTYELLOW",types.color(255,255,224,255));p.put("SEASHELL",types.color(255,245,238,255));p.put("BEIGE",types.color(245,245,220,255));p.put("FLORALWHITE",types.color(255,250,240,255));p.put("IVORY",
types.color(255,255,240,255));p.put("GREEN",types.color(0,255,0,255));p.put("LAWNGREEN",types.color(124,252,0,255));p.put("CHARTREUSE",types.color(127,255,0,255));p.put("GREEN YELLOW",types.color(173,255,47,255));p.put("GREENYELLOW",types.color(173,255,47,255));p.put("YELLOW GREEN",types.color(154,205,50,255));p.put("YELLOWGREEN",types.color(154,205,50,255));p.put("MEDIUM FOREST GREEN",types.color(107,142,35,255));p.put("OLIVEDRAB",types.color(107,142,35,255));p.put("MEDIUMFORESTGREEN",types.color(107,
142,35,255));p.put("DARK OLIVE GREEN",types.color(85,107,47,255));p.put("DARKOLIVEGREEN",types.color(85,107,47,255));p.put("DARKSEAGREEN",types.color(143,188,139,255));p.put("LIME",types.color(0,255,0,255));p.put("DARK GREEN",types.color(0,100,0,255));p.put("DARKGREEN",types.color(0,100,0,255));p.put("LIME GREEN",types.color(50,205,50,255));p.put("LIMEGREEN",types.color(50,205,50,255));p.put("FOREST GREEN",types.color(34,139,34,255));p.put("FORESTGREEN",types.color(34,139,34,255));p.put("SPRING GREEN",
types.color(0,255,127,255));p.put("SPRINGGREEN",types.color(0,255,127,255));p.put("MEDIUM SPRING GREEN",types.color(0,250,154,255));p.put("MEDIUMSPRINGGREEN",types.color(0,250,154,255));p.put("SEA GREEN",types.color(46,139,87,255));p.put("SEAGREEN",types.color(46,139,87,255));p.put("MEDIUM SEA GREEN",types.color(60,179,113,255));p.put("MEDIUMSEAGREEN",types.color(60,179,113,255));p.put("AQUAMARINE",types.color(112,216,144,255));p.put("LIGHTGREEN",types.color(144,238,144,255));p.put("PALE GREEN",types.color(152,
251,152,255));p.put("PALEGREEN",types.color(152,251,152,255));p.put("MEDIUM AQUAMARINE",types.color(102,205,170,255));p.put("MEDIUMAQUAMARINE",types.color(102,205,170,255));p.put("TURQUOISE",types.color(64,224,208,255));p.put("LIGHTSEAGREEN",types.color(32,178,170,255));p.put("MEDIUM TURQUOISE",types.color(72,209,204,255));p.put("MEDIUMTURQUOISE",types.color(72,209,204,255));p.put("HONEYDEW",types.color(240,255,240,255));p.put("MINTCREAM",types.color(245,255,250,255));p.put("ROYALBLUE",types.color(65,
105,225,255));p.put("DODGERBLUE",types.color(30,144,255,255));p.put("DEEPSKYBLUE",types.color(0,191,255,255));p.put("CORNFLOWERBLUE",types.color(100,149,237,255));p.put("STEEL BLUE",types.color(70,130,180,255));p.put("STEELBLUE",types.color(70,130,180,255));p.put("LIGHTSKYBLUE",types.color(135,206,250,255));p.put("DARK TURQUOISE",types.color(0,206,209,255));p.put("DARKTURQUOISE",types.color(0,206,209,255));p.put("CYAN",types.color(0,255,255,255));p.put("AQUA",types.color(0,255,255,255));p.put("DARKCYAN",
types.color(0,139,139,255));p.put("TEAL",types.color(0,128,128,255));p.put("SKY BLUE",types.color(135,206,235,255));p.put("SKYBLUE",types.color(135,206,235,255));p.put("CADET BLUE",types.color(96,160,160,255));p.put("CADETBLUE",types.color(95,158,160,255));p.put("DARK SLATE GRAY",types.color(47,79,79,255));p.put("DARKSLATEGRAY",types.color(47,79,79,255));p.put("LIGHTSLATEGRAY",types.color(119,136,153,255));p.put("SLATEGRAY",types.color(112,128,144,255));p.put("LIGHT STEEL BLUE",types.color(176,196,
222,255));p.put("LIGHTSTEELBLUE",types.color(176,196,222,255));p.put("LIGHT BLUE",types.color(173,216,230,255));p.put("LIGHTBLUE",types.color(173,216,230,255));p.put("POWDERBLUE",types.color(176,224,230,255));p.put("PALETURQUOISE",types.color(175,238,238,255));p.put("LIGHTCYAN",types.color(224,255,255,255));p.put("ALICEBLUE",types.color(240,248,255,255));p.put("AZURE",types.color(240,255,255,255));p.put("MEDIUM BLUE",types.color(0,0,205,255));p.put("MEDIUMBLUE",types.color(0,0,205,255));p.put("DARKBLUE",
types.color(0,0,139,255));p.put("MIDNIGHT BLUE",types.color(25,25,112,255));p.put("MIDNIGHTBLUE",types.color(25,25,112,255));p.put("NAVY",types.color(36,36,140,255));p.put("BLUE",types.color(0,0,255,255));p.put("INDIGO",types.color(75,0,130,255));p.put("BLUE VIOLET",types.color(138,43,226,255));p.put("BLUEVIOLET",types.color(138,43,226,255));p.put("MEDIUM SLATE BLUE",types.color(123,104,238,255));p.put("MEDIUMSLATEBLUE",types.color(123,104,238,255));p.put("SLATE BLUE",types.color(106,90,205,255));
p.put("SLATEBLUE",types.color(106,90,205,255));p.put("PURPLE",types.color(160,32,240,255));p.put("DARK SLATE BLUE",types.color(72,61,139,255));p.put("DARKSLATEBLUE",types.color(72,61,139,255));p.put("DARKVIOLET",types.color(148,0,211,255));p.put("DARK ORCHID",types.color(153,50,204,255));p.put("DARKORCHID",types.color(153,50,204,255));p.put("MEDIUMPURPLE",types.color(147,112,219,255));p.put("CORNFLOWER BLUE",types.color(68,64,108,255));p.put("MEDIUM ORCHID",types.color(186,85,211,255));p.put("MEDIUMORCHID",
types.color(186,85,211,255));p.put("MAGENTA",types.color(255,0,255,255));p.put("FUCHSIA",types.color(255,0,255,255));p.put("DARKMAGENTA",types.color(139,0,139,255));p.put("VIOLET",types.color(238,130,238,255));p.put("PLUM",types.color(221,160,221,255));p.put("LAVENDER",types.color(230,230,250,255));p.put("THISTLE",types.color(216,191,216,255));p.put("GHOSTWHITE",types.color(248,248,255,255));p.put("WHITE",types.color(255,255,255,255));p.put("WHITESMOKE",types.color(245,245,245,255));p.put("GAINSBORO",
types.color(220,220,220,255));p.put("LIGHT GRAY",types.color(211,211,211,255));p.put("LIGHTGRAY",types.color(211,211,211,255));p.put("SILVER",types.color(192,192,192,255));p.put("GRAY",types.color(190,190,190,255));p.put("DARK GRAY",types.color(169,169,169,255));p.put("DARKGRAY",types.color(169,169,169,255));p.put("DIM GRAY",types.color(105,105,105,255));p.put("DIMGRAY",types.color(105,105,105,255));p.put("BLACK",types.color(0,0,0,255));p.put("TRANSPARENT",types.color(0,0,0,0));var c=[],H=p.colors,
M;for(M in H)if(H.hasOwnProperty(M)){var G=F(types.colorRed(H[M]),types.colorGreen(H[M]),types.colorBlue(H[M]));c.push({name:M,l:G.l,a:G.a,b:G.b})}world.Kernel.isImage=function(b){return null!==b&&void 0!==b&&b instanceof m};world.Kernel.isScene=function(b){return void 0!==b&&null!==b&&b instanceof t};world.Kernel.isColor=function(b){return types.isColor(b)||(types.isString(b)||types.isSymbol(b))&&"undefined"!==typeof p.get(b)};world.Kernel.nameToColor=function(b){return p.get(""+b)};world.Kernel.colorDb=
p;world.Kernel.colorLabs=c;world.Kernel.sceneImage=function(b,c,e,j,m){return new t(b,c,e,j,m)};world.Kernel.circleImage=function(b,c,e){return new N(2*b,2*b,c,e)};world.Kernel.starImage=function(b,c,e,j,m){return new W(b,c,e,j,m)};world.Kernel.rectangleImage=function(b,c,e,j){return new ka(b,c,e,j)};world.Kernel.rhombusImage=function(b,c,e,j){return new ta(b,c,e,j)};world.Kernel.polygonImage=function(b,c,e,j,m,p){return new ca(b,c,e,j,m,p)};world.Kernel.posnImage=function(b,c,e){return new Z(b,c,
e)};world.Kernel.squareImage=function(b,c,e){return new ka(b,b,c,e)};world.Kernel.triangleImage=function(b,c,e,j,m){return new K(b,c,e,j,m)};world.Kernel.ellipseImage=function(b,c,e,j){return new N(b,c,e,j)};world.Kernel.lineImage=function(b,c,e){return new Ba(b,c,e)};world.Kernel.overlayImage=function(b,c,e,j){return new aa(b,c,e,j)};world.Kernel.rotateImage=function(b,c){return new Y(b,c)};world.Kernel.scaleImage=function(b,c,e){return new na(b,c,e)};world.Kernel.cropImage=function(b,c,e,j,m){return new da(b,
c,e,j,m)};world.Kernel.frameImage=function(b){return new C(b)};world.Kernel.flipImage=function(b,c){return new X(b,c)};world.Kernel.textImage=function(b,c,e,j,m,p,q,t,u){return new ha(b,c,e,j,m,p,q,t,u)};world.Kernel.fileImage=function(b,c,e){return q.makeInstance(b,c,e)};world.Kernel.fileVideo=function(b,c){return V.makeInstance(b,c)};world.Kernel.fileAudio=function(b,c,e){return S.makeInstance(b,c,e)};world.Kernel.isSceneImage=function(b){return b instanceof t};world.Kernel.isStarImage=function(b){return b instanceof
W};world.Kernel.isRectangleImage=function(b){return b instanceof ka};world.Kernel.isPolygonImage=function(b){return b instanceof ca};world.Kernel.isRhombusImage=function(b){return b instanceof ta};world.Kernel.isTriangleImage=function(b){return b instanceof K};world.Kernel.isEllipseImage=function(b){return b instanceof N};world.Kernel.isLineImage=function(b){return b instanceof Ba};world.Kernel.isOverlayImage=function(b){return b instanceof aa};world.Kernel.isRotateImage=function(b){return b instanceof
Y};world.Kernel.isScaleImage=function(b){return b instanceof na};world.Kernel.isCropImage=function(b){return b instanceof da};world.Kernel.isFrameImage=function(b){return b instanceof C};world.Kernel.isFlipImage=function(b){return b instanceof X};world.Kernel.isTextImage=function(b){return b instanceof ha};world.Kernel.isFileImage=function(b){return b instanceof q};world.Kernel.isFileVideo=function(b){return b instanceof V}})();
(function(){var j=jsworld.MobyJsworld={},F=jsworld.Jsworld;(function(){for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c){var e=(new Date).getTime(),j=Math.max(0,16-(e-b)),m=window.setTimeout(function(){c(e+j)},j);b=
e+j;return m});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(b){clearTimeout(b)})})();document.getElementById("bigBangLog");var y,c=function(b){y=function(c,e,j){b(c,e,j,Y)}},b=function(){y=function(){throw Error("caller not defined!");}};b();var z,I=function(b){var c=!1;z=function(e){if(c)throw Error("Cannot restart twice!");c=!0;b(e)}};(function(){z=function(){throw Error("restarter not defined!");}})();var B,e=function(b){B=b},u=function(){B=function(){throw Error("terminator not defined!");
}};u();var m=[],t=function(b){helpers.forEachK(m,function(b,c){y(b.startup,b.startupArgs,function(e){b.shutdownArg=e;c()})},Y,b)},q=function(b){var c=m;m=[];helpers.forEachK(c,function(b,c){y(b.shutdown,[b.shutdownArg],c)},Y,b)},L=function(b){return types.jsObject("function",function(){for(var c=[],e=0;e<arguments.length;e++)c.push(helpers.wrapJsObject(arguments[e]));j.updateWorld(function(e,j){var m=[e].concat(c);y(b,m,j)},function(){})})},V=function(b,c){types.isJsObject(b)?c(b.obj):types.isRenderEffect(b)?
b.callImplementation(y,function(b){V(b,c)}):types.isPair(b)?V(b.first(),function(e){V(b.rest(),function(b){c(types.cons(e,b))})}):c(b)},$=types.isPair;j.printWorldHook=function(b,c){var e;null==c.lastChild?(e=types.toDomNode(b),c.appendChild(e)):(e=types.toDomNode(b),c.replaceChild(e,c.lastChild));helpers.maybeCallAfterAttach(e)};var S=function(b,c,e){var j=function(b,c){throw types.schemeError(types.incompleteExn(types.exnFailContract,helpers.format(b,c),[]));};if(!F.isPage(b))if(types.isPair(b)){var m=
b.first(),e=b.rest();"undefined"!=typeof m.nodeType||j("on-draw: expected a dom-element, but received ~s instead, the first element within ~s",[m,c]);m.nodeType==Node.TEXT_NODE&&!e.isEmpty()&&j("on-draw: the text node ~s must not have children.  It has ~s",[m,e]);for(c=2;!e.isEmpty();)S(e.first(),b,c),e=e.rest(),c++}else m="on-draw: expected a dom-s-expression, but received ~s instead",b=[b],void 0!=e&&(m+=", the ~a element within ~s",b.push(helpers.ordinalize(e)),b.push(c)),j(m+".",b)},ya=function(b,
c,e){b.addEventListener?b.addEventListener(c,e,!1):b.attachEvent("on"+c,e,!1);return function(){aa(b,c,e)}},aa=function(b,c,e){b.addEventListener?b.removeEventListener(c,e,!1):b.detachEvent("on"+c,e,!1)};j.bigBang=function(na,da,C,X,ga){c(X);I(ga);e(function(c){aa(da,"click",ta);q(function(){b();u();z(c)})});var ka=types.EMPTY;da.tabIndex=0;var ta=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;return!1};ya(da,"click",ta);[].push(function(){aa(da,
"click",ta)});for(var Z=new world.config.WorldConfig,X=0;X<C.length;X++)$(C[X])||C[X]===types.EMPTY?ka=C[X]:"function"==typeof C[X]?Z=C[X](Z):types.isWorldConfig(C[X])&&(C[X].startupArgs=helpers.map(L,C[X].startupArgs),m.push(C[X]));Z=Z.updateAll({changeWorld:j.updateWorld,shutdownWorld:j.shutdownWorld});new world.stimuli.StimuliHandler(Z,y,z);var ca=[],ha=[];if(Z.lookup("onDraw"))C=function(b,c){try{y(Z.lookup("onDraw"),[b],function(b){V(b,function(b){S(b,b,void 0);b=[da,helpers.deepListToArray(b)];
c(b)})})}catch(e){Y(e)}},X=Z.lookup("onDrawCss")?function(b,c){try{y(Z.lookup("onDrawCss"),[b],function(b){b=helpers.deepListToArray(b);c(b)})}catch(e){Y(e)}}:function(b,c){c([])},ca.push(F.on_draw(C,X));else if(Z.lookup("onRedraw")){var W=void 0,K=void 0;ca.push(F.on_draw(function(b,c){window.requestAnimationFrame(function(e){ha=[e/1E3].concat(ha);ha=ha.slice(0,3);3===ha.length&&console.log(Math.round(3/(ha[0]-ha[2]))+"fps");try{b=F.getCurrentWorld(),y(Z.lookup("onRedraw"),[b],function(b){if(world.Kernel.isImage(b)){var e=
b.getWidth(),j=b.getHeight();W||(W=world.Kernel.makeCanvas(e,j),W.jsworldOpaque=!0,K=F.node_to_tree(W));setTimeout(function(){W.width=e;W.height=j;var c=W.getContext("2d");b.render(c,0,0);c=document.createElement("span");c.className="screenreader-only";c.appendChild(document.createTextNode(b.ariaText));da.appendChild(c)},0);c([da,K])}else Y("to-draw handler: is expected to return a scene or image")})}catch(j){Y(j)}})},function(b,c){c([[W,["width",W.width+"px"],["height",W.height+"px"]]])}))}else ca.push(F.on_world_change(function(b,
c){j.printWorldHook(b,da);c()}));Z.lookup("tickDelay")&&(C=jsnums.toFixnum(Z.lookup("tickDelay")),ca.push(F.on_tick(C,function(b,c){y(Z.lookup("onTick"),[b],c)})));Z.lookup("stopWhen")&&ca.push(F.stop_when(function(b,c){y(Z.lookup("stopWhen"),[b],function(b){c(b)})},void 0,function(b){lastPictureCss=function(b,c){c([[W,["width",W.width+"px"],["height",W.height+"px"]]])};return F.on_draw(function(){try{Z.lookup("lastPicture")&&(b=F.getCurrentWorld(),y(Z.lookup("lastPicture"),[b],function(b){world.Kernel.isImage(b)?
setTimeout(function(){W.width=b.getWidth();W.height=b.getHeight();var c=W.getContext("2d");b.render(c,0,0)},0):Y("stop-when handler: is expected to return a scene or image")}))}catch(c){Y(c)}},lastPictureCss)()}));Z.lookup("onKey")&&(ca.push(F.on_key(function(b,c,e){c="keydown"===c.type?helpers.getKeyCodeName(c):String.fromCharCode(c.which).replace(/[^\x00-\xFE]+/g,"");y(Z.lookup("onKey"),[b,c],e)})),da.focus());var N=!1;Z.lookup("onMouse")&&(!Z.lookup("onRedraw")&&!Z.lookup("onDraw")&&Y("a mouse handler cannot be used without a draw handler"),
ca.push(F.on_mouse(function(b,c,e){"mousedown"===c.type&&(N=!0);if("mouseup"===c.type||"mouseleave"===c.type)N=!1;var j=c.pageX,m=c.pageY,g="mousedown"===c.type?"button-down":"mouseup"===c.type?"button-up":"mouseenter"===c.type?"enter":"mouseleave"===c.type?"leave":"mousemove"===c.type&&N?"drag":"mousemove"===c.type?"move":c.type,q=c.target;do j-=q.offsetLeft,m-=q.offsetTop,q=q.offsetParent;while(q);j=j*c.target.width/c.target.offsetWidth;scaledY=m*c.target.height/c.target.offsetHeight;y(Z.lookup("onMouse"),
[b,j,scaledY,g],e)})));Z.lookup("onTap")&&ca.push(F.on_tap(function(b,c,e){var j=c.pageX,m=c.pageY,c=c.target;do j-=c.offsetLeft,m-=c.offsetTop,c=c.offsetParent;while(c);y(Z.lookup("onTap"),[b,j,m],e)}));Z.lookup("onTilt")&&(ca.push(F.on_tilt(function(b,c,e,j){y(Z.lookup("onTilt"),[b,jsnums.makeFloat(c),jsnums.makeFloat(e)],j)})),da.focus());t(function(){F.big_bang(da,na,ca,helpers.assocListToHash(ka),B)});return{breaker:function(){Y(types.schemeError(types.incompleteExn(types.exnBreak,"user break",
[])))}}};var Y=function(b){console.log("handling error",b);world.stimuli.massShutdown();q(function(){types.isSchemeError(b)?(console.log(1),B(b)):types.isInternalError(b)?(console.log(2),B(b)):"string"==typeof b?(console.log(3),B(types.schemeError(types.incompleteExn(types.exnFail,b,[])))):b instanceof Error?(console.log(4),B(types.schemeError(types.incompleteExn(types.exnFail,b.message,[])))):(console.log(5),B(types.schemeError(b)))})};j.updateWorld=function(b,c){F.change_world(function(c,e){try{b(c,
e)}catch(j){Y(j)}},c)};j.shutdownWorld=function(){F.shutdown()};j.p=F.p;j.div=F.div;j.buttonBang=function(b,c,e){return F.button(function(c,e,j){try{y(b,[c],function(b){j(b)})}catch(m){Y(m)}},e)};j.input=function(b,c,e){return F.input(b,function(b,e,j){y(c,[b,e],j)},e)};j.get_dash_input_dash_value=function(b){return types.isString(b)?document.getElementById(b).value||"":b.value||""};j.img=F.img;j.text=F.text;j.select=function(b,c,e){return F.select(e,b,function(b,e,j){y(c,[b,e.target.value],j)})};
j.emptyPage=F.emptyPage;j.placeOnPage=function(b,c,e,j){b=types.toDomNode(V(b));return F.placeOnPage(b,c,e,j)}})();var primitive={};
(function(){function j(b,d,c,h){var b=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),e=b[b.length-1],b=e.first(),e=e.rest().first();h!==c&&(d=new types.Message([new types.ColoredPart(d,b),": expected a "+c+"-argument function as input, but given",new types.ColoredPart("a function",e),"of "+h+" arguments"]),C(types.incompleteExn(types.exnFailContract,d,[])))}var F,y,c={},b=types.PrimProc,z=types.CasePrimitive,I=function(b){return b},B=function(b,d){return d instanceof
types.ValuesWrapper?F(b,d.elts,I):F(b,[d],I)},e=function(c,d){l(c,d,k,"procedure-arity","function",1,[d]);var o=function(b){return b instanceof types.ContinuationClosureValue?types.arityAtLeast(0):b.isRest?types.arityAtLeast(b.numParams):b.numParams};if(d instanceof b||d instanceof types.ClosureValue||d instanceof types.ContinuationClosureValue)return o(d);var h;if(d instanceof z)h=d.cases;else if(d instanceof types.CaseLambdaValue)h=d.closures;else throw types.internalError("procedure-arity given wrong type that passed isFunction!",
!1);for(var e=[],g=0;g<h.length;g++)e.push(o(h[g]));e=u(e);return 1==e.length?e[0]:types.list(e)},u=function(b){b=b.splice(0);b.sort(function(b,d){return types.isArityAtLeast(b)&&types.isArityAtLeast(d)?types.arityValue(b)-types.arityValue(d):types.isArityAtLeast(b)?types.arityValue(b)-d-0.5:types.isArityAtLeast(d)?b-types.arityValue(d)+0.5:b-d});for(var d=0;d<b.length-1;d++)if(types.isArityAtLeast(b[d]))return b.splice(0,d+1);return b},m=helpers.procArityContains,t=function(b){for(var d=0;!b.isEmpty();b=
b.rest())d+=1;return d},q=function(b,d){if(0==d.length)return types.EMPTY;var c=d.slice(0,d.length-1),h=d[d.length-1];R(c,function(c,o){va(b,c,"append",o+1,d)});for(var e=c.length-1;0<=e;e--)h=c[e].append(h);return h},L=function(b,d,c){if(c[0].isEmpty())return d;for(var h=[],e=[],k=0;k<c.length;k++)h.push(c[k].first()),e.push(c[k].rest());h.push(d);return F(b,h,function(d){return L(b,d,e)})},V=function(i){return function(d,o,h){va(d,o,i,1,arguments);l(d,h,m(2),i,"procedure (arity 2)",2,arguments);
var e=function(d,i){if(i.isEmpty())return types.EMPTY;var o=new b("compYes",1,!1,!1,function(b,d){return F(h,[d,i.first()],I)}),k=new b("compNo",1,!1,!1,function(b,d){return F(h,[d,i.first()],function(b){return!b})}),g=new b("quicksort",1,!1,!1,e);return F(c.filter,[o,i.rest()],function(b){return F(g,[b],function(b){return F(c.filter,[k,i.rest()],function(c){return F(g,[c],function(c){return q(d,[b,types.list([i.first()]),c])})})})})};return e(d,o)}},$=function(b,d){for(var c=b[0],h=1;h<b.length;h++){if(!d(c,
b[h]))return!1;c=b[h]}return!0},S=function(b){var d;for(d=0;d<b.length;d++)if(!("a"<=b.charAt(d)&&"z">=b.charAt(d)||"A"<=b.charAt(d)&&"Z">=b.charAt(d)))return!1;return!0},ya=function(){var b=/^\s*$/;return function(d){return d.match(b)?!0:!1}}(),aa=types.Class.extend({init:function(b){this.name=b},configure:function(){throw types.internalError("unimplemented",!1);},toWrittenString:function(){return"("+this.name+" ...)"},toDisplayedString:this.toWrittenString,toDomNode:function(){var b=document.createElement("div");
b.appendChild(document.createTextNode(this.toWrittenString()));return b}}),Y=function(c,d,o){return function(h,e){j(h,c,o,e.numParams);return na(c,d)(h,e,new b("",o,!1,!1,function(){return types.EMPTY}))}},na=function(b,d){return function(c,h,e){l(c,h,k,b,"function",1,arguments);l(c,e,k,b,"function",2,arguments);return new (aa.extend({init:function(){this._super(b)},configure:function(b){var c={};c[d]=h;c[d+"Effect"]=e;return b.updateAll(c)}}))}},da=helpers.assocListToHash,C=helpers.raise,X=function(b){var d=
function(b){"undefined"!==typeof console&&console.log&&(console.log("There was an error in a procedure converted from scheme to javascript"),b.stack?console.log(b.stack):console.log(b));throw b;};return function(c,h,e){return interpret.call(b,c,h,e,d)}},ga=function(b,d){var c=function(d,c,o){return interpret.call(b,d,c,o,function(b){throw b;})};return function(b){for(var i=[],e=1;e<arguments.length;e++)i.push(arguments[e]);c(d,i,b)}},ka=function(c,d,o,h,e,k){b.call(this,d,o,h,e,k);this.typeName=c};
ka.prototype=b.prototype;var ta=function(){ka.apply(this,arguments)};ta.prototype=ka.prototype;var Z=function(){ka.apply(this,arguments)};Z.prototype=ka.prototype;var ca=function(){ka.apply(this,arguments)};ca.prototype=ka.prototype;var ha=function(){ka.apply(this,arguments)};ha.prototype=ka.prototype;var W=function(b){var d=b.name;return new types.ValuesWrapper([b,new ta(d,"make-"+d,b.numberOfArgs,!1,!1,function(d){return b.constructor.apply(null,[].slice.call(arguments,1))}),new Z(d,d+"?",1,!1,
!1,function(d,c){return b.predicate(c)}),new ca(d,d+"-ref",2,!1,!1,function(c,h,e){l(c,h,b.predicate,d+"-ref","struct:"+d,1,arguments);l(c,e,H,d+"-ref","non-negative exact integer",2,arguments);var k=b.numberOfFields;jsnums.greaterThanOrEqual(e,k)&&C(types.incompleteExn(types.exnFailContract,d+"-ref: slot index for <struct:"+d+"> not in [0, "+(k-1)+"]: "+e,[]));return b.accessor(h,jsnums.toFixnum(e))}),new ha(d,d+"-set!",3,!1,!1,function(c,h,e,k){l(c,h,b.predicate,d+"-set!","struct:"+d,1,arguments);
l(c,e,H,d+"-set!","non-negative exact integer",2,arguments);var g=b.numberOfFields;jsnums.greaterThanOrEqual(e,g)&&C(types.incompleteExn(types.exnFailContract,d+"-set!: slot index for <struct"+d+"> not in [0, "+(g-1)+"]: "+e,[]));b.mutator(h,jsnums.toFixnum(e),k)})])},K=jsnums.isSchemeNumber,N=jsnums.isReal,Ba=jsnums.isRational,p=jsnums.isInteger,H=function(b){return jsnums.isExact(b)&&p(b)&&jsnums.greaterThanOrEqual(b,0)},M=function(b){return N(b)&&jsnums.greaterThanOrEqual(b,0)},G=function(b){return N(b)&&
!(jsnums.equals(b,jsnums.inf)||jsnums.equals(b,jsnums.negative_inf))},g=function(b){return p(b)&&jsnums.greaterThanOrEqual(b,3)},T=function(b){return p(b)&&jsnums.greaterThanOrEqual(b,1)},fa=types.isSymbol,ba=types.isChar,D=types.isString,P=types.isPair,ra=helpers.isList,ua=helpers.isListOf,oa=types.isVector,Fa=types.isBox,ia=types.isHash,za=types.isByteString,pa=function(b){return H(b)&&jsnums.lessThanOrEqual(b,255)},qa=function(b){return!0===b||!1===b},k=types.isFunction,w=function(b,d){return types.isEqual(b,
d,new types.UnionFind)},Sa=function(b,d){return K(b)&&K(d)?jsnums.eqv(b,d):ba(b)&&ba(d)?b.val===d.val:b===d},O=world.Kernel.isImage,U=world.Kernel.isScene,ea=world.Kernel.isColor,la=world.Kernel.nameToColor,wa=function(b){return(D(b)||fa(b))&&("default"==b.toString().toLowerCase()||"decorative"==b.toString().toLowerCase()||"roman"==b.toString().toLowerCase()||"script"==b.toString().toLowerCase()||"swiss"==b.toString().toLowerCase()||"modern"==b.toString().toLowerCase()||"symbol"==b.toString().toLowerCase()||
"system"==b.toString().toLowerCase())||!b},sa=function(b){return(D(b)||fa(b))&&("normal"==b.toString().toLowerCase()||"italic"==b.toString().toLowerCase()||"slant"==b.toString().toLowerCase())||!b},v=function(b){return(D(b)||fa(b))&&("normal"==b.toString().toLowerCase()||"bold"==b.toString().toLowerCase()||"light"==b.toString().toLowerCase())||!b},E=world.Kernel.colorDb,ma=function(b){return(D(b)||fa(b))&&("solid"==b.toString().toLowerCase()||"outline"==b.toString().toLowerCase())||N(b)&&jsnums.greaterThanOrEqual(b,
0)&&jsnums.lessThanOrEqual(b,255)},Ka=function(b){return(D(b)||fa(b))&&("left"==b.toString().toLowerCase()||"right"==b.toString().toLowerCase()||"center"==b.toString().toLowerCase()||"middle"==b.toString().toLowerCase())},Xa=function(b){return(D(b)||fa(b))&&("top"==b.toString().toLowerCase()||"bottom"==b.toString().toLowerCase()||"baseline"==b.toString().toLowerCase()||"center"==b.toString().toLowerCase()||"middle"==b.toString().toLowerCase())},Ea=function(b){var d;if(d=P(b))if(d=P(b.rest()))d=b.rest().rest()===
types.EMPTY;return d},fb=function(b){return-1<"button-down,button-up,drag,move,enter,leave".split(",").indexOf(b)},$a=function(b){return types.isEffect(b)||ua(b,$a)},Ia=types.isJsObject,Ja=function(b){return Ia(b)&&"function"==typeof b.obj},R=function(b,d){for(var c=0;c<b.length;c++)d.call(null,b[c],c)},l=helpers.check,xa=helpers.checkVarArity,va=function(b,d,c,h,e){ra(d)||helpers.throwCheckError(b,{functionName:c,typeName:"list",ordinalPosition:helpers.ordinalize(h),actualValue:d},h,e)},Aa=helpers.checkListOf,
Ua=function(b,d,c,h,e,k){(!ra(d)||t(d)<c)&&helpers.throwCheckError(b,{functionName:h,typeName:"list with "+c+" or more elements",ordinalPosition:helpers.ordinalize(e),actualValue:d},e,k)},Za=function(b,d,c,h){if(0!==d.length){var e=t(d[0]);R(d,function(b){t(b)!=e&&(b=helpers.map(function(){return" ~s"},h).join(""),b=helpers.format(c+": all lists must have the same size; arguments were:"+b,h),C(types.incompleteExn(types.exnFailContract,b,[])))})}},cb=function(b){window.plt&&window.plt.wescheme&&plt.wescheme.WeSchemeIntentBus?
(b=b.substring(0,20)+"..."+b.substring(b.length-20),plt.wescheme.WeSchemeIntentBus.notify("load-file",b)):console.log("Loading from "+b)};c["verify-boolean-branch-value"]=new b("verify-boolean-branch-value",4,!1,!1,function(b,d,c,h,e){!0!==h&&!1!==h&&(state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(d,c),": expected a boolean value, but found: ",new types.ColoredPart(types.toWrittenString(h),
e)]),[])));return h});c["throw-cond-exhausted-error"]=new b("throw-cond-exhausted-error",1,!1,!1,function(b,d){C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("cond",d),": all question results were false"]),[]))});c["print-values"]=new b("print-values",0,!0,!1,function(b,d){for(var c=!1,h=0;h<d.length;h++)d[h]!==types.VOID&&(b.getPrintHook()(d[h]),c=!0);c&&b.getDisplayHook()("\n");return types.VOID});c["check-expect"]=new b("check-expect",2,!1,!1,function(b,d,
c){(k(d)||k(c))&&C(types.incompleteExn(types.exnFailContract,"check-expect cannot compare functions",[]));if(!w(d,c)){d=helpers.format("check-expect: actual value ~s differs from ~s, the expected value.\n",[d,c]);b.getDisplayHook()(d);d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));for(c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]))}return types.VOID});c.EXAMPLE=new b("EXAMPLE",2,!1,!1,function(b,d,c){if(k(d)||k(c)){var h;C(types.incompleteExn(types.exnFailContract,
"EXAMPLE cannot compare functions",[]))}if(!w(d,c)){h="EXAMPLE failed: ";h="<image>"===types.toWrittenString(d)&&"<image>"===types.toWrittenString(c)?h+"Expected the two <image>s to match.":h+helpers.format("Got ~s, but expected ~s.\n",[d,c]);b.getDisplayHook()(h);d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));for(c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]))}return types.VOID});c["check-within"]=new b("check-within",3,!1,!1,function(b,d,
c,h){if(!M(h)){var e=helpers.format("check-within requires a non-negative real number for range, but given ~s.",[h]);C(types.incompleteExn(types.exnFailContract,e,[]))}(k(d)||k(c))&&C(types.incompleteExn(types.exnFailContract,"check-within cannot compare functions",[]));if(!(w(d,c)||N(d)&&N(c)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),h))){e=helpers.format("check-within: actual value ~s is not within ~s of expected value ~s.",[d,h,c]);b.getDisplayHook()(e);d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));
for(c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]))}return types.VOID});var gb=new b("print",1,!1,!1,function(b,d){b.getPrintHook()(types.toWrittenString(d));return types.VOID});c.write=new z("write",[new b("write",1,!1,!1,function(b,d){b.getPrintHook()(d);return types.VOID}),new b("write",2,!1,!0,function(b){throw types.internalError("write to a port not implemented yet.",state.captureCurrentContinuationMarks(b));})]);c.display=new z("display",[new b("display",1,!1,!1,function(b,
d){b.getDisplayHook()(types.toDisplayedString(d));return types.VOID}),new b("display",2,!1,!0,function(b){throw types.internalError("display to a port not implemented yet.",state.captureCurrentContinuationMarks(b));})]);c.newline=new z("newline",[new b("newline",0,!1,!0,function(b){b.getDisplayHook()("\n");b.v=types.VOID}),new b("newline",1,!1,!1,function(b){throw types.internalError("newline to a port not implemented yet.",state.captureCurrentContinuationMarks(b));})]);c["current-print"]=new b("current-print",
0,!1,!1,function(){return gb});c["current-continuation-marks"]=new b("current-continuation-marks",0,!1,!1,function(b){return state.captureCurrentContinuationMarks(b)});c["continuation-mark-set->list"]=new b("continuation-mark-set->list",2,!1,!1,function(b,d,c){l(b,d,types.isContinuationMarkSet,"continuation-mark-set->list","continuation-mark-set",1,[d,c]);return types.list(d.ref(c))});c["for-each"]=new b("for-each",2,!0,!1,function(b,d,c,h){var e=[d,c].concat(h);h.unshift(c);l(b,d,k,"for-each","function",
1,e);R(h,function(d,c){va(b,d,"for-each",c+2,e)});Za(b,h,"for-each",e);var g=function(b){if(b[0].isEmpty())return types.VOID;for(var c=[],i=[],o=0;o<b.length;o++)c.push(b[o].first()),i.push(b[o].rest());return F(d,c,function(){return g(i)})};return g(h)});c["make-thread-cell"]=new z("make-thread-cell",[new b("make-thread-cell",1,!1,!1,function(b,d){return new types.ThreadCell(d,!1)}),new b("make-thread-cell",2,!1,!1,function(b,d,c){return new types.ThreadCell(d,c)})]);c["make-continuation-prompt-tag"]=
new z("make-continuation-prompt-tag",[new b("make-continuation-prompt-tag",0,!1,!1,function(){return new types.ThreadCell}),new b("make-continuation-prompt-tag",1,!1,!1,function(b,d){return new types.ThreadCell(d)})]);var Wa=function(c,d,o,h,e){for(var k=function(k){return new b(c,d+k,!1,h,function(b){assert.equal(arguments.length,d+k+1);for(var c=[arguments],i=0;i<arguments.length;i++)c.push(arguments[i]);return e.apply(e,c.concat(o.slice(i-d-1)))})},g=[],l=0;l<=o.length;l++)g.push(k(l));return new z(c,
g)};c["make-struct-type"]=Wa("make-struct-type",4,[!1,types.EMPTY,types.symbol("prefab"),!1,types.EMPTY,!1],!1,function(b,d,c,h,e,g,j,w,p,q,t,u){l(d,c,fa,"make-struct-type","symbol",1,b);l(d,h,function(b){return!1===b||types.isStructType(b)},"make-struct-type","struct-type or #f",2,b);l(d,e,H,"make-struct-type","exact non-negative integer",3,b);l(d,g,H,"make-struct-type","exact non-negative integer",4,b);Aa(d,t,H,"make-struct-type","exact non-negative integer",9,b);l(d,u,function(b){return!1===b||
k(b)},"make-struct-type","procedure or #f",10,b);b=e+1+(h?h.numberOfArgs:0);u&&!m(b)(u)&&C(types.incompleteExn(types.exnFailContract,helpers.format("make-struct-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,u]),[]));d=u?ga(d,u):!1;c=types.makeStructureType(c.toString(),h,jsnums.toFixnum(e),jsnums.toFixnum(g),j,d);return W(c)});c["make-struct-field-accessor"]=Wa("make-struct-field-accessor",2,[!1],!1,function(b,d,c,h,e){l(d,c,function(b){return b instanceof
ca&&1<b.numParams},"make-struct-field-accessor","accessor procedure that requires a field index",1,b);l(d,h,H,"make-struct-field-accessor","exact non-negative integer",2,b);l(d,e,function(b){return!1===b||fa(b)},"make-struct-field-accessor","symbol or #f",3,b);var k=jsnums.toFixnum(h);return new ca(c.typeName,c.typeName+"-"+(e?e.toString():"field"+k),1,!1,!1,function(b,d){return c.impl(b,d,k)})});c["make-struct-field-mutator"]=Wa("make-struct-field-mutator",2,[!1],!1,function(b,d,c,h,e){l(d,c,function(b){return b instanceof
ha&&1<b.numParams},"make-struct-field-mutator","mutator procedure that requires a field index",1,b);l(d,h,H,"make-struct-field-mutator","exact non-negative integer",2,b);l(d,e,function(b){return!1===b||fa(b)},"make-struct-field-mutator","symbol or #f",3,b);var k=jsnums.toFixnum(h);return new ha(c.typeName,c.typeName+"-"+(e?e.toString():"field"+k),2,!1,!1,function(b,i){return c.impl(d,b,k,i)})});c["struct-type?"]=new b("struct-type?",1,!1,!1,function(b,d){return types.isStructType(d)});c["struct-constructor-procedure?"]=
new b("struct-constructor-procedure?",1,!1,!1,function(b,d){return d instanceof ta});c["struct-predicate-procedure?"]=new b("struct-predicate-procedure?",1,!1,!1,function(b,d){return d instanceof Z});c["struct-accessor-procedure?"]=new b("struct-accessor-procedure?",1,!1,!1,function(b,d){return d instanceof ca});c["struct-mutator-procedure?"]=new b("struct-mutator-procedure?",1,!1,!1,function(b,d){return d instanceof ha});c["procedure-arity"]=new b("procedure-arity",1,!1,!1,function(b,d){return e(b,
d)});c.apply=new b("apply",2,!0,!1,function(b,d,c,h){var e=[d,c].concat(h);l(b,d,k,"apply","function",1,e);h.unshift(c);c=h.pop();va(b,c,"apply",h.length+2,e);h=h.concat(helpers.schemeListToArray(c));return F(d,h,I)});c.values=new b("values",0,!0,!1,function(b,d){return 1===d.length?d[0]:new types.ValuesWrapper(d)});c["call-with-values"]=new b("call-with-values",2,!1,!1,function(b,d,c){l(b,d,m(0),"call-with-values","procedure (arity 0)",1,arguments);l(b,c,k,"call-with-values","function",2,arguments);
return F(d,[],function(b){return B(c,b)})});c.compose=new b("compose",0,!0,!1,function(i,d){R(d,function(b,c){l(i,b,k,"compose","function",c+1,d)});if(0==d.length)return c.values;var o=types.list(d).reverse(),h=function(d,c){return c.isEmpty()?d:F(new b("",1,!1,!1,function(b,d){return B(c.first(),d)}),[d],function(b){return h(b,c.rest())})};return new b("",0,!0,!1,function(b,d){return 1===d.length?h(d[0],o):h(new types.ValuesWrapper(d),o)})});c["current-inexact-milliseconds"]=new b("current-inexact-milliseconds",
0,!1,!1,function(){return jsnums.makeFloat((new Date).valueOf())});c["current-seconds"]=new b("current-seconds",0,!1,!1,function(){return Math.floor((new Date).getTime()/1E3)});c.not=new b("not",1,!1,!1,function(b,d){return!1===d});c["void"]=new b("void",0,!0,!1,function(){return types.VOID});c.random=new z("random",[new b("random",0,!1,!1,function(){return types["float"](Math.random())}),new b("random",1,!1,!1,function(b,d){l(b,d,H,"random","non-negative exact integer",1,arguments);return Math.floor(Math.random()*
jsnums.toFixnum(d))})]);c.sleep=new z("sleep",[new b("sleep",0,!1,!1,function(){return types.VOID}),new b("sleep",1,!1,!1,function(b,d){l(b,d,M,"sleep","non-negative real number",1);var c=jsnums.toFixnum(jsnums.multiply(d,1E3));return y(function(b){setTimeout(function(){b(types.VOID)},c)})})]);c.identity=new b("identity",1,!1,!1,function(b,d){return d});c.raise=new b("raise",1,!1,!1,function(b,d){return C(d)});c.error=new b("error",1,!0,!0,function(b,d,c){var h=[d].concat(c);l(b,d,function(b){return fa(b)||
D(b)},"error","symbol or string",1,h);if(fa(d)){0===c.length&&C(types.incompleteExn(types.exnFail,"error: "+d.val,[]));var e=c.shift();l(b,e,D,"error","string",2,h);c.unshift(d);C(types.incompleteExn(types.exnFail,helpers.format("~s: "+e.toString(),c),[]))}else{b=[d.toString()];for(d=0;d<c.length;d++)b.push(types.toWrittenString(c[d]));C(types.incompleteExn(types.exnFail,b.join(""),[]))}});c["make-exn"]=new b("make-exn",2,!1,!1,function(b,d,c){return types.exn(d,c)});c["exn-message"]=new b("exn-message",
1,!1,!1,function(b,d){l(b,d,types.isExn,"exn-message","exn",1,[d]);return""+types.exnMessage(d)});c["exn-continuation-marks"]=new b("exn-continuation-marks",1,!1,!1,function(b,d){l(b,d,types.isExn,"exn-continuation-marks","exn",1,[d]);return types.exnContMarks(d)});c["make-exn:fail"]=new b("make-exn:fail",2,!1,!1,function(b,d,c){return types.exnFail(d,c)});c["make-exn:fail:contract"]=new b("make-exn:fail:contract",2,!1,!1,function(b,d,c){return types.exnFailContract(d,c)});c["make-exn:fail:contract:division-by-zero"]=
new b("make-exn:fail:contract:division-by-zero",2,!1,!1,function(b,d,c){return types.exnFailContractDivisionByZero(d,c)});c["*"]=new b("*",0,!0,!1,function(b,d){R(d,function(c,o){l(b,c,K,"*","number",o+1,d)});var c=types.rational(1),h;for(h=0;h<d.length;h++)c=jsnums.multiply(d[h],c);return c});c["-"]=new b("-",1,!0,!1,function(b,d,c){var h=[d].concat(c);l(b,d,K,"-","number",1,h);R(c,function(d,c){l(b,d,K,"-","number",c+2,h)});if(0==c.length)return jsnums.subtract(0,d);for(var e=0;e<c.length;e++)d=
jsnums.subtract(d,c[e]);return d});c["+"]=new b("+",0,!0,!1,function(b,d){R(d,function(c,o){l(b,c,K,"+","number",o+1,d)});if(0==d.length)return 0;for(var c=d[0],h=1;h<d.length;h++)c=jsnums.add(c,d[h]);return c});c["="]=new b("=",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,K,"=","number",c+1,h)});return $(h,jsnums.equals)});c["=~"]=new b("=~",3,!1,!1,function(b,d,c,h){l(b,d,N,"=~","real",1,arguments);l(b,c,N,"=~","real",2,arguments);l(b,h,M,"=~","non-negative-real",
3,arguments);return jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),h)});c["/"]=new b("/",2,!0,!1,function(b,d,c,h){var e=[d,c].concat(h);R(e,function(d,c){l(b,d,K,"/","number",c+1,e)});var k=function(d){var c,o,h,e,k;try{o=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");h=o[o.length-1];e=h.first();h=h.rest();for(c=0;c<d;c++)h=h.rest();k=new types.Message([new types.ColoredPart("/",e),": cannot divide by ",new types.ColoredPart("zero",h.first())])}catch(g){k=
new types.Message(["/: cannot divide by zero"])}C(types.incompleteExn(types.exnFailContractDivisionByZero,k,[]))};jsnums.equals(c,0)&&k(1);d=jsnums.divide(d,c);for(c=0;c<h.length;c++)jsnums.equals(h[c],0)&&k(2+c),d=jsnums.divide(d,h[c]);return d});c.sub1=new b("sub1",1,!1,!1,function(b,d){l(b,d,K,"sub1","number",1,arguments);return jsnums.subtract(d,1)});c.add1=new b("add1",1,!1,!1,function(b,d){l(b,d,K,"add1","number",1,arguments);return jsnums.add(d,1)});c["<"]=new b("<",2,!0,!1,function(b,d,c,
h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,K,"<","number",c+1,h)});return $(h,jsnums.lessThan)});c[">"]=new b(">",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,K,">","number",c+1,h)});return $(h,jsnums.greaterThan)});c["<="]=new b("<=",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,K,"<=","number",c+1,h)});return $(h,jsnums.lessThanOrEqual)});c[">="]=new b(">=",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,
d,K,">=","number",c+1,h)});return $(h,jsnums.greaterThanOrEqual)});c.abs=new b("abs",1,!1,!1,function(b,d){l(b,d,N,"abs","real",1);return jsnums.abs(d)});c.quotient=new b("quotient",2,!1,!1,function(b,d,c){l(b,d,p,"quotient","integer",1,arguments);l(b,c,p,"quotient","integer",2,arguments);return jsnums.quotient(d,c)});c.remainder=new b("remainder",2,!1,!1,function(b,d,c){l(b,d,p,"remainder","integer",1,arguments);l(b,c,p,"remainder","integer",2,arguments);return jsnums.remainder(d,c)});c.modulo=new b("modulo",
2,!1,!1,function(b,d,c){l(b,d,p,"modulo","integer",1,arguments);l(b,c,p,"modulo","integer",2,arguments);return jsnums.modulo(d,c)});c.max=new b("max",1,!0,!1,function(b,d,c){c.unshift(d);R(c,function(d,h){l(b,d,N,"max","real",h+1,c)});for(var h=1;h<c.length;h++)jsnums.greaterThan(c[h],d)&&(d=c[h]);return d});c.min=new b("min",1,!0,!1,function(b,d,c){c.unshift(d);R(c,function(d,h){l(b,d,N,"min","real",h+1,c)});for(var h=1;h<c.length;h++)jsnums.lessThan(c[h],d)&&(d=c[h]);return d});c.gcd=new b("gcd",
1,!0,!1,function(b,d,c){var h=[d].concat(c);l(b,d,p,"gcd","integer",1,h);R(c,function(d,c){l(b,d,p,"gcd","integer",c+2,h)});return jsnums.gcd(d,c)});c.lcm=new b("lcm",1,!0,!1,function(b,d,c){var h=[d].concat(c);l(b,d,p,"lcm","integer",1,h);R(c,function(d,c){l(b,d,p,"lcm","integer",c+2,h)});return jsnums.lcm(d,c)});c.floor=new b("floor",1,!1,!1,function(b,d){l(b,d,N,"floor","real",1);return jsnums.floor(d)});c.ceiling=new b("ceiling",1,!1,!1,function(b,d){l(b,d,N,"ceiling","real",1);return jsnums.ceiling(d)});
c.round=new b("round",1,!1,!1,function(b,d){l(b,d,N,"round","real",1);return jsnums.round(d)});c.numerator=new b("numerator",1,!1,!1,function(b,d){l(b,d,Ba,"numerator","rational number",1);return jsnums.numerator(d)});c.denominator=new b("denominator",1,!1,!1,function(b,d){l(b,d,Ba,"denominator","rational number",1);return jsnums.denominator(d)});c.expt=new b("expt",2,!1,!1,function(b,d,c){l(b,d,K,"expt","number",1,arguments);l(b,c,K,"expt","number",2,arguments);return jsnums.expt(d,c)});c.exp=new b("exp",
1,!1,!1,function(b,d){l(b,d,K,"exp","number",1);return jsnums.exp(d)});c.log=new b("log",1,!1,!1,function(b,d){l(b,d,K,"log","number",1);return jsnums.log(d)});c.sin=new b("sin",1,!1,!1,function(b,d){l(b,d,K,"sin","number",1);return jsnums.sin(d)});c.cos=new b("cos",1,!1,!1,function(b,d){l(b,d,K,"cos","number",1);return jsnums.cos(d)});c.tan=new b("tan",1,!1,!1,function(b,d){l(b,d,K,"tan","number",1);return jsnums.tan(d)});c.asin=new b("asin",1,!1,!1,function(b,d){l(b,d,K,"asin","number",1);return jsnums.asin(d)});
c.acos=new b("acos",1,!1,!1,function(b,d){l(b,d,K,"acos","number",1);return jsnums.acos(d)});c.atan=new b("atan",1,!1,!1,function(b,d){l(b,d,K,"atan","number",1);return jsnums.atan(d)});c.sinh=new b("sinh",1,!1,!1,function(b,d){l(b,d,K,"sinh","number",1);return jsnums.sinh(d)});c.cosh=new b("cosh",1,!1,!1,function(b,d){l(b,d,K,"cosh","number",1);return jsnums.cosh(d)});c.sqr=new b("sqr",1,!1,!1,function(b,d){l(b,d,K,"sqr","number",1);return jsnums.sqr(d)});c.sqrt=new b("sqrt",1,!1,!1,function(b,d){l(b,
d,K,"sqrt","number",1);return jsnums.sqrt(d)});c["integer-sqrt"]=new b("integer-sqrt",1,!1,!1,function(b,d){l(b,d,p,"integer-sqrt","integer",1);return jsnums.integerSqrt(d)});c["make-rectangular"]=new b("make-rectangular",2,!1,!1,function(b,d,c){l(b,d,N,"make-rectangular","real",1,arguments);l(b,c,N,"make-rectangular","real",2,arguments);return types.complex(d,c)});c["make-polar"]=new b("make-polar",2,!1,!1,function(b,d,c){l(b,d,N,"make-polar","real",1,arguments);l(b,c,N,"make-polar","real",2,arguments);
return jsnums.makeComplexPolar(d,c)});c["real-part"]=new b("real-part",1,!1,!1,function(b,d){l(b,d,K,"real-part","number",1);return jsnums.realPart(d)});c["imag-part"]=new b("imag-part",1,!1,!1,function(b,d){l(b,d,K,"imag-part","number",1);return jsnums.imaginaryPart(d)});c.angle=new b("angle",1,!1,!1,function(b,d){l(b,d,K,"angle","number",1);return jsnums.angle(d)});c.magnitude=new b("magnitude",1,!1,!1,function(b,d){l(b,d,K,"magnitude","number",1);return jsnums.magnitude(d)});c.conjugate=new b("conjugate",
1,!1,!1,function(b,d){l(b,d,K,"conjugate","number",1);return jsnums.conjugate(d)});c.sgn=new b("sgn",1,!1,!1,function(b,d){l(b,d,N,"sgn","real number",1);return jsnums.greaterThan(d,0)?1:jsnums.lessThan(d,0)?-1:0});c["inexact->exact"]=new b("inexact->exact",1,!1,!1,function(b,d){l(b,d,K,"inexact->exact","number",1);try{return jsnums.toExact(d)}catch(c){C(types.exnFailContract("inexact->exact: no exact representation for "+types.toWrittenString(d),!1))}});c["exact->inexact"]=new b("exact->inexact",
1,!1,!1,function(b,d){l(b,d,K,"exact->inexact","number",1);return jsnums.toInexact(d)});c["number->string"]=new b("number->string",1,!1,!1,function(b,d){l(b,d,K,"number->string","number",1);return types.string(d+"")});c["string->number"]=new b("string->number",1,!1,!1,function(b,d){l(b,d,D,"string->number","string",1);var c=jsnums.fromString(d);return c?jsnums.toExact(c):c});c["xml->s-exp"]=new b("xml->s-exp",1,!1,!1,function(b,d){l(b,d,D,"xml->s-exp","string",1);if(0==d.length)return types.string("");
var c;try{c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(s)}catch(h){c=(new DOMParser).parseFromString(s,"text/xml")}var e=function(b){for(var d=types.EMPTY,c=0;c<b.length;c++)var i=types.cons(types.symbol(b.item(c).nodeName),types.cons(b.item(c).nodeValue,types.EMPTY)),d=types.cons(i,d);return types.cons(types.symbol("@"),d).reverse()},k=function(b){if(b.nodeType==Node.ELEMENT_NODE){for(var d=types.EMPTY,c=b.firstChild;null!=c;)var i=k(c),d=D(i)&&!d.isEmpty()&&D(d.first())?types.cons(d.first()+
i,d.rest()):types.cons(i,d),c=c.nextSibling;d=d.reverse();d=types.cons(e(b.attributes),d);return d=types.cons(types.symbol(b.nodeName),d)}return b.nodeType==Node.TEXT_NODE?b.textContent:b.nodeType==Node.CDATA_SECTION_NODE?b.data:types.EMPTY};return k(c.firstChild)});c["procedure?"]=new b("procedure?",1,!1,!1,function(b,d){return k(d)});c["pair?"]=new b("pair?",1,!1,!1,function(b,d){return P(d)});c["cons?"]=new b("cons?",1,!1,!1,function(b,d){return P(d)});c["empty?"]=new b("empty?",1,!1,!1,function(b,
d){return d===types.EMPTY});c["null?"]=new b("null?",1,!1,!1,function(b,d){return d===types.EMPTY});c["undefined?"]=new b("undefined?",1,!1,!1,function(b,d){return d===types.UNDEFINED});c["void?"]=new b("void?",1,!1,!1,function(b,d){return d===types.VOID});c["symbol?"]=new b("symbol?",1,!1,!1,function(b,d){return fa(d)});c["string?"]=new b("string?",1,!1,!1,function(b,d){return D(d)});c["char?"]=new b("char?",1,!1,!1,function(b,d){return ba(d)});c["boolean?"]=new b("boolean?",1,!1,!1,function(b,d){return qa(d)});
c["vector?"]=new b("vector?",1,!1,!1,function(b,d){return oa(d)});c["struct?"]=new b("struct?",1,!1,!1,function(b,d){return types.isStruct(d)});c["eof-object?"]=new b("eof-object?",1,!1,!1,function(b,d){return d===types.EOF});c["color?"]=new b("color?",1,!1,!1,function(b,d){return types.isColor(d)});c["posn?"]=new b("posn?",1,!1,!1,function(b,d){return types.isPosn(d)});c["bytes?"]=new b("bytes?",1,!1,!1,function(b,d){return za(d)});c["byte?"]=new b("byte?",1,!1,!1,function(b,d){return pa(d)});c["number?"]=
new b("number?",1,!1,!1,function(b,d){return K(d)});c["complex?"]=new b("complex?",1,!1,!1,function(b,d){return K(d)});c["real?"]=new b("real?",1,!1,!1,function(b,d){return N(d)});c["rational?"]=new b("rational?",1,!1,!1,function(b,d){return Ba(d)});c["integer?"]=new b("integer?",1,!1,!1,function(b,d){return p(d)});c["exact?"]=new b("exact?",1,!1,!1,function(b,d){l(b,d,K,"exact?","number",1);return jsnums.isExact(d)});c["inexact?"]=new b("inexact?",1,!1,!1,function(b,d){l(b,d,K,"inexact?","number",
1);return jsnums.isInexact(d)});c["odd?"]=new b("odd?",1,!1,!1,function(b,d){l(b,d,p,"odd?","integer",1);return jsnums.equals(jsnums.modulo(d,2),1)});c["even?"]=new b("even?",1,!1,!1,function(b,d){l(b,d,p,"even?","integer",1);return jsnums.equals(jsnums.modulo(d,2),0)});c["zero?"]=new b("zero?",1,!1,!1,function(b,d){l(b,d,K,"zero?","number",1);return jsnums.equals(0,d)});c["positive?"]=new b("positive?",1,!1,!1,function(b,d){l(b,d,N,"positive?","real",1);return jsnums.greaterThan(d,0)});c["negative?"]=
new b("negative?",1,!1,!1,function(b,d){l(b,d,N,"negative?","real",1);return jsnums.lessThan(d,0)});c["box?"]=new b("box?",1,!1,!1,function(b,d){return Fa(d)});c["hash?"]=new b("hash?",1,!1,!1,function(b,d){return ia(d)});c["eq?"]=new b("eq?",2,!1,!1,function(b,d,c){return d===c});c["eqv?"]=new b("eqv?",2,!1,!1,function(b,d,c){return Sa(d,c)});c["equal?"]=new b("equal?",2,!1,!1,function(b,d,c){return w(d,c)});c["equal~?"]=new b("equal~?",3,!1,!1,function(b,d,c,h){l(b,h,M,"equal~?","non-negative number",
3,arguments);return w(d,c)||N(d)&&N(c)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),h)});c["false?"]=new b("false?",1,!1,!1,function(b,d){return!1===d});c["boolean=?"]=new b("boolean=?",2,!1,!1,function(b,d,c){l(b,d,qa,"boolean=?","boolean",1,arguments);l(b,c,qa,"boolean=?","boolean",2,arguments);return d===c});c["symbol=?"]=new b("symbol=?",2,!1,!1,function(b,d,c){l(b,d,fa,"symbol=?","symbol",1,arguments);l(b,c,fa,"symbol=?","symbol",2,arguments);return w(d,c)});c["js-object?"]=new b("js-object?",
1,!1,!1,function(b,d){return Ia(d)});c.cons=new b("cons",2,!1,!1,function(b,d,c){return types.cons(d,c)});c.car=new b("car",1,!1,!1,function(b,d){l(b,d,P,"car","pair",1);return d.first()});c.cdr=new b("cdr",1,!1,!1,function(b,d){l(b,d,P,"cdr","pair",1);return d.rest()});c.caar=new b("caar",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.first())},"caar","caarable value",1);return d.first().first()});c.cadr=new b("cadr",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.rest())},"cadr",
"cadrable value",1);return d.rest().first()});c.cdar=new b("cdar",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.first())},"cdar","cdarable value",1);return d.first().rest()});c.cddr=new b("cddr",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.rest())},"cddr","cddrable value",1);return d.rest().rest()});c.caaar=new b("caaar",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.first())&&P(b.first().first())},"caaar","caaarable value",1);return d.first().first().first()});c.caadr=
new b("caadr",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.rest())&&P(b.rest().first())},"caadr","caadrable value",1);return d.rest().first().first()});c.cadar=new b("cadar",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.first())&&P(b.first().rest())},"cadar","cadarable value",1);return d.first().rest().first()});c.cdaar=new b("cdaar",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.first())&&P(b.first().first())},"cdaar","cdaarable value",1);return d.first().first().rest()});
c.cdadr=new b("cdadr",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.rest())&&P(b.rest().first())},"cdadr","cdadrable value",1);return d.rest().first().rest()});c.cddar=new b("cddar",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.first())&&P(b.first().rest())},"cddar","cddarable value",1);return d.first().rest().rest()});c.caddr=new b("caddr",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.rest())&&P(b.rest().rest())},"caddr","caddrable value",1);return d.rest().rest().first()});
c.cdddr=new b("cdddr",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.rest())&&P(b.rest().rest())},"cdddr","cdddrable value",1);return d.rest().rest().rest()});c.cadddr=new b("cadddr",1,!1,!1,function(b,d){l(b,d,function(b){return P(b)&&P(b.rest())&&P(b.rest().rest())&&P(b.rest().rest().rest())},"cadddr","cadddrable value",1);return d.rest().rest().rest().first()});c.rest=new b("rest",1,!1,!1,function(b,d){l(b,d,function(b){return ra(b)&&b!==types.EMPTY},"rest","non-empty list",1);return d.rest()});
c.first=new b("first",1,!1,!1,function(b,d){l(b,d,function(b){return ra(b)&&b!==types.EMPTY},"first","non-empty list",1);return d.first()});c.second=new b("second",1,!1,!1,function(b,d){Ua(b,d,2,"second",1);return d.rest().first()});c.third=new b("third",1,!1,!1,function(b,d){Ua(b,d,3,"third",1);return d.rest().rest().first()});c.fourth=new b("fourth",1,!1,!1,function(b,d){Ua(b,d,4,"fourth",1);return d.rest().rest().rest().first()});c.fifth=new b("fifth",1,!1,!1,function(b,d){Ua(b,d,5,"fifth",1);
return d.rest().rest().rest().rest().first()});c.sixth=new b("sixth",1,!1,!1,function(b,d){Ua(b,d,6,"sixth",1);return d.rest().rest().rest().rest().rest().first()});c.seventh=new b("seventh",1,!1,!1,function(b,d){Ua(b,d,7,"seventh",1);return d.rest().rest().rest().rest().rest().rest().first()});c.eighth=new b("eighth",1,!1,!1,function(b,d){Ua(b,d,8,"eighth",1);return d.rest().rest().rest().rest().rest().rest().rest().first()});c.length=new b("length",1,!1,!1,function(b,d){va(b,d,"length",1,arguments);
return jsnums.makeRational(t(d))});c["list?"]=new b("list?",1,!1,!1,function(b,d){return ra(d)});c.list=new b("list",0,!0,!1,function(b,d){return types.list(d)});c["make-list"]=new b("make-list",2,!1,!1,function(b,d,c){l(b,d,H,"make-list","non-negative exact integer",1,arguments);for(var h=[],e=0;e<d;e++)h.push(c);return types.list(h)});c.range=new b("range",3,!1,!1,function(b,d,c,h){l(b,d,K,"range","number",1,arguments);l(b,c,K,"range","number",2,arguments);l(b,h,K,"range","number",3,arguments);
var e=[];if(jsnums.lessThan(d,c)&&jsnums.greaterThan(h,0))for(var k=d;jsnums.lessThanOrEqual(k,c);k=jsnums.add(k,h))e.push(k);else if(jsnums.greaterThan(d,c)&&jsnums.lessThan(h,0))for(k=d;jsnums.greaterThanOrEqual(k,c);k=jsnums.add(k,h))e.push(k);return types.list(e)});c["list*"]=new b("list*",1,!0,!1,function(b,d,c){var h=[d].concat(c);if(0==c.length)return d;var e=c.pop();va(b,e,"list*",c.length+2,h);c.unshift(d);return q(b,[types.list(c),e])});c["list-ref"]=new b("list-ref",2,!1,!1,function(b,
d,c){va(b,d,"list-ref",1,arguments);l(b,c,H,"list-ref","non-negative exact integer",2,arguments);for(var h=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),h=h[h.length-1],e=d,k=jsnums.toFixnum(c),g=0;g<k;g++)(e.isEmpty()||e.rest().isEmpty())&&C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("list-ref",h.first()),": index ",new types.ColoredPart(k,h.rest().rest().first())," is too large for list: ",new types.ColoredPart(types.toWrittenString(d),
h.rest().first())]),[])),e=e.rest();return e.first()});c["list-tail"]=new b("list-tail",2,!1,!1,function(b,d,c){va(b,d,"list-tail",1,arguments);l(b,x,H,"list-tail","non-negative exact integer",2,arguments);for(var d=origList,h=jsnums.toFixnum(c),e=0;e<h;e++){if(d.isEmpty()){var k="list-tail: index "+h+" is too large for list: "+types.toWrittenString(origList);C(types.incompleteExn(types.exnFailContract,k,[]))}d=d.rest()}return d});c.append=new b("append",0,!0,!1,function(b,d){return q(b,d)});c.reverse=
new b("reverse",1,!1,!1,function(b,d){va(b,d,"reverse",1);return d.reverse()});c.map=new b("map",2,!0,!1,function(b,d,c,h){var e=[d,c].concat(h);h.unshift(c);l(b,d,k,"map","function",1,e);R(h,function(d,c){va(b,d,"map",c+2,e)});Za(b,h,"map",e);var g=function(b,d,c){if(d[0].isEmpty())return c.reverse();for(var i=[],o=[],h=0;h<d.length;h++)i.push(d[h].first()),o.push(d[h].rest());return F(b,i,function(d){return g(b,o,types.cons(d,c))})};return g(d,h,types.EMPTY)});c.andmap=new b("andmap",2,!0,!1,function(b,
d,c,h){var e=[d,c].concat(h);h.unshift(c);l(b,d,k,"andmap","function",1,e);R(h,function(d,c){va(b,d,"andmap",c+2,e)});Za(b,h,"andmap",e);var g=function(b,d){if(d[0].isEmpty())return!0;for(var c=[],i=[],o=0;o<d.length;o++)c.push(d[o].first()),i.push(d[o].rest());return F(b,c,function(d){return d&&g(b,i)})};return g(d,h)});c.ormap=new b("ormap",2,!0,!1,function(b,d,c,h){var e=[d,c].concat(h);h.unshift(c);l(b,d,k,"ormap","function",1,e);R(h,function(d,c){va(b,d,"ormap",c+2,e)});Za(b,h,"ormap",e);var g=
function(b,d){if(d[0].isEmpty())return!1;for(var c=[],i=[],o=0;o<d.length;o++)c.push(d[o].first()),i.push(d[o].rest());return F(b,c,function(d){return d||g(b,i)})};return g(d,h)});c.memq=new b("memq",2,!1,!1,function(b,d,c){for(va(b,c,"memq",2,arguments);!c.isEmpty();){var h=c.first();if(d===h)return c;c=c.rest()}return!1});c.memv=new b("memv",2,!1,!1,function(b,d,c){for(va(b,c,"memv",2,arguments);!c.isEmpty();){if(Sa(d,c.first()))return c;c=c.rest()}return!1});c.member=new b("member",2,!1,!1,function(b,
d,c){for(va(b,c,"member",2,arguments);!c.isEmpty();){if(w(d,c.first()))return c;c=c.rest()}return!1});c["member?"]=new b("member?",2,!1,!1,function(b,d,c){for(va(b,c,"member?",2,arguments);!c.isEmpty();){if(w(d,c.first()))return!0;c=c.rest()}return!1});c.memf=new b("memf",2,!1,!0,function(b,d,c){l(b,d,k,"memf","function",1,arguments);va(b,c,"memf",2,arguments);var h=function(b){return b.isEmpty()?!1:F(d,[b.first()],function(d){return d?b:h(b.rest())})};return h(c)});c.assq=new b("assq",2,!1,!1,function(b,
d,c){for(Aa(b,c,P,"assq","pair",2,arguments);!c.isEmpty();){var h=c.first().first();if(d===h)return c.first();c=c.rest()}return!1});c.assv=new b("assv",2,!1,!1,function(b,d,c){for(Aa(b,c,P,"assv","pair",2,arguments);!c.isEmpty();){if(Sa(d,c.first().first()))return c.first();c=c.rest()}return!1});c.assoc=new b("assoc",2,!1,!1,function(b,d,c){for(Aa(b,c,P,"assoc","pair",2,arguments);!c.isEmpty();){if(w(d,c.first().first()))return c.first();c=c.rest()}return!1});c.remove=new b("remove",2,!1,!1,function(b,
d,c){va(b,c,"remove",2,arguments);for(var h=c,e=types.EMPTY;!c.isEmpty();){if(w(d,c.first()))return q(b,[e.reverse(),c.rest()]);e=types.cons(c.first(),e);c=c.rest()}return h});c["remove-all"]=new b("remove-all",2,!1,!1,function(b,d,c){va(b,c,"remove-all",2,arguments);for(var h=types.EMPTY;!c.isEmpty();)w(d,c.first())||(h=types.cons(c.first(),h)),c=c.rest();return h.reverse()});c.filter=new b("filter",2,!1,!1,function(b,d,c){l(b,d,m(1),"filter","function (arity 1)",1,arguments);va(b,c,"filter",2);
var h=function(b,d,c){return d.isEmpty()?c.reverse():F(b,[d.first()],function(i){return i?h(b,d.rest(),types.cons(d.first(),c)):h(b,d.rest(),c)})};return h(d,c,types.EMPTY)});c["num-mean"]=new b("num-mean",0,!0,!1,function(b,d){R(d,function(c,h){l(b,c,K,"mean","number",h+1,d)});if(0==d.length){var c=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("mean",c[c.length-1].first()),": expects at least one argument, but given zero"]),
[]))}for(var c=d[0],h=1;h<d.length;h++)c=jsnums.add(c,d[h]);return jsnums.divide(c,d.length)});c["num-median"]=new b("num-median",0,!0,!1,function(b,d){R(d,function(c,o){l(b,c,K,"median","number",o+1,d)});if(0==d.length){var c=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("median",c[c.length-1].first()),": expects at least one argument, but given zero"]),[]))}d.sort(function(b,d){return jsnums.greaterThan(b,
d)||-1});return 1==d.length%2?d[Math.floor(d.length/2)]:jsnums.divide(jsnums.add(d[d.length/2],d[d.length/2+1]),2)});c["num-mode"]=new b("num-mode",0,!0,!1,function(b,d){R(d,function(c,h){l(b,c,K,"mode","number",h+1,d)});d.sort(function(b,d){return jsnums.greaterThan(b,d)||-1});var c=types.EMPTY,h=highestCount=0;d.forEach(function(b,i){0<i&&jsnums.equals(b,d[i-1])?(h++,h==highestCount?c=types.cons(b,c):h>highestCount&&(c=types.cons(b,types.EMPTY),highestCount=h)):(h=1,h==highestCount?c=types.cons(b,
c):h>highestCount&&(c=types.cons(b,types.EMPTY)))});return c});c.foldl=new b("foldl",3,!0,!1,function(b,d,c,h,e){e.unshift(h);var g=[d,c].concat(e);l(b,d,k,"foldl","function",1,g);R(e,function(d,c){va(b,d,"foldl",c+3,g)});Za(b,e,"foldl",g);return L(d,c,e)});c.foldr=new b("foldr",3,!0,!1,function(b,d,c,h,e){e.unshift(h);var g=[d,c].concat(e);l(b,d,k,"foldr","function",1,g);R(e,function(d,c){va(b,d,"foldr",c+3,g)});Za(b,e,"foldr",g);for(h=0;h<e.length;h++)e[h]=e[h].reverse();return L(d,c,e)});c.quicksort=
new b("quicksort",2,!1,!1,V("quicksort"));c.sort=new b("sort",2,!1,!1,V("sort"));c.argmax=new b("argmax",2,!1,!1,function(b,d,c){var h=arguments;l(b,d,k,"argmax","function",1,h);l(b,c,P,"argmax","non-empty list",2,h);var e=function(c,o,k){return c.isEmpty()?k:F(d,[c.first()],function(d){l(b,d,N,"argmax","procedure that returns real numbers",1,h);return jsnums.greaterThan(d,o)?e(c.rest(),d,c.first()):e(c.rest(),o,k)})};return F(d,[c.first()],function(d){l(b,d,N,"argmax","procedure that returns real numbers",
1,h);return e(c.rest(),d,c.first())})});c.argmin=new b("argmin",2,!1,!1,function(b,d,c){var h=arguments;l(b,d,k,"argmin","function",1,h);l(b,c,P,"argmin","non-empty list",2,h);var e=function(c,o,k){return c.isEmpty()?k:F(d,[c.first()],function(d){l(b,d,N,"argmin","procedure that returns real numbers",1,h);return jsnums.lessThan(d,o)?e(c.rest(),d,c.first()):e(c.rest(),o,k)})};return F(d,[c.first()],function(d){l(b,d,N,"argmin","procedure that returns real numbers",1,h);return e(c.rest(),d,c.first())})});
c["build-list"]=new b("build-list",2,!1,!1,function(b,d,c){l(b,d,H,"build-list","non-negative exact integer",1,arguments);l(b,c,k,"build-list","function",2,arguments);var h=function(b,i){return jsnums.greaterThanOrEqual(b,d)?i.reverse():F(c,[b],function(d){return h(b+1,types.cons(d,i))})};return h(0,types.EMPTY)});c.box=new b("box",1,!1,!1,function(b,d){return types.box(d)});c["box-immutable"]=new b("box-immutable",1,!1,!1,function(b,d){return types.boxImmutable(d)});c.unbox=new b("unbox",1,!1,!1,
function(b,d){l(b,d,Fa,"unbox","box",1);return d.unbox()});c["set-box!"]=new b("set-box!",2,!1,!1,function(b,d,c){l(b,d,function(b){return Fa(b)&&b.mutable},"set-box!","mutable box",1,arguments);d.set(c);return types.VOID});c["make-hash"]=new z("make-hash",[new b("make-hash",0,!1,!1,function(){return types.hash(types.EMPTY)}),new b("make-hash",1,!1,!1,function(b,d){Aa(b,d,P,"make-hash","list of pairs",1);return types.hash(d)})]);c["make-hasheq"]=new z("make-hasheq",[new b("make-hasheq",0,!1,!1,function(){return types.hashEq(types.EMPTY)}),
new b("make-hasheq",1,!1,!1,function(b,d){Aa(b,d,P,"make-hasheq","list of pairs",1);return types.hashEq(d)})]);c["hash-set!"]=new b("hash-set!",3,!1,!1,function(b,d,c,h){l(b,d,ia,"hash-set!","hash",1,arguments);d.hash.put(c,h);return types.VOID});c["hash-ref"]=new z("hash-ref",[new b("hash-ref",2,!1,!1,function(b,d,c){l(b,d,ia,"hash-ref","hash",1,arguments);if(!d.hash.containsKey(c)){var h=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),h=h[h.length-1];C(types.incompleteExn(types.exnFailContract,
new types.Message([new types.ColoredPart("hash-ref",h.first()),": no value found for key ",new types.ColoredPart(types.toWrittenString(c),h.rest().rest().first())]),[]))}return d.hash.get(c)}),new b("hash-ref",3,!1,!1,function(b,d,c,h){l(b,d,ia,"hash-ref","hash",1,arguments);return d.hash.containsKey(c)?d.hash.get(c):k(h)?F(h,[],I):h})]);c["hash-remove!"]=new b("hash-remove",2,!1,!1,function(b,d,c){l(b,d,ia,"hash-remove!","hash",1,arguments);d.hash.remove(c);return types.VOID});c["hash-map"]=new b("hash-map",
2,!1,!1,function(b,d,c){l(b,d,ia,"hash-map","hash",1,arguments);l(b,c,k,"hash-map","function",2,arguments);var h=d.hash.keys(),e=function(b,i){if(b>=h.length)return i;var k=d.hash.get(h[b]);return F(c,[h[b],k],function(d){return e(b+1,types.cons(d,i))})};return e(0,types.EMPTY)});c["hash-for-each"]=new b("hash-for-each",2,!1,!1,function(b,d,c){l(b,d,ia,"hash-for-each","hash",1,arguments);l(b,c,k,"hash-for-each","function",2,arguments);var h=d.hash.keys(),e=function(b){if(b>=h.length)return types.VOID;
var i=d.hash.get(h[b]);return F(c,[h[b],i],function(){return e(b+1)})};return e(0)});c["make-string"]=new b("make-string",2,!1,!1,function(b,d,c){l(b,d,H,"make-string","non-negative exact integer",1,arguments);l(b,c,ba,"make-string","character",2,arguments);for(var h=[],e=0;jsnums.lessThan(e,d);e++)h.push(c.val);return types.string(h)});c.replicate=new b("replicate",2,!1,!1,function(b,d,c){l(b,d,H,"replicate","non-negative exact integer",1,arguments);l(b,c,D,"replicate","string",2,arguments);for(var h=
"",e=c.toString(),k=0;jsnums.lessThan(k,d);k++)h+=e;return types.string(h)});c.string=new b("string",0,!0,!1,function(b,d){R(d,function(c,h){l(b,c,ba,"string","character",h+1,d)});for(var c=[],h=0;h<d.length;h++)c.push(d[h].val);return types.string(c)});c["string-length"]=new b("string-length",1,!1,!1,function(b,d){l(b,d,D,"string-length","string",1);return d.length});c["string-ref"]=new b("string-ref",2,!1,!1,function(b,d,c){l(b,d,D,"string-ref","string",1,arguments);l(b,c,H,"string-ref","non-negative exact integer",
2,arguments);var h=jsnums.toFixnum(c);if(h>=d.length){types.toWrittenString(d);var e=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),e=e[e.length-1];C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("string-ref",e.first()),": index ",h," out of range [0, ",d.length-1,"] for string: ",new types.ColoredPart(types.toWrittenString(d),e.rest().first())]),[]))}return types["char"](d.charAt(h))});c["string=?"]=new b("string=?",2,!0,!1,function(b,
d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,D,"string=?","string",c+1,h)});return $(h,function(b,d){return b.toString()===d.toString()})});c["string-ci=?"]=new b("string-ci=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);for(d=0;d<h.length;d++)l(b,h[d],D,"string-ci=?","string",d+1,h),h[d]=h[d].toString().toLowerCase();return $(h,function(b,d){return b===d})});c["string<?"]=new b("string<?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,D,"string<?",
"string",c+1,h)});return $(h,function(b,d){return b.toString()<d.toString()})});c["string>?"]=new b("string>?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,D,"string>?","string",c+1,h)});return $(h,function(b,d){return b.toString()>d.toString()})});c["string<=?"]=new b("string<=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,D,"string<=?","string",c+1,h)});return $(h,function(b,d){return b.toString()<=d.toString()})});c["string>=?"]=new b("string>=?",
2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,D,"string>=?","string",c+1,h)});return $(h,function(b,d){return b.toString()>=d.toString()})});c["string-ci<?"]=new b("string-ci<?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);for(d=0;d<h.length;d++)l(b,h[d],D,"string-ci<?","string",d+1,h),h[d]=h[d].toString().toLowerCase();return $(h,function(b,d){return b<d})});c["string-ci>?"]=new b("string-ci>?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);for(d=0;d<h.length;d++)l(b,
h[d],D,"string-ci>?","string",d+1,h),h[d]=h[d].toString().toLowerCase();return $(h,function(b,d){return b>d})});c["string-ci<=?"]=new b("string-ci<=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);for(d=0;d<h.length;d++)l(b,h[d],D,"string-ci<=?","string",d+1,h),h[d]=h[d].toString().toLowerCase();return $(h,function(b,d){return b<=d})});c["string-ci>=?"]=new b("string-ci>=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);for(d=0;d<h.length;d++)l(b,h[d],D,"string-ci>=?","string",d+1,h),h[d]=
h[d].toString().toLowerCase();return $(h,function(b,d){return b>=d})});c.substring=new z("substring",[new b("substring",2,!1,!1,function(b,d,c){l(b,d,D,"substring","string",1,arguments);l(b,c,H,"substring","non-negative exact integer",2,arguments);var h=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),h=h[h.length-1],e=jsnums.toFixnum(c);if(e>d.length)C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",h.first()),": starting index ",
new types.ColoredPart(e,h.rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),h.rest().first())]),[]));else return types.string(d.substring(jsnums.toFixnum(e)))}),new b("substring",3,!1,!1,function(b,d,c,h){l(b,d,D,"substring","string",1,arguments);l(b,c,H,"substring","non-negative exact integer",2,arguments);l(b,h,H,"substring","non-negative exact integer",3,arguments);var e=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),
e=e[e.length-1],k=jsnums.toFixnum(c),g=jsnums.toFixnum(h);k>d.length&&C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",e.first()),": starting index ",new types.ColoredPart(k,e.rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),e.rest().first())]),[]));(g<k||g>d.length)&&C(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",e.first()),": ending index ",
new types.ColoredPart(g,e.rest().rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),e.rest().first())]),[]));return types.string(d.substring(k,g))})]);c["string-append"]=new b("string-append",0,!0,!1,function(b,d){R(d,function(c,o){l(b,c,D,"string-append","string",o+1,d)});for(var c=0;c<d.length;c++)d[c]=d[c].toString();return types.string(d.join(""))});c["string->list"]=new b("string->list",1,!1,!1,function(b,d){l(b,d,D,"string->list",
"string",1);for(var c=types.EMPTY,h=d.length-1;0<=h;h--)c=types.cons(types["char"](d.charAt(h)),c);return c});c["list->string"]=new b("list->string",1,!1,!1,function(b,d){Aa(b,d,ba,"list->string","character",1);for(var c=[];!d.isEmpty();)c.push(d.first().val),d=d.rest();return types.string(c)});c["string-copy"]=new b("string-copy",1,!1,!1,function(b,d){l(b,d,D,"string-copy","string",1);return types.string(d.toString())});c["string->symbol"]=new b("string->symbol",1,!1,!1,function(b,d){l(b,d,D,"string->symbol",
"string",1);return types.symbol(d.toString())});c["symbol->string"]=new b("symbol->string",1,!1,!1,function(b,d){l(b,d,fa,"symbol->string","symbol",1);return types.string(d.toString())});c.format=new b("format",1,!0,!1,function(b,d,c){l(b,d,D,"format","string",1,[d].concat(c));return types.string(helpers.format(d,c,"format"))});c.printf=new b("printf",1,!0,!1,function(b,d,c){l(b,d,D,"printf","string",1,[d].concat(c));d=helpers.format(d,c,"printf");b.getDisplayHook()(d);return types.VOID});c["string->int"]=
new b("string->int",1,!1,!1,function(b,d){l(b,d,function(b){return D(b)&&1==b.length},"string->int","1-letter string",1);return d.charCodeAt(0)});c["int->string"]=new b("int->string",1,!1,!1,function(b,d){l(b,d,function(b){if(!p(b))return!1;b=jsnums.toFixnum(b);return 0<=b&&55296>b||57343<b&&1114111>=b},"int->string","exact integer in [0,55295] or [57344,1114111]",1);return types.string(String.fromCharCode(jsnums.toFixnum(d)))});c.explode=new b("explode",1,!1,!1,function(b,d){l(b,d,D,"explode","string",
1);for(var c=types.EMPTY,h=d.length-1;0<=h;h--)c=types.cons(types.string(d.charAt(h)),c);return c});c.implode=new b("implode",1,!1,!1,function(b,d){Aa(b,d,function(b){return D(b)&&1==b.length},"implode","1-letter strings",1);for(var c=[];!d.isEmpty();)c.push(d.first().toString()),d=d.rest();return types.string(c)});c["string-alphabetic?"]=new b("string-alphabetic?",1,!1,!1,function(b,d){l(b,d,D,"string-alphabetic?","string",1);return S(d)});c["string-ith"]=new b("string-ith",2,!1,!1,function(b,d,
c){l(b,d,D,"string-ith","string",1,arguments);l(b,c,function(b){return H(b)&&jsnums.lessThan(b,d.length)},"string-ith","exact integer in [0, length of the given string minus 1 ("+(d.length-1)+")]",2,arguments);return types.string(d.charAt(jsnums.toFixnum(c)))});c["string-lower-case?"]=new b("string-lower-case?",1,!1,!1,function(b,d){l(b,d,D,"string-lower-case?","string",1);var c=d.toString();return S(d)&&c.toLowerCase()===c});c["string-numeric?"]=new b("string-numeric?",1,!1,!1,function(b,d){l(b,
d,D,"string-numeric?","string",1);var c;a:{for(c=0;c<d.length;c++)if(!("0"<=d.charAt(c)&&"9">=d.charAt(c))){c=!1;break a}c=!0}return c});c["string-upper-case?"]=new b("string-upper-case?",1,!1,!1,function(b,d){l(b,d,D,"string-upper-case?","string",1);var c=d.toString();return S(d)&&c.toUpperCase()===c});c["string-whitespace?"]=new b("string-whitespace?",1,!1,!1,function(b,d){l(b,d,D,"string-whitespace?","string",1);return ya(d)});c["build-string"]=new b("build-string",2,!1,!1,function(b,d,c){l(b,
d,H,"build-string","non-negative exact integer",1,arguments);l(b,c,k,"build-string","function",2,arguments);var h=function(e,k){return jsnums.greaterThanOrEqual(e,d)?types.string(k):F(c,[e],function(d){l(b,d,ba,"build-string","procedure that returns a char",2);return h(e+1,k.push(d.val))})};return h(0,[])});c["string->immutable-string"]=new b("string->immutable-string",1,!1,!1,function(b,d){l(b,d,D,"string->immutable-string","string",1);return d.toString()});c["string-set!"]=new b("string-set!",3,
!1,!1,function(b,d,c,h){l(b,d,function(b){return D(b)&&"string"!=typeof b},"string-set!","mutable string",1,arguments);l(b,c,H,"string-set!","non-negative exact integer",2,arguments);l(b,h,ba,"string-set!","character",3,arguments);if(jsnums.greaterThanOrEqual(c,d.length)){var e="string-set!: index "+n+" out of range [0, "+(d.length-1)+"] for string: "+types.toWrittenString(d);C(types.incompleteExn(types.exnFailContract,e,[]))}d.set(jsnums.toFixnum(c),h.val);return types.VOID});c["string-fill!"]=new b("string-fill!",
2,!1,!1,function(b,d,c){l(b,d,function(b){return D(b)&&"string"!=typeof b},"string-fill!","mutable string",1,arguments);l(b,c,ba,"string-fill!","character",2,arguments);for(var h=0;h<d.length;h++)d.set(h,c.val);return types.VOID});c["make-vector"]=new b("make-vector",2,!1,!1,function(b,d,c){l(b,d,H,"make-vector","non-negative exact integer",1,arguments);for(var h=jsnums.toFixnum(d),e=[],k=0;k<h;k++)e.push(c);return types.vector(e)});c.vector=new b("vector",0,!0,!1,function(b,d){return types.vector(d)});
c["vector-length"]=new b("vector-length",1,!1,!1,function(b,d){l(b,d,oa,"vector-length","vector",1);return d.length()});c["vector-ref"]=new b("vector-ref",2,!1,!1,function(b,d,c){l(b,d,oa,"vector-ref","vector",1,arguments);l(b,c,H,"vector-ref","non-negative exact integer",2,arguments);var h=jsnums.toFixnum(c);if(h>=d.length()){var e="vector-ref: index "+h+" out of range [0, "+(d.length()-1)+"] for vector: "+types.toWrittenString(d);C(types.incompleteExn(types.exnFailContract,e,[]))}return d.ref(h)});
c["vector-set!"]=new b("vector-set!",3,!1,!1,function(b,d,c,h){l(b,d,oa,"vector-set!","vector",1,arguments);l(b,c,H,"vector-set!","non-negative exact integer",2,arguments);var e=jsnums.toFixnum(c);if(e>=d.length()){var k="vector-set!: index "+e+" out of range [0, "+(d.length()-1)+"] for vector: "+types.toWrittenString(d);C(types.incompleteExn(types.exnFailContract,k,[]))}d.set(e,h);return types.VOID});c["vector->list"]=new b("vector->list",1,!1,!1,function(b,d){l(b,d,oa,"vector->list","vector",1);
return d.toList()});c["list->vector"]=new b("list->vector",1,!1,!1,function(b,d){va(b,d,"list->vector",1);return types.vector(helpers.schemeListToArray(d))});c["build-vector"]=new b("build-vector",2,!1,!1,function(b,d,c){l(b,d,H,"build-vector","non-negative exact integer",1,arguments);l(b,c,k,"build-vector","function",2,arguments);var h=function(b,i){return jsnums.greaterThanOrEqual(b,d)?types.vector(i):F(c,[b],function(d){return h(b+1,i.push(d))})};return h(0,[])});c["char=?"]=new b("char=?",2,!0,
!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char=?","character",c+1,h)});return $(h,function(b,d){return b.val===d.val})});c["char<?"]=new b("char<?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char<?","character",c+1,h)});return $(h,function(b,d){return b.val<d.val})});c["char>?"]=new b("char>?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char>?","character",c+1,h)});return $(h,function(b,d){return b.val>
d.val})});c["char<=?"]=new b("char<=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char<=?","character",c+1,h)});return $(h,function(b,d){return b.val<=d.val})});c["char>=?"]=new b("char>=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char>=?","character",c+1,h)});return $(h,function(b,d){return b.val>=d.val})});c["char-ci=?"]=new b("char-ci=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char-ci=?",
"character",c+1,h)});return $(h,function(b,d){return b.val.toLowerCase()===d.val.toLowerCase()})});c["char-ci<?"]=new b("char-ci<?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char-ci<?","character",c+1,h)});return $(h,function(b,d){return b.val.toLowerCase()<d.val.toLowerCase()})});c["char-ci>?"]=new b("char-ci>?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char-ci>?","character",c+1,h)});return $(h,function(b,d){return b.val.toLowerCase()>
d.val.toLowerCase()})});c["char-ci<=?"]=new b("char-ci<=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char-ci<=?","character",c+1,h)});return $(h,function(b,d){return b.val.toLowerCase()<=d.val.toLowerCase()})});c["char-ci>=?"]=new b("char-ci>=?",2,!0,!1,function(b,d,c,h){h.unshift(c);h.unshift(d);R(h,function(d,c){l(b,d,ba,"char-ci>=?","character",c+1,h)});return $(h,function(b,d){return b.val.toLowerCase()>=d.val.toLowerCase()})});c["char-alphabetic?"]=new b("char-alphabetic?",
1,!1,!1,function(b,d){l(b,d,ba,"char-alphabetic?","character",1);return S(d.val)});c["char-numeric?"]=new b("char-numeric?",1,!1,!1,function(b,d){l(b,d,ba,"char-numeric?","character",1);return"0"<=d.val&&"9">=d.val});c["char-whitespace?"]=new b("char-whitespace?",1,!1,!1,function(b,d){l(b,d,ba,"char-whitespace?","character",1);return ya(d.val)});c["char-upper-case?"]=new b("char-upper-case?",1,!1,!1,function(b,d){l(b,d,ba,"char-upper-case?","character",1);return S(d.val)&&d.val.toUpperCase()===d.val});
c["char-lower-case?"]=new b("char-lower-case?",1,!1,!1,function(b,d){l(b,d,ba,"char-lower-case?","character",1);return S(d.val)&&d.val.toLowerCase()===d.val});c["char->integer"]=new b("char->integer",1,!1,!1,function(b,d){l(b,d,ba,"char->integer","character",1);return d.val.charCodeAt(0)});c["integer->char"]=new b("integer->char",1,!1,!1,function(b,d){l(b,d,function(b){if(!p(b))return!1;b=jsnums.toFixnum(b);return 0<=b&&55296>b||57343<b&&1114111>=b},"integer->char","exact integer in [0,#x10FFFF], not in [#xD800,#xDFFF]",
1);return types["char"](String.fromCharCode(jsnums.toFixnum(d)))});c["char-upcase"]=new b("char-upcase",1,!1,!1,function(b,d){l(b,d,ba,"char-upcase","character",1);return types["char"](d.val.toUpperCase())});c["char-downcase"]=new b("char-downcase",1,!1,!1,function(b,d){l(b,d,ba,"char-downcase","character",1);return types["char"](d.val.toLowerCase())});c["make-posn"]=new b("make-posn",2,!1,!1,function(b,d,c){return types.posn(d,c)});c["posn-x"]=new b("posn-x",1,!1,!1,function(b,d){l(b,d,types.isPosn,
"posn-x","posn",1);return types.posnX(d)});c["posn-y"]=new b("posn-y",1,!1,!1,function(b,d){l(b,d,types.isPosn,"posn-y","posn",1);return types.posnY(d)});c["key=?"]=new b("key=?",2,!1,!1,function(b,d,c){types.isChar(d)&&(d=d.getValue());types.isChar(c)&&(c=c.getValue());return d.toString().toLowerCase()===c.toString().toLowerCase()});c["image?"]=new b("image?",1,!1,!1,function(b,d){return O(d)});c["image=?"]=new b("image=?",2,!1,!1,function(b,d,c){l(b,d,O,"image=?","image",1);l(b,c,O,"image=?","image",
2);return w(d,c)});c["make-color"]=new z("make-color",[new b("make-color",3,!1,!1,function(b,d,c,h){l(b,d,pa,"make-color","exact number between 0 and 255",1,arguments);l(b,c,pa,"make-color","exact number between 0 and 255",2,arguments);l(b,h,pa,"make-color","exact number between 0 and 255",3,arguments);return types.color(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(h))}),new b("make-color",4,!1,!1,function(b,d,c,h,e){l(b,d,pa,"make-color","exact number between 0 and 255",1,arguments);l(b,
c,pa,"make-color","exact number between 0 and 255",2,arguments);l(b,h,pa,"make-color","exact number between 0 and 255",3,arguments);l(b,e,pa,"make-color","exact number between 0 and 255",4,arguments);return types.color(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(h),jsnums.toFixnum(e))})]);c["color-red"]=new b("color-red",1,!1,!1,function(b,d){l(b,d,types.isColor,"color-red","color",1);return types.colorRed(d)});c["color-green"]=new b("color-green",1,!1,!1,function(b,d){l(b,d,types.isColor,
"color-green","color",1);return types.colorGreen(d)});c["color-blue"]=new b("color-blue",1,!1,!1,function(b,d){l(b,d,types.isColor,"color-blue","color",1);return types.colorBlue(d)});c["color-alpha"]=new b("color-alpha",1,!1,!1,function(b,d){l(b,d,types.isColor,"color-alpha","color",1);return types.colorAlpha(d)});c["empty-scene"]=new z("empty-scene",[new b("empty-scene",2,!1,!1,function(b,d,c){l(b,d,M,"empty-scene","non-negative number",1,arguments);l(b,c,M,"empty-scene","non-negative number",2,
arguments);return world.Kernel.sceneImage(jsnums.toFixnum(d),jsnums.toFixnum(c),[],!0,!1)}),new b("empty-scene",3,!1,!1,function(b,d,c,h){l(b,d,M,"empty-scene","non-negative number",1,arguments);l(b,c,M,"empty-scene","non-negative number",2,arguments);l(b,h,ea,"empty-scene","color",3,arguments);E.get(h)&&(h=E.get(h));return world.Kernel.sceneImage(jsnums.toFixnum(d),jsnums.toFixnum(c),[],!0,h)})]);c["put-image"]=new b("put-image",4,!1,!1,function(b,d,c,h,e){l(b,d,O,"put-image","image",1,arguments);
l(b,c,N,"put-image","real",2,arguments);l(b,h,N,"put-image","real",3,arguments);l(b,e,function(b){return U(b)||O(b)},"put-image","image",4,arguments);c=jsnums.toFixnum(c);h=jsnums.toFixnum(h);if(U(e))return e.add(d,c,e.getHeight()-h);var k=world.Kernel.sceneImage(e.getWidth(),e.getHeight(),[],!1,null),k=k.add(e,e.getWidth()/2,e.getHeight()/2);return k=k.add(d,c,e.getHeight()-h)});c["place-image"]=new b("place-image",4,!1,!1,function(b,d,c,h,e){l(b,d,O,"place-image","image",1,arguments);l(b,c,N,"place-image",
"real",2,arguments);l(b,h,N,"place-image","real",3,arguments);l(b,e,function(b){return U(b)||O(b)},"place-image","image",4,arguments);c=jsnums.toFixnum(c);h=jsnums.toFixnum(h);if(U(e))return e.add(d,c,h);var k=world.Kernel.sceneImage(e.getWidth(),e.getHeight(),[],!1,null),k=k.add(e,e.getWidth()/2,e.getHeight()/2);return k=k.add(d,c,h)});c["place-image/align"]=new b("place-image/align",6,!1,!1,function(b,d,c,h,e,k,g){l(b,d,O,"place-image/align","image",1,arguments);l(b,c,N,"place-image/align","real number",
2,arguments);l(b,h,N,"place-image/align","real number",3,arguments);l(b,e,Ka,"place-image/align","x-place",4,arguments);l(b,k,Xa,"place-image/align","y-place",5,arguments);l(b,g,function(b){return U(b)||O(b)},"place-image/align","image",6,arguments);c=jsnums.toFixnum(c);h=jsnums.toFixnum(h);"left"==e?c+=d.getWidth()/2:"right"==e&&(c-=d.getWidth()/2);"top"==k?h+=d.getHeight()/2:"bottom"==k&&(h-=d.getHeight()/2);if(U(g))return g.add(d,c,h);var j=world.Kernel.sceneImage(g.getWidth(),g.getHeight(),[],
!1,null),j=j.add(g,g.getWidth()/2,g.getHeight()/2);return j=j.add(d,c,h)});c["scene+line"]=new b("scene+line",6,!1,!1,function(b,d,c,h,e,k,g){l(b,d,O,"scene+line","image",1,arguments);l(b,c,N,"scene+line","finite real number",2,arguments);l(b,h,N,"scene+line","finite real number",3,arguments);l(b,e,N,"scene+line","finite real number",4,arguments);l(b,k,N,"scene+line","finite real number",5,arguments);l(b,g,ea,"scene+line","color",6,arguments);E.get(g)&&(g=E.get(g));newScene=world.Kernel.sceneImage(jsnums.toFixnum(d.getWidth()),
jsnums.toFixnum(d.getHeight()),[],!1,null);newScene=newScene.add(d,d.getWidth()/2,d.getHeight()/2);line=world.Kernel.lineImage(jsnums.toFixnum(e-c),jsnums.toFixnum(k-h),g);leftMost=Math.min(c,e);topMost=Math.min(h,k);return newScene.add(line,line.getWidth()/2+leftMost,line.getHeight()/2+topMost)});c["put-pinhole"]=new b("put-pinhole",3,!1,!1,function(b,d,c,h){l(b,d,O,"put-pinhole","image",1,arguments);l(b,c,N,"put-pinhole","real",2,arguments);l(b,h,N,"put-pinhole","real",3,arguments);return d.updatePinhole(jsnums.toFixnum(c),
jsnums.toFixnum(h))});c.circle=new b("circle",3,!1,!1,function(b,d,c,h){l(b,d,M,"circle","non-negative number",1,arguments);l(b,c,ma,"circle",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,h,ea,"circle","color",3,arguments);E.get(h)&&(h=E.get(h));return world.Kernel.circleImage(jsnums.toFixnum(d),c.toString(),h)});c.star=new z("star",[new b("star",5,!1,!1,function(b,d,c,h,e,k){l(b,d,g,"star","positive integer greater than or equal to 3",1,arguments);l(b,c,M,"star","non-negative number",
2,arguments);l(b,h,M,"star","non-negative number",3,arguments);l(b,e,ma,"star",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"star","color",5,arguments);E.get(k)&&(k=E.get(k));return world.Kernel.starImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(h),e.toString(),k)}),new b("star",3,!1,!1,function(b,d,c,h){l(b,d,M,"star","non-negative number",1,arguments);l(b,c,ma,"star",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,h,ea,
"star","color",3,arguments);E.get(h)&&(h=E.get(h));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(5),jsnums.toFixnum(2),c.toString(),h,"star")})]);c["radial-star"]=new b("radial-star",5,!1,!1,function(b,d,c,h,e,k){l(b,d,function(b){return H(b)&&jsnums.greaterThanOrEqual(b,2)},"radial-star","positive integer greater than or equal to 2",1,arguments);l(b,c,function(b){return N(b)&&jsnums.greaterThan(b,0)},"radial-star","positive number",2,arguments);l(b,h,function(b){return N(b)&&
jsnums.greaterThan(b,0)},"radial-star","positive number",3,arguments);l(b,e,ma,"radial-star",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"radial-star","color",5,arguments);E.get(k)&&(k=E.get(k));return world.Kernel.starImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(h),e.toString(),k)});c.rectangle=new b("rectangle",4,!1,!1,function(b,d,c,h,e){l(b,d,M,"rectangle","non-negative number",1,arguments);l(b,c,M,"rectangle","non-negative number",2,arguments);
l(b,h,ma,"rectangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,e,ea,"rectangle","color",4,arguments);E.get(e)&&(e=E.get(e));return world.Kernel.rectangleImage(jsnums.toFixnum(d),jsnums.toFixnum(c),h.toString(),e)});c.polygon=new b("polygon",3,!1,!1,function(b,d,c,h){Ua(b,d,3,"polygon",1);l(b,d,function(b){return ua(b,types.isPosn)},"polygon","list of posns",1,arguments);l(b,c,ma,"polygon",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,
h,ea,"polygon","color",3,arguments);E.get(h)&&(h=E.get(h));return world.Kernel.posnImage(helpers.flattenSchemeListToArray(d),c.toString(),h)});c["regular-polygon"]=new b("regular-polygon",4,!1,!1,function(b,d,c,h,e){l(b,d,M,"regular-polygon","non-negative number",1,arguments);l(b,c,g,"regular-polygon","positive integer greater than or equal to 3",2,arguments);l(b,h,ma,"regular-polygon",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,e,ea,"regular-polygon","color",4,arguments);
E.get(e)&&(e=E.get(e));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(1),h.toString(),e)});c["star-polygon"]=new b("star-polygon",5,!1,!1,function(b,d,c,h,e,k){l(b,d,M,"star-polygon","non-negative number",1,arguments);l(b,c,g,"star-polygon","positive integer greater than or equal to 3",2,arguments);l(b,h,T,"star-polygon","positive integer greater than or equal to 1",3,arguments);l(b,e,ma,"star-polygon",'style ("solid" / "outline") or an opacity value [0-255])',
4,arguments);l(b,k,ea,"star-polygon","color",5,arguments);E.get(k)&&(k=E.get(k));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(h),e.toString(),k)});c.rhombus=new b("rhombus",4,!1,!1,function(b,d,c,h,e){l(b,d,M,"rhombus","non-negative number",1,arguments);l(b,c,M,"rhombus","non-negative number",2,arguments);l(b,h,ma,"rhombus",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,e,ea,"rhombus","color",4,arguments);E.get(e)&&(e=E.get(e));
return world.Kernel.rhombusImage(jsnums.toFixnum(d),jsnums.toFixnum(c),h.toString(),e)});c.square=new b("square",3,!1,!1,function(b,d,c,h){l(b,d,M,"square","non-negative number",1,arguments);l(b,c,ma,"square",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,h,ea,"square","color",3,arguments);E.get(h)&&(h=E.get(h));return world.Kernel.squareImage(jsnums.toFixnum(d),c.toString(),h)});c.triangle=new b("triangle",3,!1,!1,function(b,d,c,h){l(b,d,M,"triangle","non-negative number",
1,arguments);l(b,c,ma,"triangle",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,h,ea,"triangle","color",3,arguments);E.get(h)&&(h=E.get(h));return world.Kernel.triangleImage(jsnums.toFixnum(d),jsnums.toFixnum(300),jsnums.toFixnum(d),c.toString(),h)});c["triangle/sas"]=new b("triangle/sas",5,!1,!1,function(b,d,c,h,e,k){l(b,d,M,"triangle/sas","non-negative number",1,arguments);l(b,c,G,"triangle/sas","finite real number",2,arguments);l(b,h,M,"triangle/sas","non-negative number",
3,arguments);l(b,e,ma,"triangle/sas",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"triangle/sas","color",5,arguments);E.get(k)&&(k=E.get(k));var d=jsnums.toFixnum(d),c=jsnums.toFixnum(c%360),h=jsnums.toFixnum(h),g=d*d+h*h-2*d*h*Math.cos(c*Math.PI/180),j=Math.sqrt(g);0>=g?C(types.incompleteExn(types.exnFailContract,"The given side, angle and side will not form a triangle: "+d+", "+c+", "+h,[])):(1.0E-5<j-(d+h)||1.0E-5<d-(j+h)||1.0E-5<h-(d+j))&&C(types.incompleteExn(types.exnFailContract,
"The given side, angle and side will not form a triangle: "+d+", "+c+", "+h,[]));g=Math.acos((j*j+h*h-d*d)/(2*j*h))*(180/Math.PI);return world.Kernel.triangleImage(jsnums.toFixnum(h),jsnums.toFixnum(g),jsnums.toFixnum(j),e.toString(),k)});c["triangle/sss"]=new b("triangle/sss",5,!1,!1,function(b,d,c,h,e,k){l(b,d,M,"triangle/sss","non-negative number",1,arguments);l(b,c,M,"triangle/sss","non-negative number",2,arguments);l(b,h,M,"triangle/sss","non-negative number",3,arguments);l(b,e,ma,"triangle/sss",
'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"triangle/sss","color",5,arguments);E.get(k)&&(k=E.get(k));d=jsnums.toFixnum(d);c=jsnums.toFixnum(c);h=jsnums.toFixnum(h);(1.0E-5<h-(d+c)||1.0E-5<d-(h+c)||1.0E-5<c-(d+h))&&C(types.incompleteExn(types.exnFailContract,"The given sides will not form a triangle: "+d+", "+c+", "+h,[]));var g=Math.acos((c*c+h*h-d*d)/(2*c*h))*(180/Math.PI);return world.Kernel.triangleImage(jsnums.toFixnum(h),jsnums.toFixnum(g),jsnums.toFixnum(c),
e.toString(),k)});c["triangle/ass"]=new b("triangle/ass",5,!1,!1,function(b,d,c,h,e,k){l(b,d,G,"triangle/ass","finite real number",1,arguments);l(b,c,M,"triangle/ass","non-negative number",2,arguments);l(b,h,M,"triangle/ass","non-negative number",3,arguments);l(b,e,ma,"triangle/ass",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"triangle/ass","color",5,arguments);d=jsnums.toFixnum(d%360);c=jsnums.toFixnum(c);h=jsnums.toFixnum(h);E.get(k)&&(k=E.get(k));1.0E-5<d-180&&
C(types.incompleteExn(types.exnFailContract,"The given angle, side and side will not form a triangle: "+d+", "+c+", "+h,[]));return world.Kernel.triangleImage(jsnums.toFixnum(h),jsnums.toFixnum(d),jsnums.toFixnum(c),e.toString(),k)});c["triangle/ssa"]=new b("triangle/ssa",5,!1,!1,function(b,d,c,h,e,k){l(b,d,M,"triangle/ssa","non-negative number",1,arguments);l(b,c,M,"triangle/ssa","non-negative number",2,arguments);l(b,h,G,"triangle/ssa","finite real number",3,arguments);l(b,e,ma,"triangle/ssa",'style ("solid" / "outline") or an opacity value [0-255])',
4,arguments);l(b,k,ea,"triangle/ssa","color",5,arguments);E.get(k)&&(k=E.get(k));d=jsnums.toFixnum(d);c=jsnums.toFixnum(c);h=jsnums.toFixnum(h%360);1.0E-5<h-180&&C(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+d+", "+c+", "+h,[]));var g=d*d+c*c-2*d*c*Math.cos(h*Math.PI/180),j=Math.sqrt(g);0>=g?C(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+d+", "+c+", "+h,[])):(1.0E-5<j-(d+c)||1.0E-5<d-
(j+c)||1.0E-5<c-(d+j))&&C(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+d+", "+c+", "+h,[]));g=Math.acos((c*c+j*j-d*d)/(2*c*j))*(180/Math.PI);return world.Kernel.triangleImage(jsnums.toFixnum(j),jsnums.toFixnum(g),jsnums.toFixnum(c),e.toString(),k)});c["triangle/aas"]=new b("triangle/aas",5,!1,!1,function(b,d,c,h,e,k){l(b,d,G,"triangle/aas","finite real number",1,arguments);l(b,c,G,"triangle/aas","finite real number",2,arguments);l(b,h,M,"triangle/aas",
"non-negative number",3,arguments);l(b,e,ma,"triangle/aas",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"triangle/aas","color",5,arguments);E.get(k)&&(k=E.get(k));var d=jsnums.toFixnum(d%360),c=jsnums.toFixnum(c%360),h=jsnums.toFixnum(h),g=180-d-c;1.0E-5<0-g&&C(types.incompleteExn(types.exnFailContract,"The given angle, angle and side will not form a triangle: "+d+", "+c+", "+h,[]));g=h/Math.sin(g*Math.PI/180)*Math.sin(c*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(h),
d,jsnums.toFixnum(g),e.toString(),k)});c["triangle/asa"]=new b("triangle/asa",5,!1,!1,function(b,d,c,h,e,k){l(b,d,G,"triangle/asa","finite real number",1,arguments);l(b,c,M,"triangle/asa","non-negative number",2,arguments);l(b,h,G,"triangle/asa","finite real number",3,arguments);l(b,e,ma,"triangle/asa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"triangle/asa","color",5,arguments);E.get(k)&&(k=E.get(k));var d=jsnums.toFixnum(d%360),c=jsnums.toFixnum(c),h=jsnums.toFixnum(h%
360),g=180-d-h;1.0E-5<0-g&&C(types.incompleteExn(types.exnFailContract,"The given angle, side and angle will not form a triangle: "+d+", "+c+", "+h,[]));Math.sin(d*Math.PI/180);Math.sin(g*Math.PI/180);g=c*Math.sin(h*Math.PI/180)/Math.sin(g*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(g),d,jsnums.toFixnum(c),e.toString(),k)});c["triangle/saa"]=new b("triangle/saa",5,!1,!1,function(b,d,c,h,e,k){l(b,d,M,"triangle/saa","non-negative number",1,arguments);l(b,c,G,"triangle/saa","finite real number",
2,arguments);l(b,h,G,"triangle/saa","finite real number",3,arguments);l(b,e,ma,"triangle/saa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,ea,"triangle/saa","color",5,arguments);E.get(k)&&(k=E.get(k));var d=jsnums.toFixnum(d),c=jsnums.toFixnum(c%360),h=jsnums.toFixnum(h%360),g=180-h-c,j=d/Math.sin(g*Math.PI/180),m=j*Math.sin(h*Math.PI/180),j=j*Math.sin(c*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(m),g,jsnums.toFixnum(j),e.toString(),k)});c["right-triangle"]=
new b("right-triangle",4,!1,!1,function(b,d,c,h,e){l(b,d,M,"right-triangle","non-negative number",1,arguments);l(b,c,M,"right-triangle","non-negative number",2,arguments);l(b,h,ma,"right-triangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,e,ea,"right-triangle","color",4,arguments);E.get(e)&&(e=E.get(e));return world.Kernel.triangleImage(jsnums.toFixnum(d),jsnums.toFixnum(270),jsnums.toFixnum(c),h.toString(),e)});c["isosceles-triangle"]=new b("isosceles-triangle",
4,!1,!1,function(b,d,c,h,e){l(b,d,M,"isosceles-triangle","non-negative number",1,arguments);l(b,c,G,"isosceles-triangle","finite real number",2,arguments);l(b,h,ma,"isosceles-triangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,e,ea,"isosceles-triangle","color",4,arguments);E.get(e)&&(e=E.get(e));var k=0>c?-1:1,g=(180-Math.abs(c))/2,j=2*d*Math.sin(Math.abs(c)*Math.PI/180/2);return world.Kernel.triangleImage(jsnums.toFixnum(j),jsnums.toFixnum(360-g)*k,jsnums.toFixnum(d),
h.toString(),e)});c.ellipse=new b("ellipse",4,!1,!1,function(b,d,c,h,e){l(b,d,M,"ellipse","non-negative number",1,arguments);l(b,c,M,"ellipse","non-negative number",2,arguments);l(b,h,ma,"ellipse",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,e,ea,"ellipse","color",4,arguments);E.get(e)&&(e=E.get(e));return world.Kernel.ellipseImage(jsnums.toFixnum(d),jsnums.toFixnum(c),h.toString(),e)});c.line=new b("line",3,!1,!1,function(b,d,c,h){l(b,d,N,"line","finite real number",
1,arguments);l(b,c,N,"line","finite real number",2,arguments);l(b,h,ea,"line","color",3,arguments);E.get(h)&&(h=E.get(h));return world.Kernel.lineImage(jsnums.toFixnum(d),jsnums.toFixnum(c),h)});c["add-line"]=new b("add-line",6,!1,!1,function(b,d,c,h,e,k,g){l(b,d,O,"add-line","image",1,arguments);l(b,c,N,"add-line","finite real number",2,arguments);l(b,h,N,"add-line","finite real number",3,arguments);l(b,e,N,"add-line","finite real number",4,arguments);l(b,k,N,"add-line","finite real number",5,arguments);
l(b,g,ea,"add-line","color",6,arguments);E.get(g)&&(g=E.get(g));var c=jsnums.toFixnum(c),e=jsnums.toFixnum(e),h=jsnums.toFixnum(h),k=jsnums.toFixnum(k),j=world.Kernel.lineImage(e-c,k-h,g),m=Math.min(c,e),w=Math.min(h,k);return world.Kernel.overlayImage(j,d,-m,-w)});c.overlay=new b("overlay",2,!0,!1,function(b,d,c,e){var k=[d,c].concat(e);l(b,d,O,"overlay","image",1,k);l(b,c,O,"overlay","image",2,k);R(e,function(d,c){l(b,d,O,"overlay","image",c+3)},arguments);for(var k=world.Kernel.overlayImage(d,
c,"middle","middle"),g=0;g<e.length;g++)k=world.Kernel.overlayImage(k,e[g],"middle","middle");return k});c["overlay/xy"]=new b("overlay/xy",4,!1,!1,function(b,d,c,e,k){l(b,d,O,"overlay/xy","image",1,arguments);l(b,c,N,"overlay/xy","finite real number",2,arguments);l(b,e,N,"overlay/xy","finite real number",3,arguments);l(b,k,O,"overlay/xy","image",4,arguments);return world.Kernel.overlayImage(d,k,jsnums.toFixnum(c),jsnums.toFixnum(e))});c["overlay/align"]=new b("overlay/align",4,!0,!1,function(b,d,
c,e,k,g){xa(b,d,Ka,"overlay/align","x-place",1,arguments);xa(b,c,Xa,"overlay/align","y-place",2,arguments);xa(b,e,O,"overlay/align","image",3,arguments);xa(b,k,O,"overlay/align","image",4,arguments);R(g,function(d,c){l(b,d,O,"overlay/align","image",c+4)},arguments);for(var j=world.Kernel.overlayImage(e,k,d.toString(),c.toString()),m=0;m<g.length;m++)j=world.Kernel.overlayImage(j,g[m],d.toString(),c.toString());return j});c.underlay=new b("underlay",2,!0,!1,function(b,d,c,e){xa(b,d,O,"underlay","image",
1,arguments);xa(b,c,O,"underlay","image",2,arguments);R(e,function(d,c){l(b,d,O,"underlay","image",c+3)},arguments);for(var k=world.Kernel.overlayImage(c,d,"middle","middle"),g=0;g<e.length;g++)k=world.Kernel.overlayImage(e[g],k,"middle","middle");return k});c["underlay/xy"]=new b("underlay/xy",4,!1,!1,function(b,d,c,e,k){l(b,d,O,"underlay/xy","image",1,arguments);l(b,c,N,"underlay/xy","finite real number",2,arguments);l(b,e,N,"underlay/xy","finite real number",3,arguments);l(b,k,O,"underlay/xy",
"image",4,arguments);return world.Kernel.overlayImage(k,d,-jsnums.toFixnum(c),-jsnums.toFixnum(e))});c["underlay/align"]=new b("underlay/align",4,!0,!1,function(b,d,c,e,k,g){xa(b,d,Ka,"underlay/align","x-place",1,arguments);xa(b,c,Xa,"underlay/align","y-place",2,arguments);xa(b,e,O,"underlay/align","image",3,arguments);xa(b,k,O,"underlay/align","image",4,arguments);R(g,function(d,c){l(b,d,O,"underlay/align","image",c+4)},arguments);for(var j=world.Kernel.overlayImage(k,e,d.toString(),c.toString()),
m=0;m<g.length;m++)j=world.Kernel.overlayImage(g[m],j,d.toString(),c.toString());return j});c.beside=new b("beside",2,!0,!1,function(b,d,c,e){xa(b,d,O,"beside","image",1,arguments);xa(b,c,O,"beside","image",2,arguments);R(e,function(d,c){l(b,d,O,"beside","image",c+4)},arguments);for(var k=world.Kernel.overlayImage(d,c,"beside","middle"),g=0;g<e.length;g++)k=world.Kernel.overlayImage(k,e[g],"beside","middle");return k});c["beside/align"]=new b("beside/align",3,!0,!1,function(b,d,c,e,k){xa(b,d,Xa,"beside/align",
"y-place",1,arguments);xa(b,c,O,"beside/align","image",2,arguments);xa(b,e,O,"beside/align","image",3,arguments);R(k,function(d,c){l(b,d,O,"beside","image",c+3)},arguments);for(var g=world.Kernel.overlayImage(c,e,"beside",d.toString()),j=0;j<k.length;j++)g=world.Kernel.overlayImage(g,k[j],"beside",d.toString());return g});c.above=new b("above",2,!0,!1,function(b,d,c,e){xa(b,d,O,"above","image",1,arguments);xa(b,c,O,"above","image",2,arguments);R(e,function(d,c){l(b,d,O,"above","image",c+4)},arguments);
for(var k=world.Kernel.overlayImage(d,c,"middle","above"),g=0;g<e.length;g++)k=world.Kernel.overlayImage(k,e[g],"middle","above");return k});c["above/align"]=new b("above/align",3,!0,!1,function(b,d,c,e,k){xa(b,d,Ka,"above/align","x-place",1,arguments);xa(b,c,O,"above/align","image",1,arguments);xa(b,e,O,"above/align","image",2,arguments);R(k,function(d,c){l(b,d,O,"above/align","image",c+4)},arguments);var g,j=world.Kernel.overlayImage(c,e,d.toString(),"above");for(g=0;g<k.length;g++)j=world.Kernel.overlayImage(j,
k[g],d.toString(),"above");return j});c.rotate=new b("rotate",2,!1,!1,function(b,d,c){l(b,d,G,"rotate","angle",1,arguments);l(b,c,O,"rotate","image",2,arguments);d=jsnums.toFixnum(d)%360;return world.Kernel.rotateImage(-1*d,c)});c["scale/xy"]=new b("scale/xy",3,!1,!1,function(b,d,c,e){l(b,d,M,"scale/xy","non-negative number",1,arguments);l(b,c,M,"scale/xy","non-negative number",2,arguments);l(b,e,O,"scale/xy","image",3,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(d),jsnums.toFixnum(c),
e)});c.scale=new b("scale",2,!1,!1,function(b,d,c){l(b,d,M,"scale","non-negative number",1,arguments);l(b,c,O,"scale","image",2,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(d),jsnums.toFixnum(d),c)});c.crop=new b("crop",5,!1,!1,function(b,d,c,e,k,g){l(b,d,N,"crop","finite real number",1,arguments);l(b,c,N,"crop","finite real number",2,arguments);l(b,e,M,"crop","non-negative number",3,arguments);l(b,k,M,"crop","non-negative number",4,arguments);l(b,g,O,"crop","image",5,arguments);return world.Kernel.cropImage(jsnums.toFixnum(d),
jsnums.toFixnum(c),jsnums.toFixnum(e),jsnums.toFixnum(k),g)});c.frame=new b("frame",1,!1,!1,function(b,d){l(b,d,O,"frame","image",1,arguments);return world.Kernel.frameImage(d)});c["flip-vertical"]=new b("flip-vertical",1,!1,!1,function(b,d){l(b,d,O,"flip-vertical","image",1,arguments);return world.Kernel.flipImage(d,"vertical")});c["flip-horizontal"]=new b("flip-horizontal",1,!1,!1,function(b,d){l(b,d,O,"flip-horizontal","image",1,arguments);return world.Kernel.flipImage(d,"horizontal")});c.text=
new b("text",3,!1,!1,function(b,d,c,e){l(b,d,D,"text","string",1,arguments);l(b,c,function(b){return H(b)&&jsnums.greaterThan(b,0)&&pa(b)},"text","exact integer between 1 and 255",2,arguments);l(b,e,ea,"text","color",3,arguments);E.get(e)&&(e=E.get(e));return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),e,"normal","Arial","","",!1)});c["text/font"]=new z("text/font",[new b("text/font",8,!1,!1,function(b,d,c,e,k,g,j,m,w){l(b,d,D,"text/font","string",1,arguments);l(b,c,function(b){return H(b)&&
jsnums.greaterThan(b,0)&&pa(b)},"text/font","exact integer between 1 and 255",2,arguments);l(b,e,ea,"text/font","color",3,arguments);l(b,k,function(b){return D(b)||!b},"text/font","face",4,arguments);l(b,g,wa,"text/font","family",5,arguments);l(b,j,sa,"text/font",'style ("solid" or "outline")',6,arguments);l(b,m,v,"text/font","weight",7,arguments);l(b,w,qa,"text/font","underline?",8,arguments);E.get(e)&&(e=E.get(e));return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),e,k.toString(),g.toString(),
j.toString(),m.toString(),w)}),new b("text/font",9,!1,!1,function(b,d,c,e,k,g,j,m,w,p){l(b,d,D,"text/font","string",1,arguments);l(b,c,function(b){return H(b)&&jsnums.greaterThan(b,0)&&pa(b)},"text/font","exact integer between 1 and 255",2,arguments);l(b,e,ea,"text/font","color",3,arguments);l(b,k,function(b){return D(b)||!b},"text/font","face",4,arguments);l(b,g,wa,"text/font","family",5,arguments);l(b,j,sa,"text/font",'style ("solid" or "outline")',6,arguments);l(b,m,v,"text/font","weight",7,arguments);
l(b,w,qa,"text/font","underline?",8,arguments);l(b,p,qa,"text/font","outline?",9,arguments);E.get(e)&&(e=E.get(e));return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),e,k.toString(),g.toString(),j.toString(),m.toString(),w,p)})]);c["play-sound"]=new b("play-sound",2,!1,!1,function(b,d,c){l(b,d,D,"play-sound","string",1);l(b,c,qa,"play-sound","boolean",2);return y(function(e){cb(d.toString());var k=document.createElement("audio");k.src=d.toString();k.addEventListener("canplay",function(){var g=
new world.Kernel.fileAudio(d.toString(),!1,k);b.addBreakRequestedListener(function(){g.audio.pause();return!0});if(c)return e(!0);k.addEventListener("ended",function(){return e(!0)})});k.addEventListener("error",function(){e(!1)});k.src=d.toString()})});c["bitmap/url"]=c["image-url"]=new b("bitmap/url",1,!1,!1,function(b,d){l(b,d,D,"bitmap/url","string",1);var c=d.toString(),d=b.getImageProxyHook()?b.getImageProxyHook()+"?url="+encodeURIComponent(d.toString()):d.toString();return y(function(b){cb(c);
var e=new Image;e.onload=function(){world.Kernel.fileImage(d,e,b)};e.onerror=function(){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+c+")",[])))};e.src=d})});c["video/url"]=new b("video/url",1,!1,!1,function(b,d){l(b,d,D,"video-url","string",1);return y(function(c){cb(d.toString());var e=document.createElement("video");e.src=d.toString();e.addEventListener("canplay",function(){c(world.Kernel.fileVideo(d.toString(),e));b.addBreakRequestedListener(function(){e.pause();
return!0})});e.addEventListener("error",function(){c(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+d+")",[])))});e.src=d.toString()})});c["image-width"]=new b("image-width",1,!1,!1,function(b,d){l(b,d,O,"image-width","image",1);return d.getWidth()});c["image-height"]=new b("image-height",1,!1,!1,function(b,d){l(b,d,O,"image-height","image",1);return d.getHeight()});c["image-baseline"]=new b("image-baseline",1,!1,!1,function(b,d){l(b,d,O,"image-baseline","image",1);return d.getBaseline()});
c["image->color-list"]=new b("image->color-list",1,!1,!1,function(b,d){l(b,d,O,"image->color-list","image",1);var c=d.getWidth(),e=d.getHeight(),k=world.Kernel.makeCanvas(c,e).getContext("2d"),g,j,m;d.render(k,0,0);for(var c=k.getImageData(0,0,c,e).data,w=[],e=0;e<c.length;e+=4)k=c[e],g=c[e+1],j=c[e+2],m=c[e+3],w.push(types.color(k,g,j,m));return types.list(w)});var hb=function(b,d,c,e,k,g){Aa(b,d,ea,"color-list->image","image",1);l(b,c,M,"color-list->image","non-negative number",2);l(b,e,M,"color-list->image",
"non-negative number",3);l(b,k,H,"color-list->image","natural",4);l(b,g,H,"color-list->image","natural",5);for(var c=Math.max(jsnums.toFixnum(c),1),e=Math.max(jsnums.toFixnum(e),1),b=world.Kernel.makeCanvas(c,e),k=b.getContext("2d"),c=k.createImageData(c,e),e=c.data,j=0;d!==types.EMPTY;)g=d.first(),e[j]=jsnums.toFixnum(types.colorRed(g)),e[j+1]=jsnums.toFixnum(types.colorGreen(g)),e[j+2]=jsnums.toFixnum(types.colorBlue(g)),e[j+3]=jsnums.toFixnum(types.colorAlpha(g)),j+=4,d=d.rest();k.putImageData(c,
0,0);var m=b.toDataURL("image/png");return y(function(b){var d=new Image;d.onload=function(){world.Kernel.fileImage(m,d,b)};d.onerror=function(){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load image from color-list)",[])))};d.src=m})};c["color-list->image"]=new b("color-list->image",5,!1,!1,function(b,d,c,e,k,g){return hb(b,d,c,e,k,g)});c["color-list->image"]=new b("color-list->image",5,!1,!1,function(b,d,c,e,k,g){return hb(b,d,c,e,k,g)});c["color-list->bitmap"]=new b("color-list->bitmap",
3,!1,!1,function(b,d,c,e){return hb(b,d,c,e,0,0)});c["mode?"]=new b("mode?",1,!1,!1,function(b,d){return ma(d)});c["image-color?"]=new b("image-color?",1,!1,!1,function(b,d){return ea(d)});c["name->color"]=new b("name->color",1,!1,!1,function(b,d){return la(d)||!1});c["x-place?"]=new b("x-place?",1,!1,!1,function(b,d){return Ka(d)});c["y-place?"]=new b("y-place?",1,!1,!1,function(b,d){return Xa(d)});c["angle?"]=new b("angle?",1,!1,!1,function(b,d){return G(d)});c["side-count?"]=new b("side-count?",
1,!1,!1,function(b,d){return g(d)});c["step-count?"]=new b("step-count?",1,!1,!1,function(b,d){return T(d)});var lb=aa.extend({init:function(b,d){this._super("stop-when");this.handler=b;this.last_picture=d},configure:function(b){return b.updateAll({stopWhen:this.handler,lastPicture:this.last_picture})}}),Ta=aa.extend({init:function(b,d,c){this._super("on-tick");this.handler=b;this.effectHandler=d;this.aDelay=c},configure:function(b){var d={onTick:this.handler,onTickEffect:this.effectHandler,tickDelay:jsnums.toFixnum(jsnums.multiply(1E3,
this.aDelay))};return b.updateAll(d)}}),Oa=aa.extend({init:function(b){this._super("on-redraw");this.handler=b},configure:function(b){return b.updateAll({onRedraw:this.handler})}}),db=!1;void 0!==window.plt&&(V=plt.wescheme.BrowserDetect,db="Explorer"===V.browser&&11>V.version);var Qa=db?types.rational(1,8):types.rational(1,28);c["on-tick"]=new z("on-tick",[new b("on-tick",1,!1,!1,function(c,d){l(c,d,k,"on-tick","function",1);j(c,"on-tick",1,d.numParams);return new Ta(d,new b("",1,!1,!1,function(){return types.effectDoNothing()}),
Qa)}),new b("on-tick",2,!1,!1,function(c,d,e){l(c,d,k,"on-tick","function",1,arguments);j(c,"on-tick",1,d.numParams);l(c,e,M,"on-tick","non-negative number",2,arguments);return new Ta(d,new b("",1,!1,!1,function(){return types.effectDoNothing()}),db?Math.max(jsnums.toFixnum(e),jsnums.toFixnum(Qa)):e)})]);c["on-tick!"]=new z("on-tick!",[new b("on-tick!",2,!1,!1,function(b,d,c){l(b,d,k,"on-tick!","function",1,arguments);j(b,"on-tick!",1,d.numParams);l(b,c,k,"on-tick!","function",2,arguments);return new Ta(d,
c,Qa)}),new b("on-tick!",3,!1,!1,function(b,d,c,e){l(b,d,k,"on-tick!","function",1,arguments);j(b,"on-tick!",1,d.numParams);l(b,c,k,"on-tick!","function",2,arguments);l(b,e,M,"on-tick!","non-negative number",3,arguments);return new Ta(d,c,db?Math.max(jsnums.toFixnum(e),jsnums.toFixnum(Qa)):e)})]);c["on-tap"]=new b("on-tap",1,!1,!1,Y("on-tap","onTap",3));c["on-tilt"]=new b("on-tilt",1,!1,!1,Y("on-tilt","onTilt",3));c["on-key"]=new b("on-key",1,!1,!1,Y("on-key","onKey",2));c["on-key!"]=new b("on-key!",
2,!1,!1,na("on-key!","onKey"));c["on-mouse"]=new b("on-mouse",1,!1,!1,Y("on-mouse","onMouse",4));c["mouse-event?"]=new b("mouse-event?",1,!0,!1,function(b,d){return fb(d)});c["mouse=?"]=new b("mouse=?",2,!0,!1,function(b,d,c){l(b,d,fb,"mouse-event?","mouse-event",1);l(b,c,fb,"mouse-event?","mouse-event",2);return d===c});c["stop-when"]=new z("stop-when",[new b("stop-when",1,!1,!1,function(b,d){l(b,d,k,"stop-when","function",1);j(b,"stop-when",1,d.numParams);return new lb(d,null)}),new b("stop-when",
2,!1,!1,function(b,d,c){l(b,d,k,"stop-when","function",1);j(b,"stop-when",1,d.numParams);l(b,c,k,"stop-when","function",2);return new lb(d,c)})]);c["stop-when!"]=new b("stop-when!",2,!1,!1,na("stop-when!","stopWhen"));c["on-redraw"]=new b("on-redraw",1,!1,!1,function(b,d){l(b,d,k,"on-redraw","function",1);j(b,"on-redraw",1,d.numParams);return new Oa(d)});c["to-draw"]=new b("to-draw",1,!1,!1,function(b,d){l(b,d,k,"to-draw","function",1);j(b,"to-draw",1,d.numParams);return new Oa(d)});c["on-draw"]=
new z("on-draw",[new b("on-draw",1,!1,!1,function(b,d){l(b,d,k,"on-draw","function",1);j(b,"on-draw",1,d.numParams);return new (aa.extend({init:function(){this._super("on-draw")},configure:function(b){return b.updateAll({onDraw:d})}}))}),new b("on-draw",2,!1,!1,function(b,d,c){l(b,d,k,"on-draw","function",1,arguments);l(b,c,k,"on-draw","function",2,arguments);j(b,"on-draw",1,d.numParams);return new (aa.extend({init:function(){this._super("on-draw")},configure:function(b){return b.updateAll({onDraw:d,
onDrawCss:c})}}))})]);c["initial-effect"]=new b("initial-effect",1,!1,!1,function(b,d){return new (aa.extend({init:function(){this._super("initial-effect")},configure:function(b){return b.updateAll({initialEffect:d})}}))});var mb=function(b){Aa(void 0,b,function(b){return ra(b)&&2==t(b)},"js-p","list of (list of X Y)",1);var b=da(b),d=jsworld.MobyJsworld.p(b);d.toWrittenString=function(){return"(js-p)"};d.toDisplayedString=d.toWrittenString;d.toDomNode=function(){return d};return helpers.wrapJsObject(d)};
c["js-p"]=new z("js-p",[new b("js-p",0,!1,!1,function(){return mb(types.EMPTY)}),new b("js-p",1,!1,!1,function(b,d){return mb(d)})]);var eb=function(b){Aa(void 0,b,Ea,"js-div","(listof X Y)",1);var b=da(b),d=jsworld.MobyJsworld.div(b);d.toWrittenString=function(){return"(js-div)"};d.toDisplayedString=d.toWrittenString;d.toDomNode=function(){return d};return helpers.wrapJsObject(d)};c["js-div"]=new z("js-div",[new b("js-div",0,!1,!1,function(){return eb(types.EMPTY)}),new b("js-div",1,!1,!1,function(b,
d){return eb(d)})]);var ab=function(b){return function(d,c,e,g){l(d,c,k,b,"function",1);l(d,e,k,b,"function",2);Aa(void 0,g,Ea,b,"(listof X Y)",3);var d=g?da(g):{},j=jsworld.MobyJsworld.buttonBang(c,e,d);j.toWrittenString=function(){return"("+b+" ...)"};j.toDisplayedString=j.toWrittenString;j.toDomNode=function(){return j};return helpers.wrapJsObject(j)}},Ma=function(b,d,c){var e=new types.PrimProc("",1,!1,!1,function(){return types.EMPTY});return ab("js-button")(b,d,e,c)};c["js-button"]=new z("js-button",
[new b("js-button",1,!1,!1,function(b,d){return Ma(b,d)}),new b("js-button",2,!1,!1,function(b,d,c){return Ma(b,d,c)})]);c["js-button!"]=new z("js-button!",[new b("js-button!",2,!1,!1,ab("js-button!")),new b("js-button!",3,!1,!1,ab("js-button!"))]);var Da=function(b,d,c){l(aState,b,D,"js-input","string",1);l(aState,d,k,"js-input","function",2);Aa(void 0,c,Ea,"js-input","(listof X Y)",3);var c=c?da(c):{},e=jsworld.MobyJsworld.input(b,d,c);e.toWrittenString=function(){return"(js-input ...)"};e.toDisplayedString=
e.toWrittenString;e.toDomNode=function(){return e};return helpers.wrapJsObject(e)};c["js-input"]=new z("js-input",[new b("js-input",2,!1,!1,function(b,d,c){return Da(d,c)}),new b("js-input",3,!1,!1,function(b,d,c,e){return Da(d,updateF,e)})]);var nb=function(b,d){l(aState,b,D,"js-img","string",1);Aa(void 0,d,Ea,"js-img","(listof X Y)",2);var c=da(d),e=jsworld.MobyJsworld.img(b,c);e.toWrittenString=function(){return"(js-img ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(){return e};
return helpers.wrapJsObject(e)};c["js-img"]=new z("js-img",[new b("js-img",1,!1,!1,function(b,d){return nb(d,types.EMPTY)}),new b("js-img",2,!1,!1,function(b,d,c){return nb(d,c)})]);c["js-text"]=new b("js-text",1,!1,!1,function(b,d){l(b,d,D,"js-text","string",1);var c=jsworld.MobyJsworld.text(d,[]);c.toWrittenString=function(){return"(js-text ...)"};c.toDisplayedString=c.toWrittenString;c.toDomNode=function(){return c};return helpers.wrapJsObject(c)});var La=function(b,d,c){Aa(void 0,b,D,"js-select",
"listof string",1);l(aState,d,k,"js-select","function",2);Aa(void 0,c,Ea,"js-select","(listof X Y)",3);var c=c?da(c):{},b=helpers.deepListToArray(b),e=jsworld.MobyJsworld.select(b,d,c);e.toWrittenString=function(){return"(js-select ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(){return e};return helpers.wrapJsObject(e)};c["js-select"]=new z("js-select",[new b("js-select",2,!1,!1,function(b,d,c){return La(d,c)}),new b("js-select",3,!1,!1,function(b,c,e,k){return La(c,e,k)})]);c["big-bang"]=
c["js-big-bang"]=new b("big-bang",1,!0,!1,function(b,c,e){R(e,function(k,h){l(b,k,function(b){return b instanceof aa||ra(b)||types.isWorldConfig(b)},"big-bang","handler",h+2,[b,c].concat(e))});var k=helpers.map(function(b){return b instanceof aa?function(c){return b.configure(c)}:b},e);return y(function(e,g){var j,l=function(){j.breaker()};b.addBreakRequestedListener(l);j=jsworld.MobyJsworld.bigBang(c,b.getToplevelNodeHook()(),k,g,function(c){b.removeBreakRequestedListener(l);e(c)})})});c.animate=
new b("animate",1,!1,!1,function(e,d){l(e,d,k,"animate","function",1);l(e,d,m(1),"animate","1-argument function",1);var g=[new Ta(c.add1,new b("",1,!1,!1,function(){return types.effectDoNothing()}),Qa),new Oa(d)],h=helpers.map(function(b){return b instanceof aa?function(c){return b.configure(c)}:b},g);return y(function(b,c){var d,k=function(){d.breaker()};e.addBreakRequestedListener(k);d=jsworld.MobyJsworld.bigBang(1,e.getToplevelNodeHook()(),h,c,function(c){e.removeBreakRequestedListener(k);b(c)})})});
var jb=function(b){Aa(void 0,b,Ea,"empty-page","(listof X Y)",1);b=da(b);return jsworld.MobyJsworld.emptyPage(b)};c["empty-page"]=new z("empty-page",[new b("empty-page",0,!1,!1,function(){return jb(types.EMPTY)}),new b("empty-page",1,!1,!1,function(b,c){return jb(c)})]);c["place-on-page"]=new b("empty-page",4,!1,!1,function(b,c,e,k,g){return jsworld.MobyJsworld.placeOnPage(c,e,k,g)});c["make-world-config"]=new b("make-world-config",2,!0,!1,function(b,c,e,h){var g=[c,e].concat(h);l(b,c,k,"make-world-config",
"function",1,g);l(b,e,m(1),"make-world-config","function (arity 1)",2,g);R(h,function(c,d){l(b,c,k,"make-world-config","handler",d+3,g)});m(h.length)(c)||C(types.incompleteExn(types.exnFailContract,"make-world-config: 1st argument must have arity equal to the number of arguments after the second",[]));return types.worldConfig(c,e,h)});c["make-effect-type"]=Wa("make-effect-type",4,[!1],!1,function(b,c,e,h,g,j,w){l(c,e,fa,"make-effect-type","string",1,b);l(c,h,function(b){return!1===b||types.isEffectType(b)},
"make-effect-type","effect type or #f",2,b);l(c,g,H,"make-effect-type","exact non-negative integer",3,b);l(c,j,k,"make-effect-type","function",4,b);l(c,w,function(b){return!1===b||k(b)},"make-effect-type","procedure or #f",6,b);b=g+1+(h?h.numberOfArgs:0);w&&!m(b)(w)&&C(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,w]),[]));w=w?ga(c,w):!1;c=types.makeEffectType(e.toString(),
h,g,j,w,X(c));return W(c)});c["effect-type?"]=new b("effect-type?",1,!1,!1,function(b,c){return types.isEffectType(c)});c["effect?"]=new b("effect?",1,!1,!1,function(b,c){return types.isEffect(c)});c["make-render-effect-type"]=Wa("make-render-effect-type",4,[!1],!1,function(b,c,e,h,g,j,w){l(c,e,fa,"make-render-effect-type","string",1,b);l(c,h,function(b){return!1===b||types.isEffectType(b)},"make-render-effect-type","effect type or #f",2,b);l(c,g,H,"make-render-effect-type","exact non-negative integer",
3,b);l(c,j,k,"make-render-effect-type","function",4,b);l(c,w,function(b){return!1===b||k(b)},"make-render-effect-type","procedure or #f",6,b);b=g+1+(h?h.numberOfArgs:0);w&&!m(b)(w)&&C(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,w]),[]));c=w?ga(c,w):!1;e=types.makeRenderEffectType(e.toString(),h,g,j,c);return W(e)});c["render-effect-type?"]=new b("render-effect-type?",
1,!1,!1,function(b,c){return types.isRenderEffectType(c)});c["render-effect?"]=new b("render-effect?",1,!1,!1,function(b,c){return types.isRenderEffect(c)});c["world-with-effects"]=new b("world-with-effects",2,!1,!1,function(b,c,e){l(b,c,$a,"world-with-effects","compound effect",1,arguments);return jsworld.Jsworld.with_multiple_effects(e,helpers.flattenSchemeListToArray(c))});c["make-render-effect"]=new b("make-render-effect",2,!1,!1,function(b,c,e){return types.makeRenderEffect(c,e)});c["render-effect?"]=
new b("render-effect?",1,!1,!1,function(b,c){return types.isRenderEffect(c)});c["render-effect-dom-node"]=new b("render-effect-dom-node",1,!1,!1,function(b,c){l(b,c,types.isRenderEffect,"render-effect-dom-node","render-effect",1);return types.renderEffectDomNode(c)});c["render-effect-effects"]=new b("render-effect-effects",1,!1,!1,function(b,c){l(b,c,types.isRenderEffect,"render-effect-effects","render-effect",1);return types.renderEffectEffects(c)});c["scheme->prim-js"]=new b("scheme->prim-js",1,
!1,!1,function(b,c){l(b,c,function(b){return N(b)||D(b)||fa(b)||ba(b)||qa(b)||oa(b)},"scheme->prim-js","real number, string, symbol, char, boolean, or vector",1);var e;N(c)?(!jsnums.equals(c,jsnums.nan)&&!jsnums.equals(c,jsnums.inf)&&!jsnums.equals(c,jsnums.negative_inf)&&(jsnums.greaterThan(c,9E15)||jsnums.lessThan(c,-9E15))&&C(types.incompleteExn(types.exnFailContract,helpers.format("scheme->primitive-js: only numbers in [-9e15, 9e15] are accurately representable in javascript; given: ~s",[c]),
[])),e=jsnums.toFixnum(c)):D(c)?e=c.toString():fa(c)||ba(c)?e=c.val:qa(c)?e=c:oa(c)&&(e=c.elts.slice(0));return helpers.wrapJsObject(e)});c["prim-js->scheme"]=new b("prim-js->scheme",1,!1,!1,function(c,d){l(c,d,function(b){return Ia(b)&&("number"==typeof b.obj||"string"==typeof b.obj||"boolean"==typeof b.obj||"function"==typeof b.obj||b.obj instanceof Array)},"prim-js->scheme","javascript number, string, boolean, function, or array",1);if("number"===typeof d.obj)return types["float"](d.obj);if("string"===
typeof d.obj||"boolean"===typeof d.obj)return d.obj;if("function"===typeof d.obj)return new b("",0,!0,!1,function(b){return d.obj.apply(null,b)});if(d.obj instanceof Array)return types.vector(d.obj.slice(0))});c["procedure->cps-js-fun"]=new b("procedure->cps-js-fun",1,!1,!1,function(b,c){l(b,c,k,"procedure->cps-js-fun","function",1);var e=X(b);return types.jsObject(c.name+" (cps)",function(){var b=helpers.map(helpers.wrapJsObject,arguments),k=0==b.length?function(){}:b.shift();e(c,b,k)})});c["procedure->void-js-fun"]=
new b("procedure->void-js-fun",1,!1,!1,function(b,c){l(b,c,k,"procedure->void-js-fun","function",1);var e=X(b);return types.jsObject(c.name+" (void)",function(){var b=helpers.map(helpers.wrapJsObject,arguments);e(c,b,function(){})})});c["js-==="]=new b("js-===",2,!1,!1,function(b,c,e){l(b,c,Ia,"js-===","javascript value",1);l(b,e,Ia,"js-===","javascript value",2);return c.obj===e.obj});c["js-get-named-object"]=new b("js-get-named-object",1,!1,!1,function(b,c){l(b,c,D,"js-get-named-object","string",
1);var e=c.toString();return types.jsObject(e,"window"===e?window:window[e])});c["js-get-field"]=new b("js-get-field",2,!0,!1,function(b,c,e,k){k.unshift(e);var g=[c].concat(k);l(b,c,Ia,"js-get-field","js-object",1,g);R(k,function(c,d){l(b,c,D,"js-get-field","string",d+2,g)});for(var e=[c.name],c=c.obj,j=0;j<k.length;j++){if(void 0===c){var m=e.join("");C(types.incompleteExn(types.exnFailContract,helpers.format("js-get-field: tried to access field ~a of ~a, but ~a was undefined",[k[j],m,m]),[]))}e.push('["'+
k[j].toString()+'"]');c=c[k[j].toString()]}return types.jsObject(e.join(""),c)});c["js-set-field!"]=new b("js-set-field!",3,!1,!1,function(b,c,e,k){l(b,c,function(b){return Ia(b)&&"object"==typeof b.obj},"js-set-field!","javascript object",1,arguments);l(b,e,D,"js-set-field!","string",2,arguments);c.obj[e.toString()]=Ia(k)?k.obj:k;return types.VOID});c["js-typeof"]=new b("js-typeof",1,!1,!1,function(b,c){l(b,c,Ia,"js-typeof","js-object",1);return typeof c.obj});c["js-instanceof"]=new b("js-instanceof",
2,!1,!1,function(b,c,e){l(b,c,Ia,"js-instanceof","js-object",1,arguments);l(b,e,Ja,"js-instanceof","javascript function",2,arguments);return c.obj instanceof e.obj});c["js-call"]=new b("js-call",2,!0,!1,function(b,c,e,k){var g=[c,e].concat(k);l(b,c,Ja,"js-call","javascript function",1,g);l(b,e,function(b){return!1===b||Ia(b)&&"object"==typeof b.obj},"js-call","javascript object or false",2,g);b=helpers.map(function(b){return Ia(b)?b.obj:b},k);c=c.obj.apply(e?e.obj:null,b);return void 0===c?types.VOID:
helpers.wrapJsObject(c)});c["js-new"]=new b("js-new",1,!0,!1,function(b,c,e){xa(b,c,Ja,"js-new","javascript function",1);var k=helpers.map(function(b){return Ia(b)?b.obj:b},e),b=function(){c.obj.apply(this,k)};b.prototype=c.obj.prototype;return helpers.wrapJsObject(new b)});c["js-make-hash"]=new z("js-make-hash",[new b("js-make-hash",0,!1,!1,function(){return types.jsObject("hash",{})}),new b("js-make-hash",1,!1,!1,function(b,c){Aa(b,c,function(b){return Ea(b)&&D(b.first())},"js-make-hash","(listof string X)",
1);for(var e={};!c.isEmpty();){var k=c.first().first().toString(),g=c.first().rest().first();e[k]=Ia(g)?g.obj:g;c=c.rest()}return types.jsObject("hash",e)})]);c.eof=types.EOF;c.e=jsnums.e;c.empty=types.EMPTY;c["false"]=!1;c["true"]=!0;c.pi=jsnums.pi;c["null"]=types.EMPTY;c["empty-image"]=world.Kernel.sceneImage(0,0,[],!0);c["js-undefined"]=types.jsObject("undefined",void 0);c["js-null"]=types.jsObject("null",null);primitive.getPrimitive=function(b){return c[b]};primitive.isPrimitive=function(c){return c instanceof
b};primitive.addPrimitive=function(b,d){c[b]=d};primitive.Primitive=b;primitive.CasePrimitive=z;primitive.setCALL=function(b){F=function(c,e,k){return new b(c,e,k)}};primitive.setPAUSE=function(b){y=function(c){return new b(c)}}})();var control={};
(function(){var j=function(b){this.depth=b};j.prototype.invoke=function(b){debug("SET "+this.depth);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",b.captureCurrentContinuationMarks(aState));b.setn(this.depth,b.v)};var F=function(b){this.n=b};F.prototype.invoke=function(b){b.pushn(this.n)};var y=function(b){this.depth=b};y.prototype.invoke=function(b){debug("SWAP "+this.depth);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",
b.captureCurrentContinuationMarks(aState));var c=b.vstack[b.vstack.length-1-(this.depth||0)];b.vstack[b.vstack.length-1-(this.depth||0)]=b.v;b.v=c};var c=function(b){this.n=b};c.prototype.invoke=function(b){b.popn(this.n)};var b=function(b,c){this.prefix=b;this.body=c};b.prototype.invoke=function(b){z(b,this.prefix);var c=[],e;for(e=0;e<this.body.length;e++)c.push(this.body[e]);b.pushManyControls(c)};var z=function(b,c){for(var e=c.numLifts,g=new types.PrefixValue,j=0;j<c.toplevels.length+e;j++){var m=
c.toplevels[j];if(!1===m)g.addSlot();else if("module-variable"===m.$){var p=b,q=g,t=m,m=t.modidx.path,t=t.sym+"",u=primitive.getPrimitive(t,m);p.globals[t]="undefined"!==typeof u?new types.GlobalBucket(t,u):new types.GlobalBucket(t,new types.ModuleVariableRecord(m,t));q.addSlot(p.globals[t])}else if("global-bucket"===m.$)p=b,q=g,m=m.value+"",p.globals[m]||(p.globals[m]=new types.GlobalBucket(m,types.UNDEFINED)),q.addSlot(p.globals[m]);else throw types.internalError("unable to install toplevel element "+
m,state.captureCurrentContinuationMarks(b));}b.vstack.push(g)},I=function(b){this.value=b};I.prototype.invoke=function(b){b.v=this.value};var B=function(b,c,e){this.test=b;this.thenPart=c;this.elsePart=e};B.prototype.invoke=function(b){var c=[];c.push(this.test);c.push(new e(this.thenPart,this.elsePart));b.pushManyControls(c)};var e=function(b,c){this.thenPart=b;this.elsePart=c};e.prototype.invoke=function(b){debug("BRANCH");!1!==b.v&&void 0!==b.v?b.pushControl(this.thenPart):b.pushControl(this.elsePart)};
var u=function(b){this.name=b};u.prototype.invoke=function(b){var c=this;throw new Z(function(e){if(b.invokedModules[c.name])e(types.VOID);else{var g=function(b){return"undefined"!==typeof window.COLLECTIONS&&window.COLLECTIONS[b]},j=function(){e(types.schemeError(types.incompleteExn(types.exn,"unable to load "+c.name+": it isn't in the set of known collections",[])))};g(c.name)?m(b,window.COLLECTIONS[c.name],e):b.hooks.dynamicModuleLoader(c.name,function(){g(c.name)?m(b,window.COLLECTIONS[c.name],
e):j()},j)}});};var m=function(b,c,e){b.clearForEval({preserveBreak:!0,clearGlobals:!0});interpret.load(c.bytecode,b);interpret.run(b,function(){for(var g={},j=0;j<c.provides.length;j++){var m=c.provides[j],p=b.globals[m];if(p)g[m]=p.value;else{e(types.schemeError(types.exn("module "+c.name+" is missing an expected definition for "+m)));return}}b.invokedModules[c.name]={record:c,providedValues:g};e(types.VOID)},function(b){e(b)})},t=function(b){this.forms=b};t.prototype.invoke=function(b){for(var c=
this.forms,e=[],g=0;g<c.length;g++)e.push(c[g]);b.pushManyControls(e)};var q=function(b){this.seq=b};q.prototype.invoke=function(b){if(1===this.seq.length)b.pushControl(this.seq[0]);else{for(var c=[],e=1;e<this.seq.length;e++)c.push(this.seq[e]);b.pushManyControls([this.seq[0],new L(c)])}};var L=function(b){this.rest=b};L.prototype.invoke=function(b){b.pushControl(new I(b.v));b.pushManyControls(this.rest)};var V=function(b,c,e){this.depth=b;this.pos=c;this.loc=e};V.prototype.invoke=function(b){b.v=
b.refPrefix(this.depth,this.pos,this.loc)};var $=function(b,c){this.pos=b;this.isUnbox=c};$.prototype.invoke=function(b){var c=b.peekn(this.pos);this.isUnbox&&(c=c.unbox());b.v=c};var S=function(b){this.name=b+""};S.prototype.invoke=function(b){var c=primitive.getPrimitive(this.name,void 0);if(!c)throw types.internalError("Primitive "+this.name+" not implemented!",state.captureCurrentContinuationMarks(b));b.v=c};var ya=function(b){this.name=b.name;this.locs=b.locs;this.numParams=b.numParams;this.paramTypes=
b.paramTypes;this.isRest=b.isRest;this.closureMap=b.closureMap;this.closureTypes=b.closureTypes;this.body=b.body};ya.prototype.invoke=function(b){b.v=new types.ClosureValue(this.name,this.locs,this.numParams,this.paramTypes,this.isRest,aa(b,this.closureMap,this.closureTypes),this.body)};var aa=function(b,c){for(var e=[],g=0;g<c.length;g++){var j;j=b.peekn(c[g]);e.push(j)}return e},Y=function(b,c){this.procs=b;this.body=c};Y.prototype.invoke=function(b){for(var c=[],e=this.procs.length,g=0;g<e;g++)c.push(this.procs[g]),
c.push(new j(e-1-g));c.push(new na(this.procs));c.push(this.body);b.pushManyControls(c)};var na=function(b){this.procs=b};na.prototype.invoke=function(b){for(var c=this.procs.length,e=0;e<c;e++){var g=this.procs[e];b.peekn(c-1-e).closureVals=aa(b,g.closureMap,g.closureTypes)}};var da=function(b,c){this.ids=b;this.body=c};da.prototype.invoke=function(b){var c=[];c.push(this.body);c.push(new C(this.ids));b.pushManyControls(c)};var C=function(b){this.ids=b};C.prototype.invoke=function(b){debug("DEF_VALUES");
state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");var c=b.v;if(c instanceof types.ValuesWrapper){this.ids.length!==c.elts.length&&helpers.raise(types.exnFailContractArity("define-values: expected "+this.ids.length+" values, but received "+c.elts.length,state.captureCurrentContinuationMarks(b)));for(var e=0;e<this.ids.length;e++)b.setPrefix(this.ids[e].depth,this.ids[e].pos,c.elts[e])}else 1!==this.ids.length?helpers.raise(types.exnFailContractArity("define-values: expected "+
this.ids.length+" values, but only received one: "+c,state.captureCurrentContinuationMarks(b))):b.setPrefix(this.ids[0].depth,this.ids[0].pos,c)};var X=function(b,c){this.rator=b;this.rands=c};X.prototype.invoke=function(b){var c=this.rator,e=this.rands,g=[];0!==e.length&&g.push(new F(e.length));g.push(c);0!==e.length&&g.push(new j(e.length-1));for(c=0;c<e.length;c++)c!==e.length-1?(g.push(e[c]),g.push(new j(c))):(g.push(e[e.length-1]),g.push(new y(e.length-1)));g.push(new ga(e.length));b.pushManyControls(g)};
var ga=function(b){this.n=b};ga.prototype.invoke=function(b){debug("CALL "+this.n);var c=b.popn(this.n),e=b.v,g=this.n,e=Ba(b,g,e,c);e.callProcedure(b,e,g,c)};var ka=function(b,e,g,j){0!==b.cstack.length&&b.cstack[b.cstack.length-1]instanceof c&&b.cstack.pop().invoke(b);var m=[];m.push(b);if(g<e.numParams)var p;if(e.isRest){for(p=0;p<e.numParams;p++)m.push(j.shift());var q=[];for(p=0;p<g-e.numParams;p++)q.push(j.shift());m.push(q)}else for(p=0;p<e.numParams;p++)m.push(j.shift());g=e.impl.apply(e.impl,
m);ta(b,g,e)},ta=function(b,c,e){if(c instanceof ca){b.cstack.push(new ha(c.k,e));var e=c.operands.length,g,j=[types.NoLocation];for(g=0;g<e;g++)j.push(types.NoLocation);aHash={};aHash["moby-application-position-key"]=types.list(j);b.pushControl(types.contMarkRecordControl(aHash));e=c.operator;g=c.operands.length;c=c.operands;e=Ba(b,g,e,c);e.callProcedure(b,e,g,c)}else{if(c instanceof W)throw new Z(c.onPause);e.assignsToValueRegister||(b.v=c)}},Z=function(b){this.onPause=b},ca=function(b,c,e){this.operator=
b;this.operands=c;this.k=e},ha=function(b,c){this.k=b;this.procValue=c};ha.prototype.invoke=function(b){ta(b,this.k(b.v),this.procValue)};primitive.setCALL(ca);var W=function(b){this.onPause=b};primitive.setPAUSE(W);var K=function(b,e,g,j){0!==b.cstack.length&&b.cstack[b.cstack.length-1]instanceof c?(b.cstack.pop().invoke(b),g=p(b,e,j,g),b.pushControl(new c(g))):2<=b.cstack.length&&types.isContMarkRecordControl(b.cstack[b.cstack.length-1])&&b.cstack[b.cstack.length-2]instanceof c?(b.cstack[b.cstack.length-
2].invoke(b),g=p(b,e,j,g),b.cstack[b.cstack.length-2]=new c(g)):(g=p(b,e,j,g),b.pushControl(new c(g)));b.pushControl(e.body)},N=function(b,c,e,g){b.v=1===e?g[0]:new types.ValuesWrapper(g);b.vstack=c.vstack;b.cstack=c.cstack},Ba=function(b,c,e,g){var j=function(){var b="";if(0<g.length){for(var b=[":"],c=0;c<g.length;c++)b.push(types.toWrittenString(g[c]));b=b.join(" ")}return b},m=function(b){var c=[];if(0<g.length)for(var e=0;e<g.length;e++)c.push(new types.ColoredPart(g[e]+(e<g.length-1?" ":""),
b.first())),b=b.rest();return c},p=types.getProcedureType(e);if(!p){j("; arguments were:");for(var j=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),q=j=j[j.length-1],t;!q.isEmpty();)t=q.first().elts,q=q.rest();q=m(j.rest());q=types.vector([t[0],t[1],t[2],t[3],1]);t=types.vector([t[0],t[1]+t[4]-1,t[2],t[3]+t[4]-1,1]);var u=e.toWrittenString?e.toWrittenString():e.toString();helpers.raise(types.incompleteExn(types.exnFailContract,new types.Message([new types.MultiPart("function call",
[q,t],!0),": expected function, given: ",new types.ColoredPart(u,j.first())]),[]))}if("CaseLambdaValue"===p){for(j=0;j<e.closures.length;j++)if(c===e.closures[j].numParams||c>e.closures[j].numParams&&e.closures[j].isRest)return e.closures[j]=K,e.closures[j];t=[];for(j=0;j<e.closures.length;j++)t.push(e.closures[j].numParams+"");j=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");j=j[j.length-1];q=m(j.rest());helpers.raise(types.incompleteExn(types.exnFailContractArity,
new types.Message([new types.ColoredPart(e.name?e.name:"#<case-lambda-procedure>",j.first()),": expects [",t.join(", "),"] arguments, but given ",c,new types.GradientPart(q)]),[]))}else if("CasePrimitive"===p){for(j=0;j<e.cases.length;j++)if(c===e.cases[j].numParams||c>e.cases[j].numParams&&e.cases[j].isRest)return e.cases[j].callProcedure=ka,e.cases[j];t=[];for(j=0;j<e.cases.length;j++)t.push(e.cases[j].numParams+"");j=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");
j=j[j.length-1];q=m(j.rest());helpers.raise(types.incompleteExn(types.exnFailContractArity,new types.Message([new types.ColoredPart(e.name,j.first()),": expects ",t.join(" or ")," arguments, but given ",c,0<q.length?": ":"",0<q.length?new types.GradientPart(q):""]),[]))}if("ContinuationClosureValue"===p)return e.callProcedure=N,e;if(c===e.numParams||c>e.numParams&&e.isRest)return e.callProcedure=primitive.isPrimitive(e)?ka:K,e;j=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");
j=j[j.length-1];q=m(j.rest());helpers.raise(types.incompleteExn(types.exnFailContractArityWithPosition,new types.Message([new types.ColoredPart(""+(e.name!==types.EMPTY?e.name:"anonymous function"),j.first()),": expects ",""+(e.isRest?"at least ":""),void 0!=e.locs?new types.MultiPart(e.numParams+" argument"+(1==e.numParams?"":"s"),e.locs.slice(1),!1):e.numParams+" argument"+(1==e.numParams?"":"s"),", but given ",c,0<q.length?": ":"",0<q.length?new types.GradientPart(q):""]),[]))},p=function(b,c,
e,g){var j=0;if(c.isRest){var m=types.EMPTY,p;for(p=0;p<g-c.numParams;p++)m=types.cons(e.pop(),m);b.pushValue(m);j++}for(p=e.length-1;0<=p;p--)b.pushValue(e[p]),j++;for(p=c.closureVals.length-1;0<=p;p--)b.pushValue(c.closureVals[p]),j++;return j},H=function(b,c,e){this.key=b;this.val=c;this.body=e};H.prototype.invoke=function(b){var c=[];c.push(this.key);c.push(new M(this.val,this.body));b.pushManyControls(c)};var M=function(b,c){this.val=b;this.body=c};M.prototype.invoke=function(b){var c=b.v,e=
[];e.push(this.val);e.push(new G(c,this.body));b.pushManyControls(e)};var G=function(b,c){this.key=b;this.body=c};G.prototype.invoke=function(b){var c=b.v;if(0!==b.cstack.length&&types.isContMarkRecordControl(b.cstack[b.cstack.length-1]))b.pushControl(b.cstack.pop().update(this.key,c));else{var e={};e[this.key.val]=c;b.pushControl(types.contMarkRecordControl(e))}b.pushControl(this.body)};var g=function(b,c){this.proc=b;this.argsExpr=c};g.prototype.invoke=function(b){var c=[];c.push(this.proc);c.push(new T(this.argsExpr));
b.pushManyControls(c)};var T=function(b){this.expr=b};T.prototype.invoke=function(b){var c=[];c.push(this.expr);c.push(new fa(b.v));b.pushManyControls(c)};var fa=function(b){this.procVal=b};fa.prototype.invoke=function(b){var c=b.v;b.v=this.procVal;if(c instanceof types.ValuesWrapper){for(var e=c.elts,c=e.length-1;0<=c;c--)b.pushValue(e[c]);b.pushControl(new ga(e.length))}else b.pushValue(c),b.pushControl(new ga(1))};var ba=function(b,c){this.rhs=b;this.body=c};ba.prototype.invoke=function(b){var e=
[];b.pushn(1);e.push(this.rhs);e.push(new j(0));e.push(this.body);e.push(new c(1));b.pushManyControls(e)};var D=function(b){this.count=b.count;this.isBoxes=b.isBoxes;this.body=b.body};D.prototype.invoke=function(b){var e=[],g=this.count;b.pushn(g);if(this.isBoxes)for(var j=0;j<g;j++)b.setn(j,types.box(types.UNDEFINED));e.push(this.body);e.push(new c(g));b.pushManyControls(e)};var P=function(b,c){this.pos=b;this.body=c};P.prototype.invoke=function(b){b.setn(this.pos,types.box(b.peekn(this.pos)));b.pushControl(this.body)};
var ra=function(b){this.count=b.count;this.pos=b.pos;this.isBoxes=b.isBoxes;this.rhs=b.rhs;this.body=b.body};ra.prototype.invoke=function(b){var c=[];c.push(this.rhs);c.push(new ua(this.count,this.pos,this.isBoxes,this.body));b.pushManyControls(c)};var ua=function(b,c,e,g){this.count=b;this.pos=c;this.isBoxes=e;this.body=g};ua.prototype.invoke=function(b){var c=b.v,e=[];c instanceof types.ValuesWrapper?(this.count!==c.elts.length&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received "+
c.elts.length,b.captureCurrentContinuationMarks(aState))),e=c.elts):(1!==this.count&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received one",b.captureCurrentContinuationMarks(aState))),e=[c]);if(this.isBoxes)for(c=0;c<this.count;c++)b.peekn(c+this.pos).set(e[c]);else for(c=0;c<this.count;c++)b.setn(c+this.pos,e[c]);b.pushControl(this.body)};var oa=function(b){this.id=b.id;this.rhs=b.rhs;this.isUndefOk=b.isUndefOk};oa.prototype.invoke=function(b){var c=[];c.push(this.rhs);
c.push(new Fa(this.id.depth,this.id.pos,this.isUndefOk));b.pushManyControls(c)};var Fa=function(b,c,e){this.depth=b;this.pos=c;this.isUndefOk=e};Fa.prototype.invoke=function(b){debug("SET_TOPLEVEL "+this.depth+", "+this.pos);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",state.captureCurrentContinuationMarks(b));b.setPrefix(this.depth,this.pos,b.v)};var ia=function(b){this.toplevel=b};ia.prototype.invoke=function(b){b.v=new types.VariableReference(b.vstack[b.vstack.length-
1-this.toplevel.depth],this.toplevel.pos)};var za=function(b){this.genId=b+""};za.prototype.invoke=function(b){b.v=b.heap[this.genId]};var pa=function(b,c){this.name=b;this.clauses=c};pa.prototype.invoke=function(b){var c=this.clauses;0===c.length?b.v=new types.CaseLambdaValue(this.name,[]):(b.pushControl(new qa(this.name,types.list(c).rest(),types.list([]))),b.pushControl(c[0]))};var qa=function(b,c,e){this.name=b;this.lamsToEvaluate=c;this.evaluatedLams=e};qa.prototype.invoke=function(b){var c=
b.v;if(this.lamsToEvaluate.isEmpty()){for(var c=types.cons(c,this.evaluatedLams).reverse(),e=[];!c.isEmpty();)e.push(c.first()),c=c.rest();b.v=new types.CaseLambdaValue(this.name,e)}else b.pushControl(new qa(this.name,this.lamsToEvaluate.rest(),types.cons(c,this.evaluatedLams))),b.pushControl(this.lamsToEvaluate.first())};control.processPrefix=z;control.ConstantControl=I;control.BranchControl=B;control.SeqControl=t;control.Beg0Control=q;control.ModControl=b;control.Prefix=function(b){this.numLifts=
b.numLifts;this.toplevels=b.toplevels};control.ToplevelControl=V;control.DefValuesControl=da;control.LamControl=ya;control.PrimvalControl=S;control.ApplicationControl=X;control.LocalrefControl=$;control.ApplyValuesControl=g;control.LetOneControl=ba;control.LetVoidControl=D;control.BoxenvControl=P;control.InstallValueControl=ra;control.WithContMarkControl=H;control.AssignControl=oa;control.VarrefControl=ia;control.ClosureControl=za;control.CaseLamControl=pa;control.LetRecControl=Y;control.CallControl=
ga;control.RequireControl=u;control.PauseException=Z})();var loader={};
(function(){var j=function(c,b){switch(b.$){case "mod":return new control.ModControl(y(b.prefix),F(c,b.body));case "def-values":return new control.DefValuesControl(b.ids,j(c,b.body));case "indirect":return new control.ConstantControl(c.heap[b.value]);case "apply-values":return new control.ApplyValuesControl(j(c,b.proc),j(c,b["args-expr"]));case "toplevel":return new control.ToplevelControl(b.depth,b.pos,b.loc);case "constant":return new control.ConstantControl(b.value);case "req":return new control.RequireControl(b.reqs+
"");case "seq":return new control.SeqControl(F(c,b.forms));case "application":return new control.ApplicationControl(j(c,b.rator),F(c,b.rands));case "localref":return new control.LocalrefControl(b.pos,b["unbox?"]);case "primval":return new control.PrimvalControl(b.value);case "branch":return new control.BranchControl(j(c,b.test),j(c,b.then),j(c,b["else"]));case "lam":return new control.LamControl({name:b.name,locs:b.locs,numParams:b["num-params"],paramTypes:b["param-types"],isRest:b["rest?"],closureMap:b["closure-map"],
closureTypes:b["closure-types"],body:j(c,b.body)});case "let-one":return new control.LetOneControl(j(c,b.rhs),j(c,b.body));case "let-void":return new control.LetVoidControl({count:b.count,isBoxes:b["boxes?"],body:j(c,b.body)});case "beg0":return new control.Beg0Control(F(c,b.seq));case "boxenv":return new control.BoxenvControl(b.pos,j(c,b.body));case "install-value":return new control.InstallValueControl({count:b.count,pos:b.pos,isBoxes:b["boxes?"],rhs:j(c,b.rhs),body:j(c,b.body)});case "with-cont-mark":return new control.WithContMarkControl(j(c,
b.key),j(c,b.val),j(c,b.body));case "assign":return new control.AssignControl({id:j(c,b.id),rhs:j(c,b.rhs),isUndefOk:b["undef-ok?"]});case "varref":return new control.VarrefControl(j(c,b.toplevel));case "closure":return new control.ClosureCommand(b["gen-id"]);case "case-lam":return new control.CaseLamControl(b.name,F(c,b.clauses));case "let-rec":return new control.LetRecControl(F(c,b.procs),j(c,b.body));default:throw types.internalError("I don't know how to handle "+sys.inspect(b),state.captureCurrentContinuationMarks(c));
}},F=function(c,b){for(var z=[],y=0;y<b.length;y++)z.push(j(c,b[y]));return z},y=function(c){return new control.Prefix({numLifts:c["num-lifts"],toplevels:c.toplevels})};loader.loadCode=j;loader.loadPrefix=y})();var interpret={};
(function(){var j=5E4,F=function(y,B,e){function u(){for(var b=j;!y.isStuck()&&0<b;)z(y),b--;if(y.breakRequested)e(types.schemeError(types.exnBreak("user break",state.captureCurrentContinuationMarks(y),new types.ContinuationClosureValue(y.vstack,y.cstack))));else if(0>=b){var c=y.save();setTimeout(function(){y.restore(c);F(y,B,e)},0)}else B(y.v)}B||(B=function(){});e||(e=function(b){throw b;});try{u()}catch(m){if(m instanceof control.PauseException){var t=b(y,B,e),q=c(y);m.onPause(t,q)}else types.isSchemeError(m)&&
types.isIncompleteExn(m.val)&&(t=state.captureCurrentContinuationMarks(y),m=types.schemeError(m.val.constructor.apply(null,[m.val.msg,t].concat(m.val.otherArgs)))),e(m)}},y=function(b,c,e,j,m){var t=b.save();b.clearForEval({preserveBreak:!0});b.pushControl(new control.ApplicationControl(new control.ConstantControl(c),helpers.map(function(b){return new control.ConstantControl(b)},e)));try{F(b,function(c){b.restore(t);j(c)},function(c){b.restore(t);m(c)})}catch(q){throw b.restore(t),q;}},c=function(b){return function(c,
e,j,m){return y(b,c,e,j,m)}},b=function(b,c,e){var j=b.save();b.clearForEval({preserveBreak:!0});return function(m){b.restore(j);if(types.isSchemeError(m)){if(types.isIncompleteExn(m.val))var t=state.captureCurrentContinuationMarks(b),m=types.schemeError(m.val.constructor.apply(null,[m.val.msg,t].concat(m.val.otherArgs)));e(m)}else types.isInternalError(m)?e(m):(b.v=m,F(b,c,e))}},z=function(b){var c=b.popControl();debugF(function(){return sys.inspect(c)});if(c.invoke)c.invoke(b);else throw types.internalError("I don't know how to handle "+
sys.inspect(c),state.captureCurrentContinuationMarks(b));};primitive.addPrimitive("call/cc",new primitive.Primitive("call/cc",1,!1,!0,function(b,c){var e=new types.ContinuationClosureValue(b.vstack,b.cstack);b.pushValue(e);b.v=c;b.pushControl(new control.CallControl(1))}));interpret.load=function(b,c){c||(c=new state.State);try{for(var e=c,j=b["compiled-indirects"],m=0;m<j.length;m++){for(var t=j[m],q=t.lam,y=q["num-params"],z=q["param-types"],F=q["rest?"],S,ya=e,aa=q["closure-map"],Y=[],na=0;na<
aa.length;na++){var da;da=ya.peekn(aa[na]);Y.push(da)}S=Y;var C=new control.ConstantControl(!1);e.heap[t.id]=new types.ClosureValue(t.id,y,z,F,S,C)}for(m=0;m<j.length;m++)t=j[m],q=t.lam,e.heap[t.id].body=loader.loadCode(e,q.body);var X=loader.loadPrefix(b.prefix);control.processPrefix(c,X);c.pushControl(loader.loadCode(c,b.code))}catch(ga){throw types.isSchemeError(ga)&&types.isExn(ga.val)&&!types.isContinuationMarkSet(types.exnContMarks(ga.val))&&types.exnSetContMarks(ga.val,state.captureCurrentContinuationMarks(c)),
ga;}return c};interpret.step=z;interpret.run=F;interpret.call=y})();
