<!--html for upper menu-->
{% macro lecbtn(icon, title, action, condition='') -%}
    <button class="timButton btn-lg"
            ng-click="{{ action }}" title="{{ title }}" ng-show="{{ condition }}">
        <span class="glyphicon glyphicon-{{ icon }}" aria-hidden="true"></span>
    </button>
{%- endmacro %}
<div ng-cloak class="menuSection" ng-show="lctrl.lectureSettings.inLecture || lctrl.lectureSettings.lectureMode">
    <div id="largeMenu">
        <div class="lectureSection" ng-show="!lctrl.lectureSettings.inLecture">
            <h1>Now:</h1>
            <div ng-show="lctrl.lectures.length > 0" class="lectureArea">
                <select ng-change="lctrl.clearChange()" ng-model="lctrl.chosenLecture"
                        ng-options="lctrl.lecture.lecture_code for lecture in lctrl.lectures">
                </select>
                <!--<input id="passwordInput" ng-model="passwordQuess" placeholder="Access code"
                       ng-keypress="passEnterPressed($event)" size="7" ng-disabled="!chosenLecture.is_access_code">-->

                {{ lecbtn('log-in', 'Join the lecture', 'lctrl.joinLecture(_,chosenLecture.is_access_code)', 'lctrl.lectureSettings') }}
                {{ lecbtn('edit', 'Edit this lecture', 'lctrl.editLecture(chosenLecture.lecture_code)', 'lctrl.isLecturer') }}
                {{ lecbtn('plus-sign', 'Add new lecture', 'lctrl.toggleLecture()', 'lctrl.isLecturer') }}
            </div>
            <div ng-show="lctrl.lectures.length <= 0">
                <p>No running lectures</p>
                {{ lecbtn('plus-sign', 'Add new lecture', 'lctrl.toggleLecture()', 'isLecturer') }}
            </div>
        </div>
        <div class="lectureSection" ng-show="lctrl.lectureSettings.inLecture">
            <h1 ng-bind="lectureName"></h1>
            {% raw %}
            <p>Started: {{ lectureStartTime | timdate }}</p>

            <p>Ends: {{ lectureEndTime | timdate }}</p>
            {% endraw %}
            <div id="inLectureIconSection">
                {{ lecbtn('log-out', 'Leave this lecture', 'lctrl.leaveLecture()', 'lctrl.lectureSettings.inLecture') }}
                {{ lecbtn('stop', 'End this lecture', 'lctrl.endLecture()', 'canStop') }}
                {{ lecbtn('edit', 'Edit this lecture', 'lctrl.editLecture(lectureName)', 'canStop') }}
            </div>
        </div>

        <div class="lectureSection" ng-show="!lctrl.lectureSettings.inLecture">
            <h1>Later:</h1>

            <div class="lectureArea">
                <p ng-show="lctrl.futureLectures.length <= 0">No upcoming lectures</p>

                <div ng-show="lctrl.futureLectures.length > 0">
                    <select ng-model="lctrl.futureLecture"
                            ng-options="lecture.lecture_code + ' ' + (lecture.lecture_start | timdate) for lecture in lctrl.futureLectures">
                    </select>
                </div>
                <div class="iconSection" ng-show="futureLectures.length > 0">
                    {{ lecbtn('play', 'Start lecture now', 'startFutureLecture()', 'isLecturer') }}
                    {{ lecbtn('edit', 'Edit this lecture', 'editLecture(futureLecture.lecture_code)', 'isLecturer') }}
                </div>
            </div>
        </div>
    </div>
    <div ng-controller="SmallMenuCtrl as smctrl">
        <div class="smallMenu" ng-show="!lctrl.lectureSettings.inLecture">
            <div class="current">
                <h1 ng-click="smctrl.openCurrentLectureMenu()">Show current
                    <br>lectures</h1>
            </div>
            <div class="future">
                <h1 ng-click="smctrl.openFutureLectureMenu()">Show future
                    <br>lectures</h1>
            </div>
        </div>
        <div class="smallMenu" ng-show="lectureSettings.inLecture">
            <div class="currently">
                <h2 ng-bind="lctrl.lectureName"></h2>

                <div class="smallIconSection">
                {{ lecbtn('log-out', 'Leave this lecture', 'lctrl.leaveLecture()', 'lctrl.lectureSettings.inLecture') }}
                {{ lecbtn('stop', 'End this lecture', 'lctrl.endLecture()', 'lctrl.canStop') }}
                {{ lecbtn('edit', 'Edit this lecture', 'lctrl.editLecture(lectureName)', 'lctrl.canStop') }}
                </div>
            </div>
        </div>
        <div class="lecturesList">
            <div id="currentList">
                {% raw %}
                <ul>
                    <li ng-show="smctrl.currentLecturesList.length > 0" ng-repeat="lecture in smctrl.currentLecturesList">
                        <p ng-click="smctrl.selectCurrentLecture()">{{ lecture.lecture_code }}
                            <button class="timButton" value="Join"
                                   ng-click="lctrl.joinLecture(lecture.lecture_code,lecture.is_access_code)">Join</button>
                        </p>
                    </li>
                    <li ng-show="smctrl.currentLecturesList.length == 0">
                        <p>No lectures</p>
                    </li>
                    <li ng-show="lctrl.isLecturer"><p ng-click="lctrl.toggleLecture()" id="addLecture1"> Add new lecture </p></li>
                    {% endraw %}
                </ul>
            </div>
            <div id="futureList">
                {% raw %}
                <ul>
                    <li ng-repeat="lecture in smctrl.futureLecturesList">
                        <p> {{ lecture.lecture_code }}
                            <button class="timButton" ng-show="lctrl.isLecturer" value="Start">Start</button>
                        </p>
                    </li>
                    <li ng-show="smctrl.futureLecturesList.length == 0">
                        <p>No lectures</p>
                    </li>
                    <li ng-show="isLecturer"><p ng-click="lctrl.toggleLecture()" id="addLecture2"> Add new lecture </p></li>
                </ul>
                {% endraw %}
            </div>
        </div>
    </div>
</div>

    <div class="wall-behind" save="wall" id="wall" ng-show="lctrl.lectureSettings.useWall && lctrl.lectureSettings.inLecture" ng-cloak
         tim-draggable-fixed close="lctrl.changeUsingWall(false)" click="lctrl.hideWall()"
         caption="{% raw %}{{ lctrl.wallName }}{% endraw %}"
         resize="{% raw %}{{ !lctrl.lectureSettings.wallMinimized }}{% endraw %}">
        <div class="wall-base" id="wallBase">
            <div class="wall-message-area">
                <textarea id="wallArea" readonly cols="100">{{ "{{lctrl.msg}}" }}</textarea>
            </div>
            <div class="wall-footer">
                <div class="wall-buttons">
                    <input id="messagebox" ng-model="lctrl.newMsg" width="200"
                           ng-keypress="lctrl.chatEnterPressed($event)">
                </div>
                <div class="wall-info-buttons">
                    <label title="Shows name of the sender">
                        <input type="checkbox" ng-change="lctrl.showInfo()" ng-model="lctrl.messageName"/>Name
                    </label>
                    <label title="Shows sending time">
                        <input type="checkbox" ng-change="lctrl.showInfo()" ng-model="lctrl.messageTime"/>Time
                    </label>
                </div>
            </div>
        </div>
    </div>
    <pop-up-dialog show="lctrl.pollingStopped && lctrl.lectureSettings.useNotPollingDialog" caption="'Polling paused'" elem-id="'pausedWindow'">
        <ng-include
                src="'{{ url_for('static', filename='templates/paused.html') }}'"></ng-include>
    </pop-up-dialog>
    {# <pop-up-dialog show="lctrl.showLectureOptions" caption="'Join the lecture'">
        <ng-include
                src="'{{ url_for('static', filename='templates/lectureOptions.html') }}'"></ng-include>
    </pop-up-dialog> #}
    <pop-up-dialog show="lctrl.showLectureForm" caption="'Create lecture'">
        <ng-include
                src="'{{ url_for('static', filename='templates/start_lecture.html') }}'"></ng-include>
    </pop-up-dialog>



    <pop-up-dialog show="lctrl.showAnswerWindow" caption="questionTitle" class="answerWindow">
        <ng-include
                src="'{{ url_for('static', filename='templates/answerToQuestion.html') }}'"></ng-include>
    </pop-up-dialog>

    <pop-up-dialog show="lctrl.showLectureEnding" caption="'Lecture ending'">
        <ng-include
                src="'{{ url_for('static', filename='templates/lectureEnding.html') }}'"></ng-include>
    </pop-up-dialog>
    <pop-up-dialog show="lctrl.showQuestionPreview" caption="'Question preview: ' + questionTitle">
        <ng-include
                src="'{{ url_for('static', filename='templates/questionPreview.html') }}'"></ng-include>
    </pop-up-dialog>
    <pop-up-dialog show='lctrl.questionShown' caption="'Create question'">
        <div>
            <ng-include src="'{{ url_for('static', filename='templates/question.html') }}'"></ng-include>
        </div>
    </pop-up-dialog>

    <div ng-cloak save="lctrl.chartAnswers" class="userFixed chartAnswers"   tim-draggable-fixed="" resize="true" broadcastmsg="resizeElement"  ng-show="lctrl.showStudentAnswers" caption="Statistics">
        <ng-include
                src="'{{ url_for('static', filename='templates/showStatisticsToQuestion.html') }}'"></ng-include>
    </div>

    <pop-up-dialog show="lctrl.pollingStopped" caption="'Polling paused'" elem-id="'pausedWindow'">
        <ng-include
                src="'{{ url_for('static', filename='templates/paused.html') }}'"></ng-include>
    </pop-up-dialog>
