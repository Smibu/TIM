{% set editline = '' %}
{% if rights.editable or rights.can_comment %}
    {% set editline = '<div class="editline" title="Click to edit this paragraph"></div>' %}
{% endif %}
{% for t in text %}
    {% set o = t.get_original() %}
    <div class="{{ ['par', t.get_class_str()]|join(' ')|trim }}"
            {% if o %}
         id="{{ o.get_id() }}"
         t="{{ o.get_hash() }}"
         attrs="{{ o.get_attrs_str() }}"
         ref-id="{{ t.get_id() }}"
         ref-t="{{ t.get_hash() }}"
         ref-attrs="{{ t.get_attrs_str() }}"
         ref-doc-id="{{ t.get_doc_id() }}"
            {% else %}
         id="{{ t.get_id() }}"
         t="{{ t.get_hash() }}"
         attrs="{{ t.get_attrs_str() }}"
            {% endif %}
            {% if t.is_plugin() %}>
                <answerbrowserlazy
                        task-id="{{ t.get_doc_id() }}.{{ t.get_attrs()['taskId'] }}">
                </answerbrowserlazy>
            {% else %}
                ng-non-bindable>
            {% endif %}
    <div class="parContent">
        {{ t.get_html()|safe }}
    </div>
    {{ editline|safe }}
    <div class="{{ ['readline', readings[t.get_id()]]|join(' ')|trim }}"
         title="Click to mark this paragraph as read"></div>
    {% if notes[(o or t).get_id()] %}
        <div class="notes">
            {% for note in notes[(o or t).get_id()] %}
                <div class="{{ ['note', 'editable' if note.editable else '', 'private' if note.private else '']|join(' ')|trim }}"
                     note-id="{{ note.id }}">
                    {{ note.html|safe }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
    </div>
{% endfor %}